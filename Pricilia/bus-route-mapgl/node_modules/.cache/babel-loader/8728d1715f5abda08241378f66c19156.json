{"ast":null,"code":"import { PureComponent, createElement } from 'react';\nimport { MapContext } from '@urbica/react-map-gl';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction commonjsRequire() {\n  throw new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar mapboxGlDraw = createCommonjsModule(function (module, exports) {\n  !function (e) {\n    module.exports = e();\n  }(function () {\n    return function e(t, n, o) {\n      function r(s, a) {\n        if (!n[s]) {\n          if (!t[s]) {\n            var c = \"function\" == typeof commonjsRequire && commonjsRequire;\n            if (!a && c) return c(s, !0);\n            if (i) return i(s, !0);\n            var u = new Error(\"Cannot find module '\" + s + \"'\");\n            throw u.code = \"MODULE_NOT_FOUND\", u;\n          }\n\n          var l = n[s] = {\n            exports: {}\n          };\n          t[s][0].call(l.exports, function (e) {\n            var n = t[s][1][e];\n            return r(n || e);\n          }, l, l.exports, e, t, n, o);\n        }\n\n        return n[s].exports;\n      }\n\n      for (var i = \"function\" == typeof commonjsRequire && commonjsRequire, s = 0; s < o.length; s++) r(o[s]);\n\n      return r;\n    }({\n      1: [function (e, t, n) {\n        var o = e(\"./src/setup\"),\n            r = e(\"./src/options\"),\n            i = e(\"./src/api\"),\n            s = e(\"./src/constants\"),\n            a = function (e, t) {\n          var n = {\n            options: e = r(e)\n          };\n          t = i(n, t), n.api = t;\n          var a = o(n);\n          return t.onAdd = a.onAdd, t.onRemove = a.onRemove, t.types = s.types, t.options = e, t;\n        };\n\n        t.exports = function (e) {\n          a(e, this);\n        }, t.exports.modes = e(\"./src/modes\");\n      }, {\n        \"./src/api\": 22,\n        \"./src/constants\": 23,\n        \"./src/modes\": 56,\n        \"./src/options\": 61,\n        \"./src/setup\": 63\n      }],\n      2: [function (e, t, n) {\n        function o(e) {\n          if (!(this instanceof o)) return new o(e);\n          this._bbox = e || [1 / 0, 1 / 0, -1 / 0, -1 / 0], this._valid = !!e;\n        }\n\n        t.exports = o, o.prototype.include = function (e) {\n          return this._valid = !0, this._bbox[0] = Math.min(this._bbox[0], e[0]), this._bbox[1] = Math.min(this._bbox[1], e[1]), this._bbox[2] = Math.max(this._bbox[2], e[0]), this._bbox[3] = Math.max(this._bbox[3], e[1]), this;\n        }, o.prototype.equals = function (e) {\n          var t;\n          return t = e instanceof o ? e.bbox() : e, this._bbox[0] == t[0] && this._bbox[1] == t[1] && this._bbox[2] == t[2] && this._bbox[3] == t[3];\n        }, o.prototype.center = function (e) {\n          return this._valid ? [(this._bbox[0] + this._bbox[2]) / 2, (this._bbox[1] + this._bbox[3]) / 2] : null;\n        }, o.prototype.union = function (e) {\n          this._valid = !0;\n          var t;\n          return t = e instanceof o ? e.bbox() : e, this._bbox[0] = Math.min(this._bbox[0], t[0]), this._bbox[1] = Math.min(this._bbox[1], t[1]), this._bbox[2] = Math.max(this._bbox[2], t[2]), this._bbox[3] = Math.max(this._bbox[3], t[3]), this;\n        }, o.prototype.bbox = function () {\n          return this._valid ? this._bbox : null;\n        }, o.prototype.contains = function (e) {\n          if (!e) return this._fastContains();\n          if (!this._valid) return null;\n          var t = e[0],\n              n = e[1];\n          return this._bbox[0] <= t && this._bbox[1] <= n && this._bbox[2] >= t && this._bbox[3] >= n;\n        }, o.prototype.intersect = function (e) {\n          if (!this._valid) return null;\n          var t;\n          return t = e instanceof o ? e.bbox() : e, !(this._bbox[0] > t[2] || this._bbox[2] < t[0] || this._bbox[3] < t[1] || this._bbox[1] > t[3]);\n        }, o.prototype._fastContains = function () {\n          if (!this._valid) return new Function(\"return null;\");\n          var e = \"return \" + this._bbox[0] + \"<= ll[0] &&\" + this._bbox[1] + \"<= ll[1] &&\" + this._bbox[2] + \">= ll[0] &&\" + this._bbox[3] + \">= ll[1]\";\n          return new Function(\"ll\", e);\n        }, o.prototype.polygon = function () {\n          return this._valid ? {\n            type: \"Polygon\",\n            coordinates: [[[this._bbox[0], this._bbox[1]], [this._bbox[2], this._bbox[1]], [this._bbox[2], this._bbox[3]], [this._bbox[0], this._bbox[3]], [this._bbox[0], this._bbox[1]]]]\n          } : null;\n        };\n      }, {}],\n      3: [function (e, t, n) {\n        function o(e) {\n          var t,\n              n = 0;\n\n          switch (e.type) {\n            case \"Polygon\":\n              return r(e.coordinates);\n\n            case \"MultiPolygon\":\n              for (t = 0; t < e.coordinates.length; t++) n += r(e.coordinates[t]);\n\n              return n;\n\n            case \"Point\":\n            case \"MultiPoint\":\n            case \"LineString\":\n            case \"MultiLineString\":\n              return 0;\n\n            case \"GeometryCollection\":\n              for (t = 0; t < e.geometries.length; t++) n += o(e.geometries[t]);\n\n              return n;\n          }\n        }\n\n        function r(e) {\n          var t = 0;\n\n          if (e && e.length > 0) {\n            t += Math.abs(i(e[0]));\n\n            for (var n = 1; n < e.length; n++) t -= Math.abs(i(e[n]));\n          }\n\n          return t;\n        }\n\n        function i(e) {\n          var t,\n              n,\n              o,\n              r,\n              i,\n              c,\n              u = 0,\n              l = e.length;\n\n          if (l > 2) {\n            for (c = 0; c < l; c++) c === l - 2 ? (o = l - 2, r = l - 1, i = 0) : c === l - 1 ? (o = l - 1, r = 0, i = 1) : (o = c, r = c + 1, i = c + 2), t = e[o], n = e[r], u += (s(e[i][0]) - s(t[0])) * Math.sin(s(n[1]));\n\n            u = u * a.RADIUS * a.RADIUS / 2;\n          }\n\n          return u;\n        }\n\n        function s(e) {\n          return e * Math.PI / 180;\n        }\n\n        var a = e(\"wgs84\");\n        t.exports.geometry = o, t.exports.ring = i;\n      }, {\n        wgs84: 20\n      }],\n      4: [function (e, t, n) {\n        t.exports = function (e) {\n          function t(e) {\n            return Array.isArray(e) && e.length && \"number\" == typeof e[0] ? [e] : e.reduce(function (e, n) {\n              return Array.isArray(n) && Array.isArray(n[0]) ? e.concat(t(n)) : (e.push(n), e);\n            }, []);\n          }\n\n          return t(e);\n        };\n      }, {}],\n      5: [function (e, t, n) {\n        var o = e(\"@mapbox/geojson-normalize\"),\n            r = e(\"geojson-flatten\"),\n            i = e(\"./flatten\");\n\n        t.exports = function (e) {\n          if (!e) return [];\n          var t = [];\n          return r(o(e)).features.forEach(function (e) {\n            e.geometry && (t = t.concat(i(e.geometry.coordinates)));\n          }), t;\n        };\n      }, {\n        \"./flatten\": 4,\n        \"@mapbox/geojson-normalize\": 7,\n        \"geojson-flatten\": 13\n      }],\n      6: [function (e, t, n) {\n        function o(e) {\n          for (var t = s(), n = r(e), o = 0; o < n.length; o++) t.include(n[o]);\n\n          return t;\n        }\n\n        var r = e(\"@mapbox/geojson-coords\"),\n            i = e(\"traverse\"),\n            s = e(\"@mapbox/extent\"),\n            a = {\n          features: [\"FeatureCollection\"],\n          coordinates: [\"Point\", \"MultiPoint\", \"LineString\", \"MultiLineString\", \"Polygon\", \"MultiPolygon\"],\n          geometry: [\"Feature\"],\n          geometries: [\"GeometryCollection\"]\n        },\n            c = Object.keys(a);\n        t.exports = function (e) {\n          return o(e).bbox();\n        }, t.exports.polygon = function (e) {\n          return o(e).polygon();\n        }, t.exports.bboxify = function (e) {\n          return i(e).map(function (e) {\n            e && c.some(function (t) {\n              return !!e[t] && -1 !== a[t].indexOf(e.type);\n            }) && (e.bbox = o(e).bbox(), this.update(e));\n          });\n        };\n      }, {\n        \"@mapbox/extent\": 2,\n        \"@mapbox/geojson-coords\": 5,\n        traverse: 19\n      }],\n      7: [function (e, t, n) {\n        t.exports = function (e) {\n          if (!e || !e.type) return null;\n          var t = o[e.type];\n          return t ? \"geometry\" === t ? {\n            type: \"FeatureCollection\",\n            features: [{\n              type: \"Feature\",\n              properties: {},\n              geometry: e\n            }]\n          } : \"feature\" === t ? {\n            type: \"FeatureCollection\",\n            features: [e]\n          } : \"featurecollection\" === t ? e : void 0 : null;\n        };\n\n        var o = {\n          Point: \"geometry\",\n          MultiPoint: \"geometry\",\n          LineString: \"geometry\",\n          MultiLineString: \"geometry\",\n          Polygon: \"geometry\",\n          MultiPolygon: \"geometry\",\n          GeometryCollection: \"geometry\",\n          Feature: \"feature\",\n          FeatureCollection: \"featurecollection\"\n        };\n      }, {}],\n      8: [function (e, t, n) {\n        var o = e(\"jsonlint-lines\"),\n            r = e(\"./object\");\n\n        t.exports.hint = function (e, t) {\n          var n,\n              i = [];\n          if (\"object\" == typeof e) n = e;else {\n            if (\"string\" != typeof e) return [{\n              message: \"Expected string or object as input\",\n              line: 0\n            }];\n\n            try {\n              n = o.parse(e);\n            } catch (e) {\n              var s = e.message.match(/line (\\d+)/);\n              return [{\n                line: parseInt(s[1], 10) - 1,\n                message: e.message,\n                error: e\n              }];\n            }\n          }\n          return i = i.concat(r.hint(n, t));\n        };\n      }, {\n        \"./object\": 9,\n        \"jsonlint-lines\": 15\n      }],\n      9: [function (e, t, n) {\n        var o = e(\"./rhr\");\n\n        t.exports.hint = function (e, t) {\n          function n(e) {\n            if (t && !1 === t.noDuplicateMembers || !e.__duplicateProperties__ || f.push({\n              message: \"An object contained duplicate members, making parsing ambigous: \" + e.__duplicateProperties__.join(\", \"),\n              line: e.__line__\n            }), !i(e, \"type\", \"string\")) if (y[e.type]) e && y[e.type](e);else {\n              var n = m[e.type.toLowerCase()];\n              void 0 !== n ? f.push({\n                message: \"Expected \" + n + \" but got \" + e.type + \" (case sensitive)\",\n                line: e.__line__\n              }) : f.push({\n                message: \"The type \" + e.type + \" is unknown\",\n                line: e.__line__\n              });\n            }\n          }\n\n          function r(e, t) {\n            return e.every(function (e) {\n              return null !== e && typeof e === t;\n            });\n          }\n\n          function i(e, t, n) {\n            if (void 0 === e[t]) return f.push({\n              message: '\"' + t + '\" member required',\n              line: e.__line__\n            });\n\n            if (\"array\" === n) {\n              if (!Array.isArray(e[t])) return f.push({\n                message: '\"' + t + '\" member should be an array, but is an ' + typeof e[t] + \" instead\",\n                line: e.__line__\n              });\n            } else {\n              if (\"object\" === n && e[t] && \"Object\" !== e[t].constructor.name) return f.push({\n                message: '\"' + t + '\" member should be ' + n + \", but is an \" + e[t].constructor.name + \" instead\",\n                line: e.__line__\n              });\n              if (n && typeof e[t] !== n) return f.push({\n                message: '\"' + t + '\" member should be ' + n + \", but is an \" + typeof e[t] + \" instead\",\n                line: e.__line__\n              });\n            }\n          }\n\n          function s(e, n) {\n            if (!Array.isArray(e)) return f.push({\n              message: \"position should be an array, is a \" + typeof e + \" instead\",\n              line: e.__line__ || n\n            });\n            if (e.length < 2) return f.push({\n              message: \"position must have 2 or more elements\",\n              line: e.__line__ || n\n            });\n            if (e.length > 3) return f.push({\n              message: \"position should not have more than 3 elements\",\n              level: \"message\",\n              line: e.__line__ || n\n            });\n            if (!r(e, \"number\")) return f.push({\n              message: \"each element in a position must be a number\",\n              line: e.__line__ || n\n            });\n\n            if (t && t.precisionWarning) {\n              if (h === d) return h += 1, f.push({\n                message: \"truncated warnings: we've encountered coordinate precision warning \" + d + \" times, no more warnings will be reported\",\n                level: \"message\",\n                line: e.__line__ || n\n              });\n              h < d && e.forEach(function (t) {\n                var o = 0,\n                    r = String(t).split(\".\")[1];\n                if (void 0 !== r && (o = r.length), o > g) return h += 1, f.push({\n                  message: \"precision of coordinates should be reduced\",\n                  level: \"message\",\n                  line: e.__line__ || n\n                });\n              });\n            }\n          }\n\n          function a(e, t, n, o) {\n            if (void 0 === o && void 0 !== e.__line__ && (o = e.__line__), 0 === n) return s(e, o);\n            if (1 === n && t) if (\"LinearRing\" === t) {\n              if (!Array.isArray(e[e.length - 1])) return f.push({\n                message: \"a number was found where a coordinate array should have been found: this needs to be nested more deeply\",\n                line: o\n              }), !0;\n              if (e.length < 4 && f.push({\n                message: \"a LinearRing of coordinates needs to have four or more positions\",\n                line: o\n              }), e.length && (e[e.length - 1].length !== e[0].length || !e[e.length - 1].every(function (t, n) {\n                return e[0][n] === t;\n              }))) return f.push({\n                message: \"the first and last positions in a LinearRing of coordinates must be the same\",\n                line: o\n              }), !0;\n            } else if (\"Line\" === t && e.length < 2) return f.push({\n              message: \"a line needs to have two or more coordinates to be valid\",\n              line: o\n            });\n            if (Array.isArray(e)) return e.map(function (e) {\n              return a(e, t, n - 1, e.__line__ || o);\n            }).some(function (e) {\n              return e;\n            });\n            f.push({\n              message: \"a number was found where a coordinate array should have been found: this needs to be nested more deeply\",\n              line: o\n            });\n          }\n\n          function c(e) {\n            e.crs && (\"object\" == typeof e.crs && e.crs.properties && \"urn:ogc:def:crs:OGC:1.3:CRS84\" === e.crs.properties.name ? f.push({\n              message: \"old-style crs member is not recommended, this object is equivalent to the default and should be removed\",\n              line: e.__line__\n            }) : f.push({\n              message: \"old-style crs member is not recommended\",\n              line: e.__line__\n            }));\n          }\n\n          function u(e) {\n            if (e.bbox) return Array.isArray(e.bbox) ? (r(e.bbox, \"number\") || f.push({\n              message: \"each element in a bbox member must be a number\",\n              line: e.bbox.__line__\n            }), 4 !== e.bbox.length && 6 !== e.bbox.length && f.push({\n              message: \"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)\",\n              line: e.bbox.__line__\n            }), f.length) : void f.push({\n              message: \"bbox member must be an array of numbers, but is a \" + typeof e.bbox,\n              line: e.__line__\n            });\n          }\n\n          function l(e) {\n            void 0 !== e.properties && f.push({\n              message: 'geometry object cannot contain a \"properties\" member',\n              line: e.__line__\n            }), void 0 !== e.geometry && f.push({\n              message: 'geometry object cannot contain a \"geometry\" member',\n              line: e.__line__\n            }), void 0 !== e.features && f.push({\n              message: 'geometry object cannot contain a \"features\" member',\n              line: e.__line__\n            });\n          }\n\n          function p(e) {\n            c(e), u(e), void 0 !== e.id && \"string\" != typeof e.id && \"number\" != typeof e.id && f.push({\n              message: 'Feature \"id\" member must have a string or number value',\n              line: e.__line__\n            }), void 0 !== e.features && f.push({\n              message: 'Feature object cannot contain a \"features\" member',\n              line: e.__line__\n            }), void 0 !== e.coordinates && f.push({\n              message: 'Feature object cannot contain a \"coordinates\" member',\n              line: e.__line__\n            }), \"Feature\" !== e.type && f.push({\n              message: \"GeoJSON features must have a type=feature member\",\n              line: e.__line__\n            }), i(e, \"properties\", \"object\"), i(e, \"geometry\", \"object\") || e.geometry && n(e.geometry);\n          }\n\n          var f = [],\n              h = 0,\n              d = 10,\n              g = 6,\n              y = {\n            Point: function (e) {\n              c(e), u(e), l(e), i(e, \"coordinates\", \"array\") || s(e.coordinates);\n            },\n            Feature: p,\n            MultiPoint: function (e) {\n              c(e), u(e), i(e, \"coordinates\", \"array\") || a(e.coordinates, \"\", 1);\n            },\n            LineString: function (e) {\n              c(e), u(e), i(e, \"coordinates\", \"array\") || a(e.coordinates, \"Line\", 1);\n            },\n            MultiLineString: function (e) {\n              c(e), u(e), i(e, \"coordinates\", \"array\") || a(e.coordinates, \"Line\", 2);\n            },\n            FeatureCollection: function (e) {\n              if (c(e), u(e), void 0 !== e.properties && f.push({\n                message: 'FeatureCollection object cannot contain a \"properties\" member',\n                line: e.__line__\n              }), void 0 !== e.coordinates && f.push({\n                message: 'FeatureCollection object cannot contain a \"coordinates\" member',\n                line: e.__line__\n              }), !i(e, \"features\", \"array\")) {\n                if (!r(e.features, \"object\")) return f.push({\n                  message: \"Every feature must be an object\",\n                  line: e.__line__\n                });\n                e.features.forEach(p);\n              }\n            },\n            GeometryCollection: function (e) {\n              c(e), u(e), i(e, \"geometries\", \"array\") || (r(e.geometries, \"object\") || f.push({\n                message: \"The geometries array in a GeometryCollection must contain only geometry objects\",\n                line: e.__line__\n              }), 1 === e.geometries.length && f.push({\n                message: \"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type\",\n                line: e.geometries.__line__\n              }), e.geometries.forEach(function (t) {\n                t && (\"GeometryCollection\" === t.type && f.push({\n                  message: \"GeometryCollection should avoid nested geometry collections\",\n                  line: e.geometries.__line__\n                }), n(t));\n              }));\n            },\n            Polygon: function (e) {\n              c(e), u(e), i(e, \"coordinates\", \"array\") || a(e.coordinates, \"LinearRing\", 2) || o(e, f);\n            },\n            MultiPolygon: function (e) {\n              c(e), u(e), i(e, \"coordinates\", \"array\") || a(e.coordinates, \"LinearRing\", 3) || o(e, f);\n            }\n          },\n              m = Object.keys(y).reduce(function (e, t) {\n            return e[t.toLowerCase()] = t, e;\n          }, {});\n          return \"object\" != typeof e || null === e || void 0 === e ? (f.push({\n            message: \"The root of a GeoJSON object must be an object.\",\n            line: 0\n          }), f) : (n(e), f.forEach(function (e) {\n            ({}).hasOwnProperty.call(e, \"line\") && void 0 === e.line && delete e.line;\n          }), f);\n        };\n      }, {\n        \"./rhr\": 10\n      }],\n      10: [function (e, t, n) {\n        function o(e) {\n          return e * Math.PI / 180;\n        }\n\n        function r(e) {\n          var t = 0;\n          if (e.length > 2) for (var n, r, i = 0; i < e.length - 1; i++) n = e[i], t += o((r = e[i + 1])[0] - n[0]) * (2 + Math.sin(o(n[1])) + Math.sin(o(r[1])));\n          return t >= 0;\n        }\n\n        function i(e) {\n          if (e && e.length > 0) {\n            if (r(e[0])) return !1;\n            if (!e.slice(1, e.length).every(r)) return !1;\n          }\n\n          return !0;\n        }\n\n        function s(e) {\n          return \"Polygon\" === e.type ? i(e.coordinates) : \"MultiPolygon\" === e.type ? e.coordinates.every(i) : void 0;\n        }\n\n        t.exports = function (e, t) {\n          s(e) || t.push({\n            message: \"Polygons and MultiPolygons should follow the right-hand rule\",\n            level: \"message\",\n            line: e.__line__\n          });\n        };\n      }, {}],\n      11: [function (e, t, n) {\n        function o(e, t) {\n          this.x = e, this.y = t;\n        }\n\n        t.exports = o, o.prototype = {\n          clone: function () {\n            return new o(this.x, this.y);\n          },\n          add: function (e) {\n            return this.clone()._add(e);\n          },\n          sub: function (e) {\n            return this.clone()._sub(e);\n          },\n          multByPoint: function (e) {\n            return this.clone()._multByPoint(e);\n          },\n          divByPoint: function (e) {\n            return this.clone()._divByPoint(e);\n          },\n          mult: function (e) {\n            return this.clone()._mult(e);\n          },\n          div: function (e) {\n            return this.clone()._div(e);\n          },\n          rotate: function (e) {\n            return this.clone()._rotate(e);\n          },\n          rotateAround: function (e, t) {\n            return this.clone()._rotateAround(e, t);\n          },\n          matMult: function (e) {\n            return this.clone()._matMult(e);\n          },\n          unit: function () {\n            return this.clone()._unit();\n          },\n          perp: function () {\n            return this.clone()._perp();\n          },\n          round: function () {\n            return this.clone()._round();\n          },\n          mag: function () {\n            return Math.sqrt(this.x * this.x + this.y * this.y);\n          },\n          equals: function (e) {\n            return this.x === e.x && this.y === e.y;\n          },\n          dist: function (e) {\n            return Math.sqrt(this.distSqr(e));\n          },\n          distSqr: function (e) {\n            var t = e.x - this.x,\n                n = e.y - this.y;\n            return t * t + n * n;\n          },\n          angle: function () {\n            return Math.atan2(this.y, this.x);\n          },\n          angleTo: function (e) {\n            return Math.atan2(this.y - e.y, this.x - e.x);\n          },\n          angleWith: function (e) {\n            return this.angleWithSep(e.x, e.y);\n          },\n          angleWithSep: function (e, t) {\n            return Math.atan2(this.x * t - this.y * e, this.x * e + this.y * t);\n          },\n          _matMult: function (e) {\n            var t = e[0] * this.x + e[1] * this.y,\n                n = e[2] * this.x + e[3] * this.y;\n            return this.x = t, this.y = n, this;\n          },\n          _add: function (e) {\n            return this.x += e.x, this.y += e.y, this;\n          },\n          _sub: function (e) {\n            return this.x -= e.x, this.y -= e.y, this;\n          },\n          _mult: function (e) {\n            return this.x *= e, this.y *= e, this;\n          },\n          _div: function (e) {\n            return this.x /= e, this.y /= e, this;\n          },\n          _multByPoint: function (e) {\n            return this.x *= e.x, this.y *= e.y, this;\n          },\n          _divByPoint: function (e) {\n            return this.x /= e.x, this.y /= e.y, this;\n          },\n          _unit: function () {\n            return this._div(this.mag()), this;\n          },\n          _perp: function () {\n            var e = this.y;\n            return this.y = this.x, this.x = -e, this;\n          },\n          _rotate: function (e) {\n            var t = Math.cos(e),\n                n = Math.sin(e),\n                o = t * this.x - n * this.y,\n                r = n * this.x + t * this.y;\n            return this.x = o, this.y = r, this;\n          },\n          _rotateAround: function (e, t) {\n            var n = Math.cos(e),\n                o = Math.sin(e),\n                r = t.x + n * (this.x - t.x) - o * (this.y - t.y),\n                i = t.y + o * (this.x - t.x) + n * (this.y - t.y);\n            return this.x = r, this.y = i, this;\n          },\n          _round: function () {\n            return this.x = Math.round(this.x), this.y = Math.round(this.y), this;\n          }\n        }, o.convert = function (e) {\n          return e instanceof o ? e : Array.isArray(e) ? new o(e[0], e[1]) : e;\n        };\n      }, {}],\n      12: [function (e, t, n) {}, {}],\n      13: [function (e, t, n) {\n        function o(e) {\n          switch (e && e.type || null) {\n            case \"FeatureCollection\":\n              return e.features = e.features.reduce(function (e, t) {\n                return e.concat(o(t));\n              }, []), e;\n\n            case \"Feature\":\n              return e.geometry ? o(e.geometry).map(function (t) {\n                return {\n                  type: \"Feature\",\n                  properties: JSON.parse(JSON.stringify(e.properties)),\n                  geometry: t\n                };\n              }) : e;\n\n            case \"MultiPoint\":\n              return e.coordinates.map(function (e) {\n                return {\n                  type: \"Point\",\n                  coordinates: e\n                };\n              });\n\n            case \"MultiPolygon\":\n              return e.coordinates.map(function (e) {\n                return {\n                  type: \"Polygon\",\n                  coordinates: e\n                };\n              });\n\n            case \"MultiLineString\":\n              return e.coordinates.map(function (e) {\n                return {\n                  type: \"LineString\",\n                  coordinates: e\n                };\n              });\n\n            case \"GeometryCollection\":\n              return e.geometries.map(o).reduce(function (e, t) {\n                return e.concat(t);\n              }, []);\n\n            case \"Point\":\n            case \"Polygon\":\n            case \"LineString\":\n              return [e];\n          }\n        }\n\n        t.exports = o;\n      }, {}],\n      14: [function (e, t, n) {\n        var o = t.exports = function (e, t) {\n          if (t || (t = 16), void 0 === e && (e = 128), e <= 0) return \"0\";\n\n          for (var n = Math.log(Math.pow(2, e)) / Math.log(t), r = 2; n === 1 / 0; r *= 2) n = Math.log(Math.pow(2, e / r)) / Math.log(t) * r;\n\n          for (var i = n - Math.floor(n), s = \"\", r = 0; r < Math.floor(n); r++) s = (c = Math.floor(Math.random() * t).toString(t)) + s;\n\n          if (i) {\n            var a = Math.pow(t, i),\n                c = Math.floor(Math.random() * a).toString(t);\n            s = c + s;\n          }\n\n          var u = parseInt(s, t);\n          return u !== 1 / 0 && u >= Math.pow(2, e) ? o(e, t) : s;\n        };\n\n        o.rack = function (e, t, n) {\n          var r = function (r) {\n            var s = 0;\n\n            do {\n              if (s++ > 10) {\n                if (!n) throw new Error(\"too many ID collisions, use more bits\");\n                e += n;\n              }\n\n              var a = o(e, t);\n            } while (Object.hasOwnProperty.call(i, a));\n\n            return i[a] = r, a;\n          },\n              i = r.hats = {};\n\n          return r.get = function (e) {\n            return r.hats[e];\n          }, r.set = function (e, t) {\n            return r.hats[e] = t, r;\n          }, r.bits = e || 128, r.base = t || 16, r;\n        };\n      }, {}],\n      15: [function (e, t, n) {\n        (function (o) {\n          var r = function () {\n            function e() {\n              this.yy = {};\n            }\n\n            var t = function (e, t, n, o) {\n              for (n = n || {}, o = e.length; o--; n[e[o]] = t);\n\n              return n;\n            },\n                n = [1, 12],\n                o = [1, 13],\n                r = [1, 9],\n                i = [1, 10],\n                s = [1, 11],\n                a = [1, 14],\n                c = [1, 15],\n                u = [14, 18, 22, 24],\n                l = [18, 22],\n                p = [22, 24],\n                f = {\n              trace: function () {},\n              yy: {},\n              symbols_: {\n                error: 2,\n                JSONString: 3,\n                STRING: 4,\n                JSONNumber: 5,\n                NUMBER: 6,\n                JSONNullLiteral: 7,\n                NULL: 8,\n                JSONBooleanLiteral: 9,\n                TRUE: 10,\n                FALSE: 11,\n                JSONText: 12,\n                JSONValue: 13,\n                EOF: 14,\n                JSONObject: 15,\n                JSONArray: 16,\n                \"{\": 17,\n                \"}\": 18,\n                JSONMemberList: 19,\n                JSONMember: 20,\n                \":\": 21,\n                \",\": 22,\n                \"[\": 23,\n                \"]\": 24,\n                JSONElementList: 25,\n                $accept: 0,\n                $end: 1\n              },\n              terminals_: {\n                2: \"error\",\n                4: \"STRING\",\n                6: \"NUMBER\",\n                8: \"NULL\",\n                10: \"TRUE\",\n                11: \"FALSE\",\n                14: \"EOF\",\n                17: \"{\",\n                18: \"}\",\n                21: \":\",\n                22: \",\",\n                23: \"[\",\n                24: \"]\"\n              },\n              productions_: [0, [3, 1], [5, 1], [7, 1], [9, 1], [9, 1], [12, 2], [13, 1], [13, 1], [13, 1], [13, 1], [13, 1], [13, 1], [15, 2], [15, 3], [20, 3], [19, 1], [19, 3], [16, 2], [16, 3], [25, 1], [25, 3]],\n              performAction: function (e, t, n, o, r, i, s) {\n                var a = i.length - 1;\n\n                switch (r) {\n                  case 1:\n                    this.$ = e.replace(/\\\\(\\\\|\")/g, \"$1\").replace(/\\\\n/g, \"\\n\").replace(/\\\\r/g, \"\\r\").replace(/\\\\t/g, \"\\t\").replace(/\\\\v/g, \"\\v\").replace(/\\\\f/g, \"\\f\").replace(/\\\\b/g, \"\\b\");\n                    break;\n\n                  case 2:\n                    this.$ = Number(e);\n                    break;\n\n                  case 3:\n                    this.$ = null;\n                    break;\n\n                  case 4:\n                    this.$ = !0;\n                    break;\n\n                  case 5:\n                    this.$ = !1;\n                    break;\n\n                  case 6:\n                    return this.$ = i[a - 1];\n\n                  case 13:\n                    this.$ = {}, Object.defineProperty(this.$, \"__line__\", {\n                      value: this._$.first_line,\n                      enumerable: !1\n                    });\n                    break;\n\n                  case 14:\n                  case 19:\n                    this.$ = i[a - 1], Object.defineProperty(this.$, \"__line__\", {\n                      value: this._$.first_line,\n                      enumerable: !1\n                    });\n                    break;\n\n                  case 15:\n                    this.$ = [i[a - 2], i[a]];\n                    break;\n\n                  case 16:\n                    this.$ = {}, this.$[i[a][0]] = i[a][1];\n                    break;\n\n                  case 17:\n                    this.$ = i[a - 2], void 0 !== i[a - 2][i[a][0]] && (this.$.__duplicateProperties__ || Object.defineProperty(this.$, \"__duplicateProperties__\", {\n                      value: [],\n                      enumerable: !1\n                    }), this.$.__duplicateProperties__.push(i[a][0])), i[a - 2][i[a][0]] = i[a][1];\n                    break;\n\n                  case 18:\n                    this.$ = [], Object.defineProperty(this.$, \"__line__\", {\n                      value: this._$.first_line,\n                      enumerable: !1\n                    });\n                    break;\n\n                  case 20:\n                    this.$ = [i[a]];\n                    break;\n\n                  case 21:\n                    this.$ = i[a - 2], i[a - 2].push(i[a]);\n                }\n              },\n              table: [{\n                3: 5,\n                4: n,\n                5: 6,\n                6: o,\n                7: 3,\n                8: r,\n                9: 4,\n                10: i,\n                11: s,\n                12: 1,\n                13: 2,\n                15: 7,\n                16: 8,\n                17: a,\n                23: c\n              }, {\n                1: [3]\n              }, {\n                14: [1, 16]\n              }, t(u, [2, 7]), t(u, [2, 8]), t(u, [2, 9]), t(u, [2, 10]), t(u, [2, 11]), t(u, [2, 12]), t(u, [2, 3]), t(u, [2, 4]), t(u, [2, 5]), t([14, 18, 21, 22, 24], [2, 1]), t(u, [2, 2]), {\n                3: 20,\n                4: n,\n                18: [1, 17],\n                19: 18,\n                20: 19\n              }, {\n                3: 5,\n                4: n,\n                5: 6,\n                6: o,\n                7: 3,\n                8: r,\n                9: 4,\n                10: i,\n                11: s,\n                13: 23,\n                15: 7,\n                16: 8,\n                17: a,\n                23: c,\n                24: [1, 21],\n                25: 22\n              }, {\n                1: [2, 6]\n              }, t(u, [2, 13]), {\n                18: [1, 24],\n                22: [1, 25]\n              }, t(l, [2, 16]), {\n                21: [1, 26]\n              }, t(u, [2, 18]), {\n                22: [1, 28],\n                24: [1, 27]\n              }, t(p, [2, 20]), t(u, [2, 14]), {\n                3: 20,\n                4: n,\n                20: 29\n              }, {\n                3: 5,\n                4: n,\n                5: 6,\n                6: o,\n                7: 3,\n                8: r,\n                9: 4,\n                10: i,\n                11: s,\n                13: 30,\n                15: 7,\n                16: 8,\n                17: a,\n                23: c\n              }, t(u, [2, 19]), {\n                3: 5,\n                4: n,\n                5: 6,\n                6: o,\n                7: 3,\n                8: r,\n                9: 4,\n                10: i,\n                11: s,\n                13: 31,\n                15: 7,\n                16: 8,\n                17: a,\n                23: c\n              }, t(l, [2, 17]), t(l, [2, 15]), t(p, [2, 21])],\n              defaultActions: {\n                16: [2, 6]\n              },\n              parseError: function (e, t) {\n                function n(e, t) {\n                  this.message = e, this.hash = t;\n                }\n\n                if (!t.recoverable) throw n.prototype = Error, new n(e, t);\n                this.trace(e);\n              },\n              parse: function (e) {\n                var t = this,\n                    n = [0],\n                    o = [null],\n                    r = [],\n                    i = this.table,\n                    s = \"\",\n                    a = 0,\n                    c = 0,\n                    u = 0,\n                    l = r.slice.call(arguments, 1),\n                    p = Object.create(this.lexer),\n                    f = {\n                  yy: {}\n                };\n\n                for (var h in this.yy) Object.prototype.hasOwnProperty.call(this.yy, h) && (f.yy[h] = this.yy[h]);\n\n                p.setInput(e, f.yy), f.yy.lexer = p, f.yy.parser = this, void 0 === p.yylloc && (p.yylloc = {});\n                var d = p.yylloc;\n                r.push(d);\n                var g = p.options && p.options.ranges;\n                \"function\" == typeof f.yy.parseError ? this.parseError = f.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError;\n\n                for (var y, m, _, v, b, E, T, x, S, O = function () {\n                  var e;\n                  return \"number\" != typeof (e = p.lex() || 1) && (e = t.symbols_[e] || e), e;\n                }, C = {};;) {\n                  if (_ = n[n.length - 1], this.defaultActions[_] ? v = this.defaultActions[_] : (null !== y && void 0 !== y || (y = O()), v = i[_] && i[_][y]), void 0 === v || !v.length || !v[0]) {\n                    var I = \"\";\n                    S = [];\n\n                    for (E in i[_]) this.terminals_[E] && E > 2 && S.push(\"'\" + this.terminals_[E] + \"'\");\n\n                    I = p.showPosition ? \"Parse error on line \" + (a + 1) + \":\\n\" + p.showPosition() + \"\\nExpecting \" + S.join(\", \") + \", got '\" + (this.terminals_[y] || y) + \"'\" : \"Parse error on line \" + (a + 1) + \": Unexpected \" + (1 == y ? \"end of input\" : \"'\" + (this.terminals_[y] || y) + \"'\"), this.parseError(I, {\n                      text: p.match,\n                      token: this.terminals_[y] || y,\n                      line: p.yylineno,\n                      loc: d,\n                      expected: S\n                    });\n                  }\n\n                  if (v[0] instanceof Array && v.length > 1) throw new Error(\"Parse Error: multiple actions possible at state: \" + _ + \", token: \" + y);\n\n                  switch (v[0]) {\n                    case 1:\n                      n.push(y), o.push(p.yytext), r.push(p.yylloc), n.push(v[1]), y = null, m ? (y = m, m = null) : (c = p.yyleng, s = p.yytext, a = p.yylineno, d = p.yylloc, u > 0 && u--);\n                      break;\n\n                    case 2:\n                      if (T = this.productions_[v[1]][1], C.$ = o[o.length - T], C._$ = {\n                        first_line: r[r.length - (T || 1)].first_line,\n                        last_line: r[r.length - 1].last_line,\n                        first_column: r[r.length - (T || 1)].first_column,\n                        last_column: r[r.length - 1].last_column\n                      }, g && (C._$.range = [r[r.length - (T || 1)].range[0], r[r.length - 1].range[1]]), void 0 !== (b = this.performAction.apply(C, [s, c, a, f.yy, v[1], o, r].concat(l)))) return b;\n                      T && (n = n.slice(0, -1 * T * 2), o = o.slice(0, -1 * T), r = r.slice(0, -1 * T)), n.push(this.productions_[v[1]][0]), o.push(C.$), r.push(C._$), x = i[n[n.length - 2]][n[n.length - 1]], n.push(x);\n                      break;\n\n                    case 3:\n                      return !0;\n                  }\n                }\n\n                return !0;\n              }\n            },\n                h = {\n              EOF: 1,\n              parseError: function (e, t) {\n                if (!this.yy.parser) throw new Error(e);\n                this.yy.parser.parseError(e, t);\n              },\n              setInput: function (e, t) {\n                return this.yy = t || this.yy || {}, this._input = e, this._more = this._backtrack = this.done = !1, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = \"\", this.conditionStack = [\"INITIAL\"], this.yylloc = {\n                  first_line: 1,\n                  first_column: 0,\n                  last_line: 1,\n                  last_column: 0\n                }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this;\n              },\n              input: function () {\n                var e = this._input[0];\n                return this.yytext += e, this.yyleng++, this.offset++, this.match += e, this.matched += e, e.match(/(?:\\r\\n?|\\n).*/g) ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), e;\n              },\n              unput: function (e) {\n                var t = e.length,\n                    n = e.split(/(?:\\r\\n?|\\n)/g);\n                this._input = e + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - t), this.offset -= t;\n                var o = this.match.split(/(?:\\r\\n?|\\n)/g);\n                this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), n.length - 1 && (this.yylineno -= n.length - 1);\n                var r = this.yylloc.range;\n                return this.yylloc = {\n                  first_line: this.yylloc.first_line,\n                  last_line: this.yylineno + 1,\n                  first_column: this.yylloc.first_column,\n                  last_column: n ? (n.length === o.length ? this.yylloc.first_column : 0) + o[o.length - n.length].length - n[0].length : this.yylloc.first_column - t\n                }, this.options.ranges && (this.yylloc.range = [r[0], r[0] + this.yyleng - t]), this.yyleng = this.yytext.length, this;\n              },\n              more: function () {\n                return this._more = !0, this;\n              },\n              reject: function () {\n                return this.options.backtrack_lexer ? (this._backtrack = !0, this) : this.parseError(\"Lexical error on line \" + (this.yylineno + 1) + \". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n\" + this.showPosition(), {\n                  text: \"\",\n                  token: null,\n                  line: this.yylineno\n                });\n              },\n              less: function (e) {\n                this.unput(this.match.slice(e));\n              },\n              pastInput: function () {\n                var e = this.matched.substr(0, this.matched.length - this.match.length);\n                return (e.length > 20 ? \"...\" : \"\") + e.substr(-20).replace(/\\n/g, \"\");\n              },\n              upcomingInput: function () {\n                var e = this.match;\n                return e.length < 20 && (e += this._input.substr(0, 20 - e.length)), (e.substr(0, 20) + (e.length > 20 ? \"...\" : \"\")).replace(/\\n/g, \"\");\n              },\n              showPosition: function () {\n                var e = this.pastInput(),\n                    t = new Array(e.length + 1).join(\"-\");\n                return e + this.upcomingInput() + \"\\n\" + t + \"^\";\n              },\n              test_match: function (e, t) {\n                var n, o, r;\n                if (this.options.backtrack_lexer && (r = {\n                  yylineno: this.yylineno,\n                  yylloc: {\n                    first_line: this.yylloc.first_line,\n                    last_line: this.last_line,\n                    first_column: this.yylloc.first_column,\n                    last_column: this.yylloc.last_column\n                  },\n                  yytext: this.yytext,\n                  match: this.match,\n                  matches: this.matches,\n                  matched: this.matched,\n                  yyleng: this.yyleng,\n                  offset: this.offset,\n                  _more: this._more,\n                  _input: this._input,\n                  yy: this.yy,\n                  conditionStack: this.conditionStack.slice(0),\n                  done: this.done\n                }, this.options.ranges && (r.yylloc.range = this.yylloc.range.slice(0))), (o = e[0].match(/(?:\\r\\n?|\\n).*/g)) && (this.yylineno += o.length), this.yylloc = {\n                  first_line: this.yylloc.last_line,\n                  last_line: this.yylineno + 1,\n                  first_column: this.yylloc.last_column,\n                  last_column: o ? o[o.length - 1].length - o[o.length - 1].match(/\\r?\\n?/)[0].length : this.yylloc.last_column + e[0].length\n                }, this.yytext += e[0], this.match += e[0], this.matches = e, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = !1, this._backtrack = !1, this._input = this._input.slice(e[0].length), this.matched += e[0], n = this.performAction.call(this, this.yy, this, t, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = !1), n) return n;\n\n                if (this._backtrack) {\n                  for (var i in r) this[i] = r[i];\n\n                  return !1;\n                }\n\n                return !1;\n              },\n              next: function () {\n                if (this.done) return this.EOF;\n                this._input || (this.done = !0);\n                var e, t, n, o;\n                this._more || (this.yytext = \"\", this.match = \"\");\n\n                for (var r = this._currentRules(), i = 0; i < r.length; i++) if ((n = this._input.match(this.rules[r[i]])) && (!t || n[0].length > t[0].length)) {\n                  if (t = n, o = i, this.options.backtrack_lexer) {\n                    if (!1 !== (e = this.test_match(n, r[i]))) return e;\n\n                    if (this._backtrack) {\n                      t = !1;\n                      continue;\n                    }\n\n                    return !1;\n                  }\n\n                  if (!this.options.flex) break;\n                }\n\n                return t ? !1 !== (e = this.test_match(t, r[o])) && e : \"\" === this._input ? this.EOF : this.parseError(\"Lexical error on line \" + (this.yylineno + 1) + \". Unrecognized text.\\n\" + this.showPosition(), {\n                  text: \"\",\n                  token: null,\n                  line: this.yylineno\n                });\n              },\n              lex: function () {\n                var e = this.next();\n                return e || this.lex();\n              },\n              begin: function (e) {\n                this.conditionStack.push(e);\n              },\n              popState: function () {\n                return this.conditionStack.length - 1 > 0 ? this.conditionStack.pop() : this.conditionStack[0];\n              },\n              _currentRules: function () {\n                return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules;\n              },\n              topState: function (e) {\n                return (e = this.conditionStack.length - 1 - Math.abs(e || 0)) >= 0 ? this.conditionStack[e] : \"INITIAL\";\n              },\n              pushState: function (e) {\n                this.begin(e);\n              },\n              stateStackSize: function () {\n                return this.conditionStack.length;\n              },\n              options: {},\n              performAction: function (e, t, n, o) {\n                switch (n) {\n                  case 0:\n                    break;\n\n                  case 1:\n                    return 6;\n\n                  case 2:\n                    return t.yytext = t.yytext.substr(1, t.yyleng - 2), 4;\n\n                  case 3:\n                    return 17;\n\n                  case 4:\n                    return 18;\n\n                  case 5:\n                    return 23;\n\n                  case 6:\n                    return 24;\n\n                  case 7:\n                    return 22;\n\n                  case 8:\n                    return 21;\n\n                  case 9:\n                    return 10;\n\n                  case 10:\n                    return 11;\n\n                  case 11:\n                    return 8;\n\n                  case 12:\n                    return 14;\n\n                  case 13:\n                    return \"INVALID\";\n                }\n              },\n              rules: [/^(?:\\s+)/, /^(?:(-?([0-9]|[1-9][0-9]+))(\\.[0-9]+)?([eE][-+]?[0-9]+)?\\b)/, /^(?:\"(?:\\\\[\\\\\"bfnrt\\/]|\\\\u[a-fA-F0-9]{4}|[^\\\\\\0-\\x09\\x0a-\\x1f\"])*\")/, /^(?:\\{)/, /^(?:\\})/, /^(?:\\[)/, /^(?:\\])/, /^(?:,)/, /^(?::)/, /^(?:true\\b)/, /^(?:false\\b)/, /^(?:null\\b)/, /^(?:$)/, /^(?:.)/],\n              conditions: {\n                INITIAL: {\n                  rules: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],\n                  inclusive: !0\n                }\n              }\n            };\n\n            return f.lexer = h, e.prototype = f, f.Parser = e, new e();\n          }();\n\n          void 0 !== e && void 0 !== n && (n.parser = r, n.Parser = r.Parser, n.parse = function () {\n            return r.parse.apply(r, arguments);\n          }, n.main = function (t) {\n            t[1] || (console.log(\"Usage: \" + t[0] + \" FILE\"), o.exit(1));\n            var r = e(\"fs\").readFileSync(e(\"path\").normalize(t[1]), \"utf8\");\n            return n.parser.parse(r);\n          }, void 0 !== t && e.main === t && n.main(o.argv.slice(1)));\n        }).call(this, e(\"_process\"));\n      }, {\n        _process: 18,\n        fs: 12,\n        path: 17\n      }],\n      16: [function (e, t, n) {\n        (function (e) {\n          function o(e, t) {\n            for (var n = -1, o = null == e ? 0 : e.length, r = 0, i = []; ++n < o;) {\n              var s = e[n];\n              t(s, n, e) && (i[r++] = s);\n            }\n\n            return i;\n          }\n\n          function r(e, t) {\n            for (var n = -1, o = t.length, r = e.length; ++n < o;) e[r + n] = t[n];\n\n            return e;\n          }\n\n          function i(e, t) {\n            for (var n = -1, o = null == e ? 0 : e.length; ++n < o;) if (t(e[n], n, e)) return !0;\n\n            return !1;\n          }\n\n          function s(e, t) {\n            for (var n = -1, o = Array(e); ++n < e;) o[n] = t(n);\n\n            return o;\n          }\n\n          function a(e, t) {\n            return e.has(t);\n          }\n\n          function c(e, t) {\n            return null == e ? void 0 : e[t];\n          }\n\n          function u(e) {\n            var t = -1,\n                n = Array(e.size);\n            return e.forEach(function (e, o) {\n              n[++t] = [o, e];\n            }), n;\n          }\n\n          function l(e) {\n            var t = -1,\n                n = Array(e.size);\n            return e.forEach(function (e) {\n              n[++t] = e;\n            }), n;\n          }\n\n          function p(e) {\n            var t = -1,\n                n = null == e ? 0 : e.length;\n\n            for (this.clear(); ++t < n;) {\n              var o = e[t];\n              this.set(o[0], o[1]);\n            }\n          }\n\n          function f(e) {\n            var t = -1,\n                n = null == e ? 0 : e.length;\n\n            for (this.clear(); ++t < n;) {\n              var o = e[t];\n              this.set(o[0], o[1]);\n            }\n          }\n\n          function h(e) {\n            var t = -1,\n                n = null == e ? 0 : e.length;\n\n            for (this.clear(); ++t < n;) {\n              var o = e[t];\n              this.set(o[0], o[1]);\n            }\n          }\n\n          function d(e) {\n            var t = -1,\n                n = null == e ? 0 : e.length;\n\n            for (this.__data__ = new h(); ++t < n;) this.add(e[t]);\n          }\n\n          function g(e) {\n            var t = this.__data__ = new f(e);\n            this.size = t.size;\n          }\n\n          function y(e, t) {\n            var n = ut(e),\n                o = !n && ct(e),\n                r = !n && !o && lt(e),\n                i = !n && !o && !r && pt(e),\n                a = n || o || r || i,\n                c = a ? s(e.length, String) : [],\n                u = c.length;\n\n            for (var l in e) !t && !Fe.call(e, l) || a && (\"length\" == l || r && (\"offset\" == l || \"parent\" == l) || i && (\"buffer\" == l || \"byteLength\" == l || \"byteOffset\" == l) || A(l, u)) || c.push(l);\n\n            return c;\n          }\n\n          function m(e, t) {\n            for (var n = e.length; n--;) if (D(e[n][0], t)) return n;\n\n            return -1;\n          }\n\n          function _(e, t, n) {\n            var o = t(e);\n            return ut(e) ? o : r(o, n(e));\n          }\n\n          function v(e) {\n            return null == e ? void 0 === e ? he : se : $e && $e in Object(e) ? N(e) : k(e);\n          }\n\n          function b(e) {\n            return $(e) && v(e) == K;\n          }\n\n          function E(e, t, n, o, r) {\n            return e === t || (null == e || null == t || !$(e) && !$(t) ? e !== e && t !== t : T(e, t, n, o, E, r));\n          }\n\n          function T(e, t, n, o, r, i) {\n            var s = ut(e),\n                a = ut(t),\n                c = s ? H : at(e),\n                u = a ? H : at(t),\n                l = (c = c == K ? ae : c) == ae,\n                p = (u = u == K ? ae : u) == ae,\n                f = c == u;\n\n            if (f && lt(e)) {\n              if (!lt(t)) return !1;\n              s = !0, l = !1;\n            }\n\n            if (f && !l) return i || (i = new g()), s || pt(e) ? O(e, t, n, o, r, i) : C(e, t, c, n, o, r, i);\n\n            if (!(n & Y)) {\n              var h = l && Fe.call(e, \"__wrapped__\"),\n                  d = p && Fe.call(t, \"__wrapped__\");\n\n              if (h || d) {\n                var y = h ? e.value() : e,\n                    m = d ? t.value() : t;\n                return i || (i = new g()), r(y, m, n, o, i);\n              }\n            }\n\n            return !!f && (i || (i = new g()), I(e, t, n, o, r, i));\n          }\n\n          function x(e) {\n            return !(!B(e) || F(e)) && (V(e) ? Re : me).test(R(e));\n          }\n\n          function S(e) {\n            if (!j(e)) return qe(e);\n            var t = [];\n\n            for (var n in Object(e)) Fe.call(e, n) && \"constructor\" != n && t.push(n);\n\n            return t;\n          }\n\n          function O(e, t, n, o, r, s) {\n            var c = n & Y,\n                u = e.length,\n                l = t.length;\n            if (u != l && !(c && l > u)) return !1;\n            var p = s.get(e);\n            if (p && s.get(t)) return p == t;\n            var f = -1,\n                h = !0,\n                g = n & X ? new d() : void 0;\n\n            for (s.set(e, t), s.set(t, e); ++f < u;) {\n              var y = e[f],\n                  m = t[f];\n              if (o) var _ = c ? o(m, y, f, t, e, s) : o(y, m, f, e, t, s);\n\n              if (void 0 !== _) {\n                if (_) continue;\n                h = !1;\n                break;\n              }\n\n              if (g) {\n                if (!i(t, function (e, t) {\n                  if (!a(g, t) && (y === e || r(y, e, n, o, s))) return g.push(t);\n                })) {\n                  h = !1;\n                  break;\n                }\n              } else if (y !== m && !r(y, m, n, o, s)) {\n                h = !1;\n                break;\n              }\n            }\n\n            return s.delete(e), s.delete(t), h;\n          }\n\n          function C(e, t, n, o, r, i, s) {\n            switch (n) {\n              case ge:\n                if (e.byteLength != t.byteLength || e.byteOffset != t.byteOffset) return !1;\n                e = e.buffer, t = t.buffer;\n\n              case de:\n                return !(e.byteLength != t.byteLength || !i(new Ve(e), new Ve(t)));\n\n              case Q:\n              case ee:\n              case ie:\n                return D(+e, +t);\n\n              case te:\n                return e.name == t.name && e.message == t.message;\n\n              case ue:\n              case pe:\n                return e == t + \"\";\n\n              case re:\n                var a = u;\n\n              case le:\n                var c = o & Y;\n                if (a || (a = l), e.size != t.size && !c) return !1;\n                var p = s.get(e);\n                if (p) return p == t;\n                o |= X, s.set(e, t);\n                var f = O(a(e), a(t), o, r, i, s);\n                return s.delete(e), f;\n\n              case fe:\n                if (it) return it.call(e) == it.call(t);\n            }\n\n            return !1;\n          }\n\n          function I(e, t, n, o, r, i) {\n            var s = n & Y,\n                a = L(e),\n                c = a.length;\n            if (c != L(t).length && !s) return !1;\n\n            for (var u = c; u--;) {\n              var l = a[u];\n              if (!(s ? l in t : Fe.call(t, l))) return !1;\n            }\n\n            var p = i.get(e);\n            if (p && i.get(t)) return p == t;\n            var f = !0;\n            i.set(e, t), i.set(t, e);\n\n            for (var h = s; ++u < c;) {\n              var d = e[l = a[u]],\n                  g = t[l];\n              if (o) var y = s ? o(g, d, l, t, e, i) : o(d, g, l, e, t, i);\n\n              if (!(void 0 === y ? d === g || r(d, g, n, o, i) : y)) {\n                f = !1;\n                break;\n              }\n\n              h || (h = \"constructor\" == l);\n            }\n\n            if (f && !h) {\n              var m = e.constructor,\n                  _ = t.constructor;\n              m != _ && \"constructor\" in e && \"constructor\" in t && !(\"function\" == typeof m && m instanceof m && \"function\" == typeof _ && _ instanceof _) && (f = !1);\n            }\n\n            return i.delete(e), i.delete(t), f;\n          }\n\n          function L(e) {\n            return _(e, J, st);\n          }\n\n          function M(e, t) {\n            var n = e.__data__;\n            return P(t) ? n[\"string\" == typeof t ? \"string\" : \"hash\"] : n.map;\n          }\n\n          function w(e, t) {\n            var n = c(e, t);\n            return x(n) ? n : void 0;\n          }\n\n          function N(e) {\n            var t = Fe.call(e, $e),\n                n = e[$e];\n\n            try {\n              e[$e] = void 0;\n              var o = !0;\n            } catch (e) {}\n\n            var r = ke.call(e);\n            return o && (t ? e[$e] = n : delete e[$e]), r;\n          }\n\n          function A(e, t) {\n            return !!(t = null == t ? W : t) && (\"number\" == typeof e || _e.test(e)) && e > -1 && e % 1 == 0 && e < t;\n          }\n\n          function P(e) {\n            var t = typeof e;\n            return \"string\" == t || \"number\" == t || \"symbol\" == t || \"boolean\" == t ? \"__proto__\" !== e : null === e;\n          }\n\n          function F(e) {\n            return !!je && je in e;\n          }\n\n          function j(e) {\n            var t = e && e.constructor;\n            return e === (\"function\" == typeof t && t.prototype || Ne);\n          }\n\n          function k(e) {\n            return ke.call(e);\n          }\n\n          function R(e) {\n            if (null != e) {\n              try {\n                return Pe.call(e);\n              } catch (e) {}\n\n              try {\n                return e + \"\";\n              } catch (e) {}\n            }\n\n            return \"\";\n          }\n\n          function D(e, t) {\n            return e === t || e !== e && t !== t;\n          }\n\n          function U(e) {\n            return null != e && G(e.length) && !V(e);\n          }\n\n          function V(e) {\n            if (!B(e)) return !1;\n            var t = v(e);\n            return t == ne || t == oe || t == Z || t == ce;\n          }\n\n          function G(e) {\n            return \"number\" == typeof e && e > -1 && e % 1 == 0 && e <= W;\n          }\n\n          function B(e) {\n            var t = typeof e;\n            return null != e && (\"object\" == t || \"function\" == t);\n          }\n\n          function $(e) {\n            return null != e && \"object\" == typeof e;\n          }\n\n          function J(e) {\n            return U(e) ? y(e) : S(e);\n          }\n\n          var z = 200,\n              q = \"__lodash_hash_undefined__\",\n              Y = 1,\n              X = 2,\n              W = 9007199254740991,\n              K = \"[object Arguments]\",\n              H = \"[object Array]\",\n              Z = \"[object AsyncFunction]\",\n              Q = \"[object Boolean]\",\n              ee = \"[object Date]\",\n              te = \"[object Error]\",\n              ne = \"[object Function]\",\n              oe = \"[object GeneratorFunction]\",\n              re = \"[object Map]\",\n              ie = \"[object Number]\",\n              se = \"[object Null]\",\n              ae = \"[object Object]\",\n              ce = \"[object Proxy]\",\n              ue = \"[object RegExp]\",\n              le = \"[object Set]\",\n              pe = \"[object String]\",\n              fe = \"[object Symbol]\",\n              he = \"[object Undefined]\",\n              de = \"[object ArrayBuffer]\",\n              ge = \"[object DataView]\",\n              ye = /[\\\\^$.*+?()[\\]{}|]/g,\n              me = /^\\[object .+?Constructor\\]$/,\n              _e = /^(?:0|[1-9]\\d*)$/,\n              ve = {};\n          ve[\"[object Float32Array]\"] = ve[\"[object Float64Array]\"] = ve[\"[object Int8Array]\"] = ve[\"[object Int16Array]\"] = ve[\"[object Int32Array]\"] = ve[\"[object Uint8Array]\"] = ve[\"[object Uint8ClampedArray]\"] = ve[\"[object Uint16Array]\"] = ve[\"[object Uint32Array]\"] = !0, ve[K] = ve[H] = ve[de] = ve[Q] = ve[ge] = ve[ee] = ve[te] = ve[ne] = ve[re] = ve[ie] = ve[ae] = ve[ue] = ve[le] = ve[pe] = ve[\"[object WeakMap]\"] = !1;\n\n          var be = \"object\" == typeof e && e && e.Object === Object && e,\n              Ee = \"object\" == typeof self && self && self.Object === Object && self,\n              Te = be || Ee || Function(\"return this\")(),\n              xe = \"object\" == typeof n && n && !n.nodeType && n,\n              Se = xe && \"object\" == typeof t && t && !t.nodeType && t,\n              Oe = Se && Se.exports === xe,\n              Ce = Oe && be.process,\n              Ie = function () {\n            try {\n              return Ce && Ce.binding && Ce.binding(\"util\");\n            } catch (e) {}\n          }(),\n              Le = Ie && Ie.isTypedArray,\n              Me = Array.prototype,\n              we = Function.prototype,\n              Ne = Object.prototype,\n              Ae = Te[\"__core-js_shared__\"],\n              Pe = we.toString,\n              Fe = Ne.hasOwnProperty,\n              je = function () {\n            var e = /[^.]+$/.exec(Ae && Ae.keys && Ae.keys.IE_PROTO || \"\");\n            return e ? \"Symbol(src)_1.\" + e : \"\";\n          }(),\n              ke = Ne.toString,\n              Re = RegExp(\"^\" + Pe.call(Fe).replace(ye, \"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, \"$1.*?\") + \"$\"),\n              De = Oe ? Te.Buffer : void 0,\n              Ue = Te.Symbol,\n              Ve = Te.Uint8Array,\n              Ge = Ne.propertyIsEnumerable,\n              Be = Me.splice,\n              $e = Ue ? Ue.toStringTag : void 0,\n              Je = Object.getOwnPropertySymbols,\n              ze = De ? De.isBuffer : void 0,\n              qe = function (e, t) {\n            return function (n) {\n              return e(t(n));\n            };\n          }(Object.keys, Object),\n              Ye = w(Te, \"DataView\"),\n              Xe = w(Te, \"Map\"),\n              We = w(Te, \"Promise\"),\n              Ke = w(Te, \"Set\"),\n              He = w(Te, \"WeakMap\"),\n              Ze = w(Object, \"create\"),\n              Qe = R(Ye),\n              et = R(Xe),\n              tt = R(We),\n              nt = R(Ke),\n              ot = R(He),\n              rt = Ue ? Ue.prototype : void 0,\n              it = rt ? rt.valueOf : void 0;\n\n          p.prototype.clear = function () {\n            this.__data__ = Ze ? Ze(null) : {}, this.size = 0;\n          }, p.prototype.delete = function (e) {\n            var t = this.has(e) && delete this.__data__[e];\n            return this.size -= t ? 1 : 0, t;\n          }, p.prototype.get = function (e) {\n            var t = this.__data__;\n\n            if (Ze) {\n              var n = t[e];\n              return n === q ? void 0 : n;\n            }\n\n            return Fe.call(t, e) ? t[e] : void 0;\n          }, p.prototype.has = function (e) {\n            var t = this.__data__;\n            return Ze ? void 0 !== t[e] : Fe.call(t, e);\n          }, p.prototype.set = function (e, t) {\n            var n = this.__data__;\n            return this.size += this.has(e) ? 0 : 1, n[e] = Ze && void 0 === t ? q : t, this;\n          }, f.prototype.clear = function () {\n            this.__data__ = [], this.size = 0;\n          }, f.prototype.delete = function (e) {\n            var t = this.__data__,\n                n = m(t, e);\n            return !(n < 0 || (n == t.length - 1 ? t.pop() : Be.call(t, n, 1), --this.size, 0));\n          }, f.prototype.get = function (e) {\n            var t = this.__data__,\n                n = m(t, e);\n            return n < 0 ? void 0 : t[n][1];\n          }, f.prototype.has = function (e) {\n            return m(this.__data__, e) > -1;\n          }, f.prototype.set = function (e, t) {\n            var n = this.__data__,\n                o = m(n, e);\n            return o < 0 ? (++this.size, n.push([e, t])) : n[o][1] = t, this;\n          }, h.prototype.clear = function () {\n            this.size = 0, this.__data__ = {\n              hash: new p(),\n              map: new (Xe || f)(),\n              string: new p()\n            };\n          }, h.prototype.delete = function (e) {\n            var t = M(this, e).delete(e);\n            return this.size -= t ? 1 : 0, t;\n          }, h.prototype.get = function (e) {\n            return M(this, e).get(e);\n          }, h.prototype.has = function (e) {\n            return M(this, e).has(e);\n          }, h.prototype.set = function (e, t) {\n            var n = M(this, e),\n                o = n.size;\n            return n.set(e, t), this.size += n.size == o ? 0 : 1, this;\n          }, d.prototype.add = d.prototype.push = function (e) {\n            return this.__data__.set(e, q), this;\n          }, d.prototype.has = function (e) {\n            return this.__data__.has(e);\n          }, g.prototype.clear = function () {\n            this.__data__ = new f(), this.size = 0;\n          }, g.prototype.delete = function (e) {\n            var t = this.__data__,\n                n = t.delete(e);\n            return this.size = t.size, n;\n          }, g.prototype.get = function (e) {\n            return this.__data__.get(e);\n          }, g.prototype.has = function (e) {\n            return this.__data__.has(e);\n          }, g.prototype.set = function (e, t) {\n            var n = this.__data__;\n\n            if (n instanceof f) {\n              var o = n.__data__;\n              if (!Xe || o.length < z - 1) return o.push([e, t]), this.size = ++n.size, this;\n              n = this.__data__ = new h(o);\n            }\n\n            return n.set(e, t), this.size = n.size, this;\n          };\n          var st = Je ? function (e) {\n            return null == e ? [] : (e = Object(e), o(Je(e), function (t) {\n              return Ge.call(e, t);\n            }));\n          } : function () {\n            return [];\n          },\n              at = v;\n          (Ye && at(new Ye(new ArrayBuffer(1))) != ge || Xe && at(new Xe()) != re || We && \"[object Promise]\" != at(We.resolve()) || Ke && at(new Ke()) != le || He && \"[object WeakMap]\" != at(new He())) && (at = function (e) {\n            var t = v(e),\n                n = t == ae ? e.constructor : void 0,\n                o = n ? R(n) : \"\";\n            if (o) switch (o) {\n              case Qe:\n                return ge;\n\n              case et:\n                return re;\n\n              case tt:\n                return \"[object Promise]\";\n\n              case nt:\n                return le;\n\n              case ot:\n                return \"[object WeakMap]\";\n            }\n            return t;\n          });\n\n          var ct = b(function () {\n            return arguments;\n          }()) ? b : function (e) {\n            return $(e) && Fe.call(e, \"callee\") && !Ge.call(e, \"callee\");\n          },\n              ut = Array.isArray,\n              lt = ze || function () {\n            return !1;\n          },\n              pt = Le ? function (e) {\n            return function (t) {\n              return e(t);\n            };\n          }(Le) : function (e) {\n            return $(e) && G(e.length) && !!ve[v(e)];\n          };\n\n          t.exports = function (e, t) {\n            return E(e, t);\n          };\n        }).call(this, \"undefined\" != typeof commonjsGlobal ? commonjsGlobal : \"undefined\" != typeof self ? self : \"undefined\" != typeof window ? window : {});\n      }, {}],\n      17: [function (e, t, n) {\n        (function (e) {\n          function t(e, t) {\n            for (var n = 0, o = e.length - 1; o >= 0; o--) {\n              var r = e[o];\n              \".\" === r ? e.splice(o, 1) : \"..\" === r ? (e.splice(o, 1), n++) : n && (e.splice(o, 1), n--);\n            }\n\n            if (t) for (; n--; n) e.unshift(\"..\");\n            return e;\n          }\n\n          function o(e, t) {\n            if (e.filter) return e.filter(t);\n\n            for (var n = [], o = 0; o < e.length; o++) t(e[o], o, e) && n.push(e[o]);\n\n            return n;\n          }\n\n          var r = /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/,\n              i = function (e) {\n            return r.exec(e).slice(1);\n          };\n\n          n.resolve = function () {\n            for (var n = \"\", r = !1, i = arguments.length - 1; i >= -1 && !r; i--) {\n              var s = i >= 0 ? arguments[i] : e.cwd();\n              if (\"string\" != typeof s) throw new TypeError(\"Arguments to path.resolve must be strings\");\n              s && (n = s + \"/\" + n, r = \"/\" === s.charAt(0));\n            }\n\n            return n = t(o(n.split(\"/\"), function (e) {\n              return !!e;\n            }), !r).join(\"/\"), (r ? \"/\" : \"\") + n || \".\";\n          }, n.normalize = function (e) {\n            var r = n.isAbsolute(e),\n                i = \"/\" === s(e, -1);\n            return (e = t(o(e.split(\"/\"), function (e) {\n              return !!e;\n            }), !r).join(\"/\")) || r || (e = \".\"), e && i && (e += \"/\"), (r ? \"/\" : \"\") + e;\n          }, n.isAbsolute = function (e) {\n            return \"/\" === e.charAt(0);\n          }, n.join = function () {\n            var e = Array.prototype.slice.call(arguments, 0);\n            return n.normalize(o(e, function (e, t) {\n              if (\"string\" != typeof e) throw new TypeError(\"Arguments to path.join must be strings\");\n              return e;\n            }).join(\"/\"));\n          }, n.relative = function (e, t) {\n            function o(e) {\n              for (var t = 0; t < e.length && \"\" === e[t]; t++);\n\n              for (var n = e.length - 1; n >= 0 && \"\" === e[n]; n--);\n\n              return t > n ? [] : e.slice(t, n - t + 1);\n            }\n\n            e = n.resolve(e).substr(1), t = n.resolve(t).substr(1);\n\n            for (var r = o(e.split(\"/\")), i = o(t.split(\"/\")), s = Math.min(r.length, i.length), a = s, c = 0; c < s; c++) if (r[c] !== i[c]) {\n              a = c;\n              break;\n            }\n\n            for (var u = [], c = a; c < r.length; c++) u.push(\"..\");\n\n            return (u = u.concat(i.slice(a))).join(\"/\");\n          }, n.sep = \"/\", n.delimiter = \":\", n.dirname = function (e) {\n            var t = i(e),\n                n = t[0],\n                o = t[1];\n            return n || o ? (o && (o = o.substr(0, o.length - 1)), n + o) : \".\";\n          }, n.basename = function (e, t) {\n            var n = i(e)[2];\n            return t && n.substr(-1 * t.length) === t && (n = n.substr(0, n.length - t.length)), n;\n          }, n.extname = function (e) {\n            return i(e)[3];\n          };\n          var s = \"b\" === \"ab\".substr(-1) ? function (e, t, n) {\n            return e.substr(t, n);\n          } : function (e, t, n) {\n            return t < 0 && (t = e.length + t), e.substr(t, n);\n          };\n        }).call(this, e(\"_process\"));\n      }, {\n        _process: 18\n      }],\n      18: [function (e, t, n) {\n        function o() {\n          throw new Error(\"setTimeout has not been defined\");\n        }\n\n        function r() {\n          throw new Error(\"clearTimeout has not been defined\");\n        }\n\n        function i(e) {\n          if (p === setTimeout) return setTimeout(e, 0);\n          if ((p === o || !p) && setTimeout) return p = setTimeout, setTimeout(e, 0);\n\n          try {\n            return p(e, 0);\n          } catch (t) {\n            try {\n              return p.call(null, e, 0);\n            } catch (t) {\n              return p.call(this, e, 0);\n            }\n          }\n        }\n\n        function s(e) {\n          if (f === clearTimeout) return clearTimeout(e);\n          if ((f === r || !f) && clearTimeout) return f = clearTimeout, clearTimeout(e);\n\n          try {\n            return f(e);\n          } catch (t) {\n            try {\n              return f.call(null, e);\n            } catch (t) {\n              return f.call(this, e);\n            }\n          }\n        }\n\n        function a() {\n          y && d && (y = !1, d.length ? g = d.concat(g) : m = -1, g.length && c());\n        }\n\n        function c() {\n          if (!y) {\n            var e = i(a);\n            y = !0;\n\n            for (var t = g.length; t;) {\n              for (d = g, g = []; ++m < t;) d && d[m].run();\n\n              m = -1, t = g.length;\n            }\n\n            d = null, y = !1, s(e);\n          }\n        }\n\n        function u(e, t) {\n          this.fun = e, this.array = t;\n        }\n\n        function l() {}\n\n        var p,\n            f,\n            h = t.exports = {};\n        !function () {\n          try {\n            p = \"function\" == typeof setTimeout ? setTimeout : o;\n          } catch (e) {\n            p = o;\n          }\n\n          try {\n            f = \"function\" == typeof clearTimeout ? clearTimeout : r;\n          } catch (e) {\n            f = r;\n          }\n        }();\n        var d,\n            g = [],\n            y = !1,\n            m = -1;\n        h.nextTick = function (e) {\n          var t = new Array(arguments.length - 1);\n          if (arguments.length > 1) for (var n = 1; n < arguments.length; n++) t[n - 1] = arguments[n];\n          g.push(new u(e, t)), 1 !== g.length || y || i(c);\n        }, u.prototype.run = function () {\n          this.fun.apply(null, this.array);\n        }, h.title = \"browser\", h.browser = !0, h.env = {}, h.argv = [], h.version = \"\", h.versions = {}, h.on = l, h.addListener = l, h.once = l, h.off = l, h.removeListener = l, h.removeAllListeners = l, h.emit = l, h.prependListener = l, h.prependOnceListener = l, h.listeners = function (e) {\n          return [];\n        }, h.binding = function (e) {\n          throw new Error(\"process.binding is not supported\");\n        }, h.cwd = function () {\n          return \"/\";\n        }, h.chdir = function (e) {\n          throw new Error(\"process.chdir is not supported\");\n        }, h.umask = function () {\n          return 0;\n        };\n      }, {}],\n      19: [function (e, t, n) {\n        function o(e) {\n          this.value = e;\n        }\n\n        function r(e, t, n) {\n          var o = [],\n              r = [],\n              s = !0;\n          return function e(a) {\n            function c() {\n              if (\"object\" == typeof p.node && null !== p.node) {\n                p.keys && p.node_ === p.node || (p.keys = d(p.node)), p.isLeaf = 0 == p.keys.length;\n\n                for (var e = 0; e < r.length; e++) if (r[e].node_ === a) {\n                  p.circular = r[e];\n                  break;\n                }\n              } else p.isLeaf = !0, p.keys = null;\n\n              p.notLeaf = !p.isLeaf, p.notRoot = !p.isRoot;\n            }\n\n            var u = {},\n                l = !0,\n                p = {\n              node: n ? i(a) : a,\n              node_: a,\n              path: [].concat(o),\n              parent: r[r.length - 1],\n              parents: r,\n              key: o.slice(-1)[0],\n              isRoot: 0 === o.length,\n              level: o.length,\n              circular: null,\n              update: function (e, t) {\n                p.isRoot || (p.parent.node[p.key] = e), p.node = e, t && (l = !1);\n              },\n              delete: function (e) {\n                delete p.parent.node[p.key], e && (l = !1);\n              },\n              remove: function (e) {\n                g(p.parent.node) ? p.parent.node.splice(p.key, 1) : delete p.parent.node[p.key], e && (l = !1);\n              },\n              keys: null,\n              before: function (e) {\n                u.before = e;\n              },\n              after: function (e) {\n                u.after = e;\n              },\n              pre: function (e) {\n                u.pre = e;\n              },\n              post: function (e) {\n                u.post = e;\n              },\n              stop: function () {\n                s = !1;\n              },\n              block: function () {\n                l = !1;\n              }\n            };\n            if (!s) return p;\n            c();\n            var f = t.call(p, p.node);\n            return void 0 !== f && p.update && p.update(f), u.before && u.before.call(p, p.node), l ? (\"object\" != typeof p.node || null === p.node || p.circular || (r.push(p), c(), y(p.keys, function (t, r) {\n              o.push(t), u.pre && u.pre.call(p, p.node[t], t);\n              var i = e(p.node[t]);\n              n && m.call(p.node, t) && (p.node[t] = i.node), i.isLast = r == p.keys.length - 1, i.isFirst = 0 == r, u.post && u.post.call(p, i), o.pop();\n            }), r.pop()), u.after && u.after.call(p, p.node), p) : p;\n          }(e).node;\n        }\n\n        function i(e) {\n          if (\"object\" == typeof e && null !== e) {\n            var t;\n            if (g(e)) t = [];else if (a(e)) t = new Date(e.getTime ? e.getTime() : e);else if (c(e)) t = new RegExp(e);else if (u(e)) t = {\n              message: e.message\n            };else if (l(e)) t = new Boolean(e);else if (p(e)) t = new Number(e);else if (f(e)) t = new String(e);else if (Object.create && Object.getPrototypeOf) t = Object.create(Object.getPrototypeOf(e));else if (e.constructor === Object) t = {};else {\n              var n = e.constructor && e.constructor.prototype || e.__proto__ || {},\n                  o = function () {};\n\n              o.prototype = n, t = new o();\n            }\n            return y(d(e), function (n) {\n              t[n] = e[n];\n            }), t;\n          }\n\n          return e;\n        }\n\n        function s(e) {\n          return Object.prototype.toString.call(e);\n        }\n\n        function a(e) {\n          return \"[object Date]\" === s(e);\n        }\n\n        function c(e) {\n          return \"[object RegExp]\" === s(e);\n        }\n\n        function u(e) {\n          return \"[object Error]\" === s(e);\n        }\n\n        function l(e) {\n          return \"[object Boolean]\" === s(e);\n        }\n\n        function p(e) {\n          return \"[object Number]\" === s(e);\n        }\n\n        function f(e) {\n          return \"[object String]\" === s(e);\n        }\n\n        var h = t.exports = function (e) {\n          return new o(e);\n        };\n\n        o.prototype.get = function (e) {\n          for (var t = this.value, n = 0; n < e.length; n++) {\n            var o = e[n];\n\n            if (!t || !m.call(t, o)) {\n              t = void 0;\n              break;\n            }\n\n            t = t[o];\n          }\n\n          return t;\n        }, o.prototype.has = function (e) {\n          for (var t = this.value, n = 0; n < e.length; n++) {\n            var o = e[n];\n            if (!t || !m.call(t, o)) return !1;\n            t = t[o];\n          }\n\n          return !0;\n        }, o.prototype.set = function (e, t) {\n          for (var n = this.value, o = 0; o < e.length - 1; o++) {\n            var r = e[o];\n            m.call(n, r) || (n[r] = {}), n = n[r];\n          }\n\n          return n[e[o]] = t, t;\n        }, o.prototype.map = function (e) {\n          return r(this.value, e, !0);\n        }, o.prototype.forEach = function (e) {\n          return this.value = r(this.value, e, !1), this.value;\n        }, o.prototype.reduce = function (e, t) {\n          var n = 1 === arguments.length,\n              o = n ? this.value : t;\n          return this.forEach(function (t) {\n            this.isRoot && n || (o = e.call(this, o, t));\n          }), o;\n        }, o.prototype.paths = function () {\n          var e = [];\n          return this.forEach(function (t) {\n            e.push(this.path);\n          }), e;\n        }, o.prototype.nodes = function () {\n          var e = [];\n          return this.forEach(function (t) {\n            e.push(this.node);\n          }), e;\n        }, o.prototype.clone = function () {\n          var e = [],\n              t = [];\n          return function n(o) {\n            for (var r = 0; r < e.length; r++) if (e[r] === o) return t[r];\n\n            if (\"object\" == typeof o && null !== o) {\n              var s = i(o);\n              return e.push(o), t.push(s), y(d(o), function (e) {\n                s[e] = n(o[e]);\n              }), e.pop(), t.pop(), s;\n            }\n\n            return o;\n          }(this.value);\n        };\n\n        var d = Object.keys || function (e) {\n          var t = [];\n\n          for (var n in e) t.push(n);\n\n          return t;\n        },\n            g = Array.isArray || function (e) {\n          return \"[object Array]\" === Object.prototype.toString.call(e);\n        },\n            y = function (e, t) {\n          if (e.forEach) return e.forEach(t);\n\n          for (var n = 0; n < e.length; n++) t(e[n], n, e);\n        };\n\n        y(d(o.prototype), function (e) {\n          h[e] = function (t) {\n            var n = [].slice.call(arguments, 1),\n                r = new o(t);\n            return r[e].apply(r, n);\n          };\n        });\n\n        var m = Object.hasOwnProperty || function (e, t) {\n          return t in e;\n        };\n      }, {}],\n      20: [function (e, t, n) {\n        t.exports.RADIUS = 6378137, t.exports.FLATTENING = 1 / 298.257223563, t.exports.POLAR_RADIUS = 6356752.3142;\n      }, {}],\n      21: [function (e, t, n) {\n        t.exports = function () {\n          for (var e = {}, t = 0; t < arguments.length; t++) {\n            var n = arguments[t];\n\n            for (var r in n) o.call(n, r) && (e[r] = n[r]);\n          }\n\n          return e;\n        };\n\n        var o = Object.prototype.hasOwnProperty;\n      }, {}],\n      22: [function (e, t, n) {\n        var o = e(\"lodash.isequal\"),\n            r = e(\"@mapbox/geojson-normalize\"),\n            i = e(\"hat\"),\n            s = e(\"./lib/features_at\"),\n            a = e(\"./lib/string_sets_are_equal\"),\n            c = e(\"@mapbox/geojsonhint\"),\n            u = e(\"./constants\"),\n            l = e(\"./lib/string_set\"),\n            p = {\n          Polygon: e(\"./feature_types/polygon\"),\n          LineString: e(\"./feature_types/line_string\"),\n          Point: e(\"./feature_types/point\"),\n          MultiPolygon: e(\"./feature_types/multi_feature\"),\n          MultiLineString: e(\"./feature_types/multi_feature\"),\n          MultiPoint: e(\"./feature_types/multi_feature\")\n        };\n\n        t.exports = function (e, t) {\n          return t.modes = u.modes, t.getFeatureIdsAt = function (t) {\n            return s.click({\n              point: t\n            }, null, e).map(function (e) {\n              return e.properties.id;\n            });\n          }, t.getSelectedIds = function () {\n            return e.store.getSelectedIds();\n          }, t.getSelected = function () {\n            return {\n              type: u.geojsonTypes.FEATURE_COLLECTION,\n              features: e.store.getSelectedIds().map(function (t) {\n                return e.store.get(t);\n              }).map(function (e) {\n                return e.toGeoJSON();\n              })\n            };\n          }, t.getSelectedPoints = function () {\n            return {\n              type: u.geojsonTypes.FEATURE_COLLECTION,\n              features: e.store.getSelectedCoordinates().map(function (e) {\n                return {\n                  type: u.geojsonTypes.FEATURE,\n                  properties: {},\n                  geometry: {\n                    type: u.geojsonTypes.POINT,\n                    coordinates: e.coordinates\n                  }\n                };\n              })\n            };\n          }, t.set = function (n) {\n            if (void 0 === n.type || n.type !== u.geojsonTypes.FEATURE_COLLECTION || !Array.isArray(n.features)) throw new Error(\"Invalid FeatureCollection\");\n            var o = e.store.createRenderBatch(),\n                r = e.store.getAllIds().slice(),\n                i = t.add(n),\n                s = new l(i);\n            return (r = r.filter(function (e) {\n              return !s.has(e);\n            })).length && t.delete(r), o(), i;\n          }, t.add = function (t) {\n            var n = c.hint(t, {\n              precisionWarning: !1\n            }).filter(function (e) {\n              return \"message\" !== e.level;\n            });\n            if (n.length) throw new Error(n[0].message);\n            var s = JSON.parse(JSON.stringify(r(t))).features.map(function (t) {\n              if (t.id = t.id || i(), null === t.geometry) throw new Error(\"Invalid geometry: null\");\n\n              if (void 0 === e.store.get(t.id) || e.store.get(t.id).type !== t.geometry.type) {\n                var n = p[t.geometry.type];\n                if (void 0 === n) throw new Error(\"Invalid geometry type: \".concat(t.geometry.type, \".\"));\n                var r = new n(e, t);\n                e.store.add(r);\n              } else {\n                var s = e.store.get(t.id);\n                s.properties = t.properties, o(s.getCoordinates(), t.geometry.coordinates) || s.incomingCoords(t.geometry.coordinates);\n              }\n\n              return t.id;\n            });\n            return e.store.render(), s;\n          }, t.get = function (t) {\n            var n = e.store.get(t);\n            if (n) return n.toGeoJSON();\n          }, t.getAll = function () {\n            return {\n              type: u.geojsonTypes.FEATURE_COLLECTION,\n              features: e.store.getAll().map(function (e) {\n                return e.toGeoJSON();\n              })\n            };\n          }, t.delete = function (n) {\n            return e.store.delete(n, {\n              silent: !0\n            }), t.getMode() !== u.modes.DIRECT_SELECT || e.store.getSelectedIds().length ? e.store.render() : e.events.changeMode(u.modes.SIMPLE_SELECT, void 0, {\n              silent: !0\n            }), t;\n          }, t.deleteAll = function () {\n            return e.store.delete(e.store.getAllIds(), {\n              silent: !0\n            }), t.getMode() === u.modes.DIRECT_SELECT ? e.events.changeMode(u.modes.SIMPLE_SELECT, void 0, {\n              silent: !0\n            }) : e.store.render(), t;\n          }, t.changeMode = function (n) {\n            var o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n            return n === u.modes.SIMPLE_SELECT && t.getMode() === u.modes.SIMPLE_SELECT ? a(o.featureIds || [], e.store.getSelectedIds()) ? t : (e.store.setSelected(o.featureIds, {\n              silent: !0\n            }), e.store.render(), t) : n === u.modes.DIRECT_SELECT && t.getMode() === u.modes.DIRECT_SELECT && o.featureId === e.store.getSelectedIds()[0] ? t : (e.events.changeMode(n, o, {\n              silent: !0\n            }), t);\n          }, t.getMode = function () {\n            return e.events.getMode();\n          }, t.trash = function () {\n            return e.events.trash({\n              silent: !0\n            }), t;\n          }, t.combineFeatures = function () {\n            return e.events.combineFeatures({\n              silent: !0\n            }), t;\n          }, t.uncombineFeatures = function () {\n            return e.events.uncombineFeatures({\n              silent: !0\n            }), t;\n          }, t.setFeatureProperty = function (n, o, r) {\n            return e.store.setFeatureProperty(n, o, r), t;\n          }, t;\n        };\n      }, {\n        \"./constants\": 23,\n        \"./feature_types/line_string\": 26,\n        \"./feature_types/multi_feature\": 27,\n        \"./feature_types/point\": 28,\n        \"./feature_types/polygon\": 29,\n        \"./lib/features_at\": 37,\n        \"./lib/string_set\": 47,\n        \"./lib/string_sets_are_equal\": 48,\n        \"@mapbox/geojson-normalize\": 7,\n        \"@mapbox/geojsonhint\": 8,\n        hat: 14,\n        \"lodash.isequal\": 16\n      }],\n      23: [function (e, t, n) {\n        t.exports = {\n          classes: {\n            CONTROL_BASE: \"mapboxgl-ctrl\",\n            CONTROL_PREFIX: \"mapboxgl-ctrl-\",\n            CONTROL_BUTTON: \"mapbox-gl-draw_ctrl-draw-btn\",\n            CONTROL_BUTTON_LINE: \"mapbox-gl-draw_line\",\n            CONTROL_BUTTON_POLYGON: \"mapbox-gl-draw_polygon\",\n            CONTROL_BUTTON_POINT: \"mapbox-gl-draw_point\",\n            CONTROL_BUTTON_TRASH: \"mapbox-gl-draw_trash\",\n            CONTROL_BUTTON_COMBINE_FEATURES: \"mapbox-gl-draw_combine\",\n            CONTROL_BUTTON_UNCOMBINE_FEATURES: \"mapbox-gl-draw_uncombine\",\n            CONTROL_GROUP: \"mapboxgl-ctrl-group\",\n            ATTRIBUTION: \"mapboxgl-ctrl-attrib\",\n            ACTIVE_BUTTON: \"active\",\n            BOX_SELECT: \"mapbox-gl-draw_boxselect\"\n          },\n          sources: {\n            HOT: \"mapbox-gl-draw-hot\",\n            COLD: \"mapbox-gl-draw-cold\"\n          },\n          cursors: {\n            ADD: \"add\",\n            MOVE: \"move\",\n            DRAG: \"drag\",\n            POINTER: \"pointer\",\n            NONE: \"none\"\n          },\n          types: {\n            POLYGON: \"polygon\",\n            LINE: \"line_string\",\n            POINT: \"point\"\n          },\n          geojsonTypes: {\n            FEATURE: \"Feature\",\n            POLYGON: \"Polygon\",\n            LINE_STRING: \"LineString\",\n            POINT: \"Point\",\n            FEATURE_COLLECTION: \"FeatureCollection\",\n            MULTI_PREFIX: \"Multi\",\n            MULTI_POINT: \"MultiPoint\",\n            MULTI_LINE_STRING: \"MultiLineString\",\n            MULTI_POLYGON: \"MultiPolygon\"\n          },\n          modes: {\n            DRAW_LINE_STRING: \"draw_line_string\",\n            DRAW_POLYGON: \"draw_polygon\",\n            DRAW_POINT: \"draw_point\",\n            SIMPLE_SELECT: \"simple_select\",\n            DIRECT_SELECT: \"direct_select\",\n            STATIC: \"static\"\n          },\n          events: {\n            CREATE: \"draw.create\",\n            DELETE: \"draw.delete\",\n            UPDATE: \"draw.update\",\n            SELECTION_CHANGE: \"draw.selectionchange\",\n            MODE_CHANGE: \"draw.modechange\",\n            ACTIONABLE: \"draw.actionable\",\n            RENDER: \"draw.render\",\n            COMBINE_FEATURES: \"draw.combine\",\n            UNCOMBINE_FEATURES: \"draw.uncombine\"\n          },\n          updateActions: {\n            MOVE: \"move\",\n            CHANGE_COORDINATES: \"change_coordinates\"\n          },\n          meta: {\n            FEATURE: \"feature\",\n            MIDPOINT: \"midpoint\",\n            VERTEX: \"vertex\"\n          },\n          activeStates: {\n            ACTIVE: \"true\",\n            INACTIVE: \"false\"\n          },\n          interactions: [\"scrollZoom\", \"boxZoom\", \"dragRotate\", \"dragPan\", \"keyboard\", \"doubleClickZoom\", \"touchZoomRotate\"],\n          LAT_MIN: -90,\n          LAT_RENDERED_MIN: -85,\n          LAT_MAX: 90,\n          LAT_RENDERED_MAX: 85,\n          LNG_MIN: -270,\n          LNG_MAX: 270\n        };\n      }, {}],\n      24: [function (e, t, n) {\n        var o = e(\"./lib/mode_handler\"),\n            r = e(\"./lib/get_features_and_set_cursor\"),\n            i = e(\"./lib/features_at\"),\n            s = e(\"./lib/is_click\"),\n            a = e(\"./lib/is_tap\"),\n            c = e(\"./constants\"),\n            u = e(\"./modes/object_to_mode\");\n\n        t.exports = function (e) {\n          function t(t, r) {\n            var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n            d.stop();\n            var s = n[t];\n            if (void 0 === s) throw new Error(\"\".concat(t, \" is not valid\"));\n            h = t;\n            var a = s(e, r);\n            d = o(a, e), i.silent || e.map.fire(c.events.MODE_CHANGE, {\n              mode: t\n            }), e.store.setDirty(), e.store.render();\n          }\n\n          var n = Object.keys(e.options.modes).reduce(function (t, n) {\n            return t[n] = u(e.options.modes[n]), t;\n          }, {}),\n              l = {},\n              p = {},\n              f = {},\n              h = null,\n              d = null;\n          f.drag = function (t, n) {\n            n({\n              point: t.point,\n              time: new Date().getTime()\n            }) ? (e.ui.queueMapClasses({\n              mouse: c.cursors.DRAG\n            }), d.drag(t)) : t.originalEvent.stopPropagation();\n          }, f.mousedrag = function (e) {\n            f.drag(e, function (e) {\n              return !s(l, e);\n            });\n          }, f.touchdrag = function (e) {\n            f.drag(e, function (e) {\n              return !a(p, e);\n            });\n          }, f.mousemove = function (t) {\n            if (1 === (void 0 !== t.originalEvent.buttons ? t.originalEvent.buttons : t.originalEvent.which)) return f.mousedrag(t);\n            var n = r(t, e);\n            t.featureTarget = n, d.mousemove(t);\n          }, f.mousedown = function (t) {\n            l = {\n              time: new Date().getTime(),\n              point: t.point\n            };\n            var n = r(t, e);\n            t.featureTarget = n, d.mousedown(t);\n          }, f.mouseup = function (t) {\n            var n = r(t, e);\n            t.featureTarget = n, s(l, {\n              point: t.point,\n              time: new Date().getTime()\n            }) ? d.click(t) : d.mouseup(t);\n          }, f.mouseout = function (e) {\n            d.mouseout(e);\n          }, f.touchstart = function (t) {\n            if (t.originalEvent.preventDefault(), e.options.touchEnabled) {\n              p = {\n                time: new Date().getTime(),\n                point: t.point\n              };\n              var n = i.touch(t, null, e)[0];\n              t.featureTarget = n, d.touchstart(t);\n            }\n          }, f.touchmove = function (t) {\n            if (t.originalEvent.preventDefault(), e.options.touchEnabled) return d.touchmove(t), f.touchdrag(t);\n          }, f.touchend = function (t) {\n            if (t.originalEvent.preventDefault(), e.options.touchEnabled) {\n              var n = i.touch(t, null, e)[0];\n              t.featureTarget = n, a(p, {\n                time: new Date().getTime(),\n                point: t.point\n              }) ? d.tap(t) : d.touchend(t);\n            }\n          };\n\n          var g = function (e) {\n            return !(8 === e || 46 === e || e >= 48 && e <= 57);\n          };\n\n          f.keydown = function (n) {\n            \"mapboxgl-canvas\" === (n.srcElement || n.target).classList[0] && (8 !== n.keyCode && 46 !== n.keyCode || !e.options.controls.trash ? g(n.keyCode) ? d.keydown(n) : 49 === n.keyCode && e.options.controls.point ? t(c.modes.DRAW_POINT) : 50 === n.keyCode && e.options.controls.line_string ? t(c.modes.DRAW_LINE_STRING) : 51 === n.keyCode && e.options.controls.polygon && t(c.modes.DRAW_POLYGON) : (n.preventDefault(), d.trash()));\n          }, f.keyup = function (e) {\n            g(e.keyCode) && d.keyup(e);\n          }, f.zoomend = function () {\n            e.store.changeZoom();\n          }, f.data = function (t) {\n            if (\"style\" === t.dataType) {\n              var n = e.setup,\n                  o = e.map,\n                  r = e.options,\n                  i = e.store;\n              r.styles.some(function (e) {\n                return o.getLayer(e.id);\n              }) || (n.addLayers(), i.setDirty(), i.render());\n            }\n          };\n          var y = {\n            trash: !1,\n            combineFeatures: !1,\n            uncombineFeatures: !1\n          };\n          return {\n            start: function () {\n              h = e.options.defaultMode, d = o(n[h](e), e);\n            },\n            changeMode: t,\n            actionable: function (t) {\n              var n = !1;\n              Object.keys(t).forEach(function (e) {\n                if (void 0 === y[e]) throw new Error(\"Invalid action type\");\n                y[e] !== t[e] && (n = !0), y[e] = t[e];\n              }), n && e.map.fire(c.events.ACTIONABLE, {\n                actions: y\n              });\n            },\n            currentModeName: function () {\n              return h;\n            },\n            currentModeRender: function (e, t) {\n              return d.render(e, t);\n            },\n            fire: function (e, t) {\n              f[e] && f[e](t);\n            },\n            addEventListeners: function () {\n              e.map.on(\"mousemove\", f.mousemove), e.map.on(\"mousedown\", f.mousedown), e.map.on(\"mouseup\", f.mouseup), e.map.on(\"data\", f.data), e.map.on(\"touchmove\", f.touchmove), e.map.on(\"touchstart\", f.touchstart), e.map.on(\"touchend\", f.touchend), e.container.addEventListener(\"mouseout\", f.mouseout), e.options.keybindings && (e.container.addEventListener(\"keydown\", f.keydown), e.container.addEventListener(\"keyup\", f.keyup));\n            },\n            removeEventListeners: function () {\n              e.map.off(\"mousemove\", f.mousemove), e.map.off(\"mousedown\", f.mousedown), e.map.off(\"mouseup\", f.mouseup), e.map.off(\"data\", f.data), e.map.off(\"touchmove\", f.touchmove), e.map.off(\"touchstart\", f.touchstart), e.map.off(\"touchend\", f.touchend), e.container.removeEventListener(\"mouseout\", f.mouseout), e.options.keybindings && (e.container.removeEventListener(\"keydown\", f.keydown), e.container.removeEventListener(\"keyup\", f.keyup));\n            },\n            trash: function (e) {\n              d.trash(e);\n            },\n            combineFeatures: function () {\n              d.combineFeatures();\n            },\n            uncombineFeatures: function () {\n              d.uncombineFeatures();\n            },\n            getMode: function () {\n              return h;\n            }\n          };\n        };\n      }, {\n        \"./constants\": 23,\n        \"./lib/features_at\": 37,\n        \"./lib/get_features_and_set_cursor\": 38,\n        \"./lib/is_click\": 39,\n        \"./lib/is_tap\": 41,\n        \"./lib/mode_handler\": 43,\n        \"./modes/object_to_mode\": 59\n      }],\n      25: [function (e, t, n) {\n        var o = e(\"hat\"),\n            r = e(\"../constants\"),\n            i = function (e, t) {\n          this.ctx = e, this.properties = t.properties || {}, this.coordinates = t.geometry.coordinates, this.id = t.id || o(), this.type = t.geometry.type;\n        };\n\n        i.prototype.changed = function () {\n          this.ctx.store.featureChanged(this.id);\n        }, i.prototype.incomingCoords = function (e) {\n          this.setCoordinates(e);\n        }, i.prototype.setCoordinates = function (e) {\n          this.coordinates = e, this.changed();\n        }, i.prototype.getCoordinates = function () {\n          return JSON.parse(JSON.stringify(this.coordinates));\n        }, i.prototype.setProperty = function (e, t) {\n          this.properties[e] = t;\n        }, i.prototype.toGeoJSON = function () {\n          return JSON.parse(JSON.stringify({\n            id: this.id,\n            type: r.geojsonTypes.FEATURE,\n            properties: this.properties,\n            geometry: {\n              coordinates: this.getCoordinates(),\n              type: this.type\n            }\n          }));\n        }, i.prototype.internal = function (e) {\n          var t = {\n            id: this.id,\n            meta: r.meta.FEATURE,\n            \"meta:type\": this.type,\n            active: r.activeStates.INACTIVE,\n            mode: e\n          };\n          if (this.ctx.options.userProperties) for (var n in this.properties) t[\"user_\".concat(n)] = this.properties[n];\n          return {\n            type: r.geojsonTypes.FEATURE,\n            properties: t,\n            geometry: {\n              coordinates: this.getCoordinates(),\n              type: this.type\n            }\n          };\n        }, t.exports = i;\n      }, {\n        \"../constants\": 23,\n        hat: 14\n      }],\n      26: [function (e, t, n) {\n        var o = e(\"./feature\"),\n            r = function (e, t) {\n          o.call(this, e, t);\n        };\n\n        (r.prototype = Object.create(o.prototype)).isValid = function () {\n          return this.coordinates.length > 1;\n        }, r.prototype.addCoordinate = function (e, t, n) {\n          this.changed();\n          var o = parseInt(e, 10);\n          this.coordinates.splice(o, 0, [t, n]);\n        }, r.prototype.getCoordinate = function (e) {\n          var t = parseInt(e, 10);\n          return JSON.parse(JSON.stringify(this.coordinates[t]));\n        }, r.prototype.removeCoordinate = function (e) {\n          this.changed(), this.coordinates.splice(parseInt(e, 10), 1);\n        }, r.prototype.updateCoordinate = function (e, t, n) {\n          var o = parseInt(e, 10);\n          this.coordinates[o] = [t, n], this.changed();\n        }, t.exports = r;\n      }, {\n        \"./feature\": 25\n      }],\n      27: [function (e, t, n) {\n        var o = e(\"./feature\"),\n            r = e(\"../constants\"),\n            i = e(\"hat\"),\n            s = {\n          MultiPoint: e(\"./point\"),\n          MultiLineString: e(\"./line_string\"),\n          MultiPolygon: e(\"./polygon\")\n        },\n            a = function (e, t, n, o, r) {\n          var i = n.split(\".\"),\n              s = parseInt(i[0], 10),\n              a = i[1] ? i.slice(1).join(\".\") : null;\n          return e[s][t](a, o, r);\n        },\n            c = function (e, t) {\n          if (o.call(this, e, t), delete this.coordinates, this.model = s[t.geometry.type], void 0 === this.model) throw new TypeError(\"\".concat(t.geometry.type, \" is not a valid type\"));\n          this.features = this._coordinatesToFeatures(t.geometry.coordinates);\n        };\n\n        (c.prototype = Object.create(o.prototype))._coordinatesToFeatures = function (e) {\n          var t = this,\n              n = this.model.bind(this);\n          return e.map(function (e) {\n            return new n(t.ctx, {\n              id: i(),\n              type: r.geojsonTypes.FEATURE,\n              properties: {},\n              geometry: {\n                coordinates: e,\n                type: t.type.replace(\"Multi\", \"\")\n              }\n            });\n          });\n        }, c.prototype.isValid = function () {\n          return this.features.every(function (e) {\n            return e.isValid();\n          });\n        }, c.prototype.setCoordinates = function (e) {\n          this.features = this._coordinatesToFeatures(e), this.changed();\n        }, c.prototype.getCoordinate = function (e) {\n          return a(this.features, \"getCoordinate\", e);\n        }, c.prototype.getCoordinates = function () {\n          return JSON.parse(JSON.stringify(this.features.map(function (e) {\n            return e.type === r.geojsonTypes.POLYGON ? e.getCoordinates() : e.coordinates;\n          })));\n        }, c.prototype.updateCoordinate = function (e, t, n) {\n          a(this.features, \"updateCoordinate\", e, t, n), this.changed();\n        }, c.prototype.addCoordinate = function (e, t, n) {\n          a(this.features, \"addCoordinate\", e, t, n), this.changed();\n        }, c.prototype.removeCoordinate = function (e) {\n          a(this.features, \"removeCoordinate\", e), this.changed();\n        }, c.prototype.getFeatures = function () {\n          return this.features;\n        }, t.exports = c;\n      }, {\n        \"../constants\": 23,\n        \"./feature\": 25,\n        \"./line_string\": 26,\n        \"./point\": 28,\n        \"./polygon\": 29,\n        hat: 14\n      }],\n      28: [function (e, t, n) {\n        var o = e(\"./feature\"),\n            r = function (e, t) {\n          o.call(this, e, t);\n        };\n\n        (r.prototype = Object.create(o.prototype)).isValid = function () {\n          return \"number\" == typeof this.coordinates[0] && \"number\" == typeof this.coordinates[1];\n        }, r.prototype.updateCoordinate = function (e, t, n) {\n          3 === arguments.length ? this.coordinates = [t, n] : this.coordinates = [e, t], this.changed();\n        }, r.prototype.getCoordinate = function () {\n          return this.getCoordinates();\n        }, t.exports = r;\n      }, {\n        \"./feature\": 25\n      }],\n      29: [function (e, t, n) {\n        var o = e(\"./feature\"),\n            r = function (e, t) {\n          o.call(this, e, t), this.coordinates = this.coordinates.map(function (e) {\n            return e.slice(0, -1);\n          });\n        };\n\n        (r.prototype = Object.create(o.prototype)).isValid = function () {\n          return 0 !== this.coordinates.length && this.coordinates.every(function (e) {\n            return e.length > 2;\n          });\n        }, r.prototype.incomingCoords = function (e) {\n          this.coordinates = e.map(function (e) {\n            return e.slice(0, -1);\n          }), this.changed();\n        }, r.prototype.setCoordinates = function (e) {\n          this.coordinates = e, this.changed();\n        }, r.prototype.addCoordinate = function (e, t, n) {\n          this.changed();\n          var o = e.split(\".\").map(function (e) {\n            return parseInt(e, 10);\n          });\n          this.coordinates[o[0]].splice(o[1], 0, [t, n]);\n        }, r.prototype.removeCoordinate = function (e) {\n          this.changed();\n          var t = e.split(\".\").map(function (e) {\n            return parseInt(e, 10);\n          }),\n              n = this.coordinates[t[0]];\n          n && (n.splice(t[1], 1), n.length < 3 && this.coordinates.splice(t[0], 1));\n        }, r.prototype.getCoordinate = function (e) {\n          var t = e.split(\".\").map(function (e) {\n            return parseInt(e, 10);\n          }),\n              n = this.coordinates[t[0]];\n          return JSON.parse(JSON.stringify(n[t[1]]));\n        }, r.prototype.getCoordinates = function () {\n          return this.coordinates.map(function (e) {\n            return e.concat([e[0]]);\n          });\n        }, r.prototype.updateCoordinate = function (e, t, n) {\n          this.changed();\n          var o = e.split(\".\"),\n              r = parseInt(o[0], 10),\n              i = parseInt(o[1], 10);\n          void 0 === this.coordinates[r] && (this.coordinates[r] = []), this.coordinates[r][i] = [t, n];\n        }, t.exports = r;\n      }, {\n        \"./feature\": 25\n      }],\n      30: [function (e, t, n) {\n        var o = e(\"../constants\");\n        t.exports = {\n          isOfMetaType: function (e) {\n            return function (t) {\n              var n = t.featureTarget;\n              return !!n && !!n.properties && n.properties.meta === e;\n            };\n          },\n          isShiftMousedown: function (e) {\n            return !!e.originalEvent && !!e.originalEvent.shiftKey && 0 === e.originalEvent.button;\n          },\n          isActiveFeature: function (e) {\n            return !!e.featureTarget && !!e.featureTarget.properties && e.featureTarget.properties.active === o.activeStates.ACTIVE && e.featureTarget.properties.meta === o.meta.FEATURE;\n          },\n          isInactiveFeature: function (e) {\n            return !!e.featureTarget && !!e.featureTarget.properties && e.featureTarget.properties.active === o.activeStates.INACTIVE && e.featureTarget.properties.meta === o.meta.FEATURE;\n          },\n          noTarget: function (e) {\n            return void 0 === e.featureTarget;\n          },\n          isFeature: function (e) {\n            return !!e.featureTarget && !!e.featureTarget.properties && e.featureTarget.properties.meta === o.meta.FEATURE;\n          },\n          isVertex: function (e) {\n            var t = e.featureTarget;\n            return !!t && !!t.properties && t.properties.meta === o.meta.VERTEX;\n          },\n          isShiftDown: function (e) {\n            return !!e.originalEvent && !0 === e.originalEvent.shiftKey;\n          },\n          isEscapeKey: function (e) {\n            return 27 === e.keyCode;\n          },\n          isEnterKey: function (e) {\n            return 13 === e.keyCode;\n          },\n          true: function () {\n            return !0;\n          }\n        };\n      }, {\n        \"../constants\": 23\n      }],\n      31: [function (e, t, n) {\n        var o = e(\"@mapbox/geojson-extent\"),\n            r = e(\"../constants\"),\n            i = r.LAT_MIN,\n            s = r.LAT_MAX,\n            a = r.LAT_RENDERED_MIN,\n            c = r.LAT_RENDERED_MAX,\n            u = r.LNG_MIN,\n            l = r.LNG_MAX;\n\n        t.exports = function (e, t) {\n          var n = i,\n              r = s,\n              p = i,\n              f = s,\n              h = l,\n              d = u;\n          e.forEach(function (e) {\n            var t = o(e),\n                i = t[1],\n                s = t[3],\n                a = t[0],\n                c = t[2];\n            i > n && (n = i), s < r && (r = s), s > p && (p = s), i < f && (f = i), a < h && (h = a), c > d && (d = c);\n          });\n          var g = t;\n          return n + g.lat > c && (g.lat = c - n), p + g.lat > s && (g.lat = s - p), r + g.lat < a && (g.lat = a - r), f + g.lat < i && (g.lat = i - f), h + g.lng <= u && (g.lng += 360 * Math.ceil(Math.abs(g.lng) / 360)), d + g.lng >= l && (g.lng -= 360 * Math.ceil(Math.abs(g.lng) / 360)), g;\n        };\n      }, {\n        \"../constants\": 23,\n        \"@mapbox/geojson-extent\": 6\n      }],\n      32: [function (e, t, n) {\n        var o = e(\"../constants\");\n\n        t.exports = function (e, t, n, r) {\n          var i = t.geometry.coordinates,\n              s = n.geometry.coordinates;\n          if (i[1] > o.LAT_RENDERED_MAX || i[1] < o.LAT_RENDERED_MIN || s[1] > o.LAT_RENDERED_MAX || s[1] < o.LAT_RENDERED_MIN) return null;\n          var a = r.project([i[0], i[1]]),\n              c = r.project([s[0], s[1]]),\n              u = r.unproject([(a.x + c.x) / 2, (a.y + c.y) / 2]);\n          return {\n            type: o.geojsonTypes.FEATURE,\n            properties: {\n              meta: o.meta.MIDPOINT,\n              parent: e,\n              lng: u.lng,\n              lat: u.lat,\n              coord_path: n.properties.coord_path\n            },\n            geometry: {\n              type: o.geojsonTypes.POINT,\n              coordinates: [u.lng, u.lat]\n            }\n          };\n        };\n      }, {\n        \"../constants\": 23\n      }],\n      33: [function (e, t, n) {\n        function o(e) {\n          function t(e, t) {\n            var o = \"\",\n                s = null;\n            e.forEach(function (e, c) {\n              var u = void 0 !== t && null !== t ? \"\".concat(t, \".\").concat(c) : String(c),\n                  l = r(f, e, u, n(u));\n\n              if (a.midpoints && s) {\n                var p = i(f, s, l, a.map);\n                p && h.push(p);\n              }\n\n              s = l;\n              var d = JSON.stringify(e);\n              o !== d && h.push(l), 0 === c && (o = d);\n            });\n          }\n\n          function n(e) {\n            return !!a.selectedPaths && -1 !== a.selectedPaths.indexOf(e);\n          }\n\n          var a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n              c = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null,\n              u = e.geometry,\n              l = u.type,\n              p = u.coordinates,\n              f = e.properties && e.properties.id,\n              h = [];\n          return l === s.geojsonTypes.POINT ? h.push(r(f, p, c, n(c))) : l === s.geojsonTypes.POLYGON ? p.forEach(function (e, n) {\n            t(e, null !== c ? \"\".concat(c, \".\").concat(n) : String(n));\n          }) : l === s.geojsonTypes.LINE_STRING ? t(p, c) : 0 === l.indexOf(s.geojsonTypes.MULTI_PREFIX) && function () {\n            var t = l.replace(s.geojsonTypes.MULTI_PREFIX, \"\");\n            p.forEach(function (n, r) {\n              var i = {\n                type: s.geojsonTypes.FEATURE,\n                properties: e.properties,\n                geometry: {\n                  type: t,\n                  coordinates: n\n                }\n              };\n              h = h.concat(o(i, a, r));\n            });\n          }(), h;\n        }\n\n        var r = e(\"./create_vertex\"),\n            i = e(\"./create_midpoint\"),\n            s = e(\"../constants\");\n        t.exports = o;\n      }, {\n        \"../constants\": 23,\n        \"./create_midpoint\": 32,\n        \"./create_vertex\": 34\n      }],\n      34: [function (e, t, n) {\n        var o = e(\"../constants\");\n\n        t.exports = function (e, t, n, r) {\n          return {\n            type: o.geojsonTypes.FEATURE,\n            properties: {\n              meta: o.meta.VERTEX,\n              parent: e,\n              coord_path: n,\n              active: r ? o.activeStates.ACTIVE : o.activeStates.INACTIVE\n            },\n            geometry: {\n              type: o.geojsonTypes.POINT,\n              coordinates: t\n            }\n          };\n        };\n      }, {\n        \"../constants\": 23\n      }],\n      35: [function (e, t, n) {\n        t.exports = {\n          enable: function (e) {\n            setTimeout(function () {\n              e.map && e.map.doubleClickZoom && e._ctx && e._ctx.store && e._ctx.store.getInitialConfigValue && e._ctx.store.getInitialConfigValue(\"doubleClickZoom\") && e.map.doubleClickZoom.enable();\n            }, 0);\n          },\n          disable: function (e) {\n            setTimeout(function () {\n              e.map && e.map.doubleClickZoom && e.map.doubleClickZoom.disable();\n            }, 0);\n          }\n        };\n      }, {}],\n      36: [function (e, t, n) {\n        t.exports = function (e, t) {\n          var n = e.x - t.x,\n              o = e.y - t.y;\n          return Math.sqrt(n * n + o * o);\n        };\n      }, {}],\n      37: [function (e, t, n) {\n        function o(e, t, n, o) {\n          if (null === n.map) return [];\n          var s = e ? i(e, o) : t,\n              u = {};\n          n.options.styles && (u.layers = n.options.styles.map(function (e) {\n            return e.id;\n          }));\n          var l = n.map.queryRenderedFeatures(s, u).filter(function (e) {\n            return -1 !== c.indexOf(e.properties.meta);\n          }),\n              p = new a(),\n              f = [];\n          return l.forEach(function (e) {\n            var t = e.properties.id;\n            p.has(t) || (p.add(t), f.push(e));\n          }), r(f);\n        }\n\n        var r = e(\"./sort_features\"),\n            i = e(\"./map_event_to_bounding_box\"),\n            s = e(\"../constants\"),\n            a = e(\"./string_set\"),\n            c = [s.meta.FEATURE, s.meta.MIDPOINT, s.meta.VERTEX];\n        t.exports = {\n          click: function (e, t, n) {\n            return o(e, t, n, n.options.clickBuffer);\n          },\n          touch: function (e, t, n) {\n            return o(e, t, n, n.options.touchBuffer);\n          }\n        };\n      }, {\n        \"../constants\": 23,\n        \"./map_event_to_bounding_box\": 42,\n        \"./sort_features\": 46,\n        \"./string_set\": 47\n      }],\n      38: [function (e, t, n) {\n        var o = e(\"./features_at\"),\n            r = e(\"../constants\");\n\n        t.exports = function (e, t) {\n          var n = o.click(e, null, t),\n              i = {\n            mouse: r.cursors.NONE\n          };\n          return n[0] && (i.mouse = n[0].properties.active === r.activeStates.ACTIVE ? r.cursors.MOVE : r.cursors.POINTER, i.feature = n[0].properties.meta), -1 !== t.events.currentModeName().indexOf(\"draw\") && (i.mouse = r.cursors.ADD), t.ui.queueMapClasses(i), t.ui.updateMapClasses(), n[0];\n        };\n      }, {\n        \"../constants\": 23,\n        \"./features_at\": 37\n      }],\n      39: [function (e, t, n) {\n        var o = e(\"./euclidean_distance\");\n\n        t.exports = function (e, t) {\n          var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n              r = null != n.fineTolerance ? n.fineTolerance : 4,\n              i = null != n.grossTolerance ? n.grossTolerance : 12,\n              s = null != n.interval ? n.interval : 500;\n          e.point = e.point || t.point, e.time = e.time || t.time;\n          var a = o(e.point, t.point);\n          return a < r || a < i && t.time - e.time < s;\n        };\n      }, {\n        \"./euclidean_distance\": 36\n      }],\n      40: [function (e, t, n) {\n        t.exports = function (e, t) {\n          return !!e.lngLat && e.lngLat.lng === t[0] && e.lngLat.lat === t[1];\n        };\n      }, {}],\n      41: [function (e, t, n) {\n        var o = e(\"./euclidean_distance\");\n\n        t.exports = function (e, t) {\n          var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n              r = null != n.tolerance ? n.tolerance : 25,\n              i = null != n.interval ? n.interval : 250;\n          return e.point = e.point || t.point, e.time = e.time || t.time, o(e.point, t.point) < r && t.time - e.time < i;\n        };\n      }, {\n        \"./euclidean_distance\": 36\n      }],\n      42: [function (e, t, n) {\n        t.exports = function (e) {\n          var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;\n          return [[e.point.x - t, e.point.y - t], [e.point.x + t, e.point.y + t]];\n        };\n      }, {}],\n      43: [function (e, t, n) {\n        t.exports = function (e, t) {\n          var n = {\n            drag: [],\n            click: [],\n            mousemove: [],\n            mousedown: [],\n            mouseup: [],\n            mouseout: [],\n            keydown: [],\n            keyup: [],\n            touchstart: [],\n            touchmove: [],\n            touchend: [],\n            tap: []\n          },\n              o = {\n            on: function (e, t, o) {\n              if (void 0 === n[e]) throw new Error(\"Invalid event type: \".concat(e));\n              n[e].push({\n                selector: t,\n                fn: o\n              });\n            },\n            render: function (e) {\n              t.store.featureChanged(e);\n            }\n          },\n              r = function (e, r) {\n            for (var i = n[e], s = i.length; s--;) {\n              var a = i[s];\n\n              if (a.selector(r)) {\n                a.fn.call(o, r), t.store.render(), t.ui.updateMapClasses();\n                break;\n              }\n            }\n          };\n\n          return e.start.call(o), {\n            render: e.render,\n            stop: function () {\n              e.stop && e.stop();\n            },\n            trash: function () {\n              e.trash && (e.trash(), t.store.render());\n            },\n            combineFeatures: function () {\n              e.combineFeatures && e.combineFeatures();\n            },\n            uncombineFeatures: function () {\n              e.uncombineFeatures && e.uncombineFeatures();\n            },\n            drag: function (e) {\n              r(\"drag\", e);\n            },\n            click: function (e) {\n              r(\"click\", e);\n            },\n            mousemove: function (e) {\n              r(\"mousemove\", e);\n            },\n            mousedown: function (e) {\n              r(\"mousedown\", e);\n            },\n            mouseup: function (e) {\n              r(\"mouseup\", e);\n            },\n            mouseout: function (e) {\n              r(\"mouseout\", e);\n            },\n            keydown: function (e) {\n              r(\"keydown\", e);\n            },\n            keyup: function (e) {\n              r(\"keyup\", e);\n            },\n            touchstart: function (e) {\n              r(\"touchstart\", e);\n            },\n            touchmove: function (e) {\n              r(\"touchmove\", e);\n            },\n            touchend: function (e) {\n              r(\"touchend\", e);\n            },\n            tap: function (e) {\n              r(\"tap\", e);\n            }\n          };\n        };\n      }, {}],\n      44: [function (e, t, n) {\n        var o = e(\"@mapbox/point-geometry\");\n\n        t.exports = function (e, t) {\n          var n = t.getBoundingClientRect();\n          return new o(e.clientX - n.left - (t.clientLeft || 0), e.clientY - n.top - (t.clientTop || 0));\n        };\n      }, {\n        \"@mapbox/point-geometry\": 11\n      }],\n      45: [function (e, t, n) {\n        var o = e(\"./constrain_feature_movement\"),\n            r = e(\"../constants\");\n\n        t.exports = function (e, t) {\n          var n = o(e.map(function (e) {\n            return e.toGeoJSON();\n          }), t);\n          e.forEach(function (e) {\n            var t,\n                o = e.getCoordinates(),\n                i = function (e) {\n              var t = {\n                lng: e[0] + n.lng,\n                lat: e[1] + n.lat\n              };\n              return [t.lng, t.lat];\n            },\n                s = function (e) {\n              return e.map(function (e) {\n                return i(e);\n              });\n            };\n\n            e.type === r.geojsonTypes.POINT ? t = i(o) : e.type === r.geojsonTypes.LINE_STRING || e.type === r.geojsonTypes.MULTI_POINT ? t = o.map(i) : e.type === r.geojsonTypes.POLYGON || e.type === r.geojsonTypes.MULTI_LINE_STRING ? t = o.map(s) : e.type === r.geojsonTypes.MULTI_POLYGON && (t = o.map(function (e) {\n              return e.map(function (e) {\n                return s(e);\n              });\n            })), e.incomingCoords(t);\n          });\n        };\n      }, {\n        \"../constants\": 23,\n        \"./constrain_feature_movement\": 31\n      }],\n      46: [function (e, t, n) {\n        function o(e, t) {\n          var n = s[e.geometry.type] - s[t.geometry.type];\n          return 0 === n && e.geometry.type === i.geojsonTypes.POLYGON ? e.area - t.area : n;\n        }\n\n        var r = e(\"@mapbox/geojson-area\"),\n            i = e(\"../constants\"),\n            s = {\n          Point: 0,\n          LineString: 1,\n          Polygon: 2\n        };\n\n        t.exports = function (e) {\n          return e.map(function (e) {\n            return e.geometry.type === i.geojsonTypes.POLYGON && (e.area = r.geometry({\n              type: i.geojsonTypes.FEATURE,\n              property: {},\n              geometry: e.geometry\n            })), e;\n          }).sort(o).map(function (e) {\n            return delete e.area, e;\n          });\n        };\n      }, {\n        \"../constants\": 23,\n        \"@mapbox/geojson-area\": 3\n      }],\n      47: [function (e, t, n) {\n        function o(e) {\n          if (this._items = {}, this._nums = {}, this._length = e ? e.length : 0, e) for (var t = 0, n = e.length; t < n; t++) this.add(e[t]), void 0 !== e[t] && (\"string\" == typeof e[t] ? this._items[e[t]] = t : this._nums[e[t]] = t);\n        }\n\n        o.prototype.add = function (e) {\n          return this.has(e) ? this : (this._length++, \"string\" == typeof e ? this._items[e] = this._length : this._nums[e] = this._length, this);\n        }, o.prototype.delete = function (e) {\n          return !1 === this.has(e) ? this : (this._length--, delete this._items[e], delete this._nums[e], this);\n        }, o.prototype.has = function (e) {\n          return (\"string\" == typeof e || \"number\" == typeof e) && (void 0 !== this._items[e] || void 0 !== this._nums[e]);\n        }, o.prototype.values = function () {\n          var e = this,\n              t = [];\n          return Object.keys(this._items).forEach(function (n) {\n            t.push({\n              k: n,\n              v: e._items[n]\n            });\n          }), Object.keys(this._nums).forEach(function (n) {\n            t.push({\n              k: JSON.parse(n),\n              v: e._nums[n]\n            });\n          }), t.sort(function (e, t) {\n            return e.v - t.v;\n          }).map(function (e) {\n            return e.k;\n          });\n        }, o.prototype.clear = function () {\n          return this._length = 0, this._items = {}, this._nums = {}, this;\n        }, t.exports = o;\n      }, {}],\n      48: [function (e, t, n) {\n        t.exports = function (e, t) {\n          return e.length === t.length && JSON.stringify(e.map(function (e) {\n            return e;\n          }).sort()) === JSON.stringify(t.map(function (e) {\n            return e;\n          }).sort());\n        };\n      }, {}],\n      49: [function (e, t, n) {\n        t.exports = [{\n          id: \"gl-draw-polygon-fill-inactive\",\n          type: \"fill\",\n          filter: [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\n          paint: {\n            \"fill-color\": \"#3bb2d0\",\n            \"fill-outline-color\": \"#3bb2d0\",\n            \"fill-opacity\": .1\n          }\n        }, {\n          id: \"gl-draw-polygon-fill-active\",\n          type: \"fill\",\n          filter: [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],\n          paint: {\n            \"fill-color\": \"#fbb03b\",\n            \"fill-outline-color\": \"#fbb03b\",\n            \"fill-opacity\": .1\n          }\n        }, {\n          id: \"gl-draw-polygon-midpoint\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"meta\", \"midpoint\"]],\n          paint: {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#fbb03b\"\n          }\n        }, {\n          id: \"gl-draw-polygon-stroke-inactive\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#3bb2d0\",\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-polygon-stroke-active\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#fbb03b\",\n            \"line-dasharray\": [.2, 2],\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-line-inactive\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"LineString\"], [\"!=\", \"mode\", \"static\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#3bb2d0\",\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-line-active\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"$type\", \"LineString\"], [\"==\", \"active\", \"true\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#fbb03b\",\n            \"line-dasharray\": [.2, 2],\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-polygon-and-line-vertex-stroke-inactive\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"], [\"!=\", \"mode\", \"static\"]],\n          paint: {\n            \"circle-radius\": 5,\n            \"circle-color\": \"#fff\"\n          }\n        }, {\n          id: \"gl-draw-polygon-and-line-vertex-inactive\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"], [\"!=\", \"mode\", \"static\"]],\n          paint: {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#fbb03b\"\n          }\n        }, {\n          id: \"gl-draw-point-point-stroke-inactive\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Point\"], [\"==\", \"meta\", \"feature\"], [\"!=\", \"mode\", \"static\"]],\n          paint: {\n            \"circle-radius\": 5,\n            \"circle-opacity\": 1,\n            \"circle-color\": \"#fff\"\n          }\n        }, {\n          id: \"gl-draw-point-inactive\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Point\"], [\"==\", \"meta\", \"feature\"], [\"!=\", \"mode\", \"static\"]],\n          paint: {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#3bb2d0\"\n          }\n        }, {\n          id: \"gl-draw-point-stroke-active\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"active\", \"true\"], [\"!=\", \"meta\", \"midpoint\"]],\n          paint: {\n            \"circle-radius\": 7,\n            \"circle-color\": \"#fff\"\n          }\n        }, {\n          id: \"gl-draw-point-active\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"$type\", \"Point\"], [\"!=\", \"meta\", \"midpoint\"], [\"==\", \"active\", \"true\"]],\n          paint: {\n            \"circle-radius\": 5,\n            \"circle-color\": \"#fbb03b\"\n          }\n        }, {\n          id: \"gl-draw-polygon-fill-static\",\n          type: \"fill\",\n          filter: [\"all\", [\"==\", \"mode\", \"static\"], [\"==\", \"$type\", \"Polygon\"]],\n          paint: {\n            \"fill-color\": \"#404040\",\n            \"fill-outline-color\": \"#404040\",\n            \"fill-opacity\": .1\n          }\n        }, {\n          id: \"gl-draw-polygon-stroke-static\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"mode\", \"static\"], [\"==\", \"$type\", \"Polygon\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#404040\",\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-line-static\",\n          type: \"line\",\n          filter: [\"all\", [\"==\", \"mode\", \"static\"], [\"==\", \"$type\", \"LineString\"]],\n          layout: {\n            \"line-cap\": \"round\",\n            \"line-join\": \"round\"\n          },\n          paint: {\n            \"line-color\": \"#404040\",\n            \"line-width\": 2\n          }\n        }, {\n          id: \"gl-draw-point-static\",\n          type: \"circle\",\n          filter: [\"all\", [\"==\", \"mode\", \"static\"], [\"==\", \"$type\", \"Point\"]],\n          paint: {\n            \"circle-radius\": 5,\n            \"circle-color\": \"#404040\"\n          }\n        }];\n      }, {}],\n      50: [function (e, t, n) {\n        t.exports = function (e, t, n) {\n          function o() {\n            i = !1, s && (r.apply(n, s), s = !1);\n          }\n\n          function r() {\n            i ? s = arguments : (i = !0, e.apply(n, arguments), setTimeout(o, t));\n          }\n\n          var i, s;\n          return r;\n        };\n      }, {}],\n      51: [function (e, t, n) {\n        t.exports = function (e) {\n          return [].concat(e).filter(function (e) {\n            return void 0 !== e;\n          });\n        };\n      }, {}],\n      52: [function (e, t, n) {\n        var o = e(\"../lib/common_selectors\"),\n            r = o.noTarget,\n            i = o.isOfMetaType,\n            s = o.isInactiveFeature,\n            a = o.isShiftDown,\n            c = e(\"../lib/create_supplementary_points\"),\n            u = e(\"../lib/constrain_feature_movement\"),\n            l = e(\"../lib/double_click_zoom\"),\n            p = e(\"../constants\"),\n            f = e(\"../lib/common_selectors\"),\n            h = e(\"../lib/move_features\"),\n            d = i(p.meta.VERTEX),\n            g = i(p.meta.MIDPOINT),\n            y = {};\n        y.fireUpdate = function () {\n          this.map.fire(p.events.UPDATE, {\n            action: p.updateActions.CHANGE_COORDINATES,\n            features: this.getSelected().map(function (e) {\n              return e.toGeoJSON();\n            })\n          });\n        }, y.fireActionable = function (e) {\n          this.setActionableState({\n            combineFeatures: !1,\n            uncombineFeatures: !1,\n            trash: e.selectedCoordPaths.length > 0\n          });\n        }, y.startDragging = function (e, t) {\n          this.map.dragPan.disable(), e.canDragMove = !0, e.dragMoveLocation = t.lngLat;\n        }, y.stopDragging = function (e) {\n          this.map.dragPan.enable(), e.dragMoving = !1, e.canDragMove = !1, e.dragMoveLocation = null;\n        }, y.onVertex = function (e, t) {\n          this.startDragging(e, t);\n          var n = t.featureTarget.properties,\n              o = e.selectedCoordPaths.indexOf(n.coord_path);\n          a(t) || -1 !== o ? a(t) && -1 === o && e.selectedCoordPaths.push(n.coord_path) : e.selectedCoordPaths = [n.coord_path];\n          var r = this.pathsToCoordinates(e.featureId, e.selectedCoordPaths);\n          this.setSelectedCoordinates(r);\n        }, y.onMidpoint = function (e, t) {\n          this.startDragging(e, t);\n          var n = t.featureTarget.properties;\n          e.feature.addCoordinate(n.coord_path, n.lng, n.lat), this.fireUpdate(), e.selectedCoordPaths = [n.coord_path];\n        }, y.pathsToCoordinates = function (e, t) {\n          return t.map(function (t) {\n            return {\n              feature_id: e,\n              coord_path: t\n            };\n          });\n        }, y.onFeature = function (e, t) {\n          0 === e.selectedCoordPaths.length ? this.startDragging(e, t) : this.stopDragging(e);\n        }, y.dragFeature = function (e, t, n) {\n          h(this.getSelected(), n), e.dragMoveLocation = t.lngLat;\n        }, y.dragVertex = function (e, t, n) {\n          for (var o = e.selectedCoordPaths.map(function (t) {\n            return e.feature.getCoordinate(t);\n          }), r = o.map(function (e) {\n            return {\n              type: p.geojsonTypes.FEATURE,\n              properties: {},\n              geometry: {\n                type: p.geojsonTypes.POINT,\n                coordinates: e\n              }\n            };\n          }), i = u(r, n), s = 0; s < o.length; s++) {\n            var a = o[s];\n            e.feature.updateCoordinate(e.selectedCoordPaths[s], a[0] + i.lng, a[1] + i.lat);\n          }\n        }, y.clickNoTarget = function () {\n          this.changeMode(p.modes.SIMPLE_SELECT);\n        }, y.clickInactive = function () {\n          this.changeMode(p.modes.SIMPLE_SELECT);\n        }, y.clickActiveFeature = function (e) {\n          e.selectedCoordPaths = [], this.clearSelectedCoordinates(), e.feature.changed();\n        }, y.onSetup = function (e) {\n          var t = e.featureId,\n              n = this.getFeature(t);\n          if (!n) throw new Error(\"You must provide a featureId to enter direct_select mode\");\n          if (n.type === p.geojsonTypes.POINT) throw new TypeError(\"direct_select mode doesn't handle point features\");\n          var o = {\n            featureId: t,\n            feature: n,\n            dragMoveLocation: e.startPos || null,\n            dragMoving: !1,\n            canDragMove: !1,\n            selectedCoordPaths: e.coordPath ? [e.coordPath] : []\n          };\n          return this.setSelectedCoordinates(this.pathsToCoordinates(t, o.selectedCoordPaths)), this.setSelected(t), l.disable(this), this.setActionableState({\n            trash: !0\n          }), o;\n        }, y.onStop = function () {\n          l.enable(this), this.clearSelectedCoordinates();\n        }, y.toDisplayFeatures = function (e, t, n) {\n          e.featureId === t.properties.id ? (t.properties.active = p.activeStates.ACTIVE, n(t), c(t, {\n            map: this.map,\n            midpoints: !0,\n            selectedPaths: e.selectedCoordPaths\n          }).forEach(n)) : (t.properties.active = p.activeStates.INACTIVE, n(t)), this.fireActionable(e);\n        }, y.onTrash = function (e) {\n          e.selectedCoordPaths.sort().reverse().forEach(function (t) {\n            return e.feature.removeCoordinate(t);\n          }), this.fireUpdate(), e.selectedCoordPaths = [], this.clearSelectedCoordinates(), this.fireActionable(e), !1 === e.feature.isValid() && (this.deleteFeature([e.featureId]), this.changeMode(p.modes.SIMPLE_SELECT, {}));\n        }, y.onMouseMove = function (e, t) {\n          var n = f.isActiveFeature(t),\n              o = d(t),\n              r = 0 === e.selectedCoordPaths.length;\n          n && r ? this.updateUIClasses({\n            mouse: p.cursors.MOVE\n          }) : o && !r ? this.updateUIClasses({\n            mouse: p.cursors.MOVE\n          }) : this.updateUIClasses({\n            mouse: p.cursors.NONE\n          }), this.stopDragging(e);\n        }, y.onMouseOut = function (e) {\n          e.dragMoving && this.fireUpdate();\n        }, y.onTouchStart = y.onMouseDown = function (e, t) {\n          return d(t) ? this.onVertex(e, t) : f.isActiveFeature(t) ? this.onFeature(e, t) : g(t) ? this.onMidpoint(e, t) : void 0;\n        }, y.onDrag = function (e, t) {\n          if (!0 === e.canDragMove) {\n            e.dragMoving = !0, t.originalEvent.stopPropagation();\n            var n = {\n              lng: t.lngLat.lng - e.dragMoveLocation.lng,\n              lat: t.lngLat.lat - e.dragMoveLocation.lat\n            };\n            e.selectedCoordPaths.length > 0 ? this.dragVertex(e, t, n) : this.dragFeature(e, t, n), e.dragMoveLocation = t.lngLat;\n          }\n        }, y.onClick = function (e, t) {\n          return r(t) ? this.clickNoTarget(e, t) : f.isActiveFeature(t) ? this.clickActiveFeature(e, t) : s(t) ? this.clickInactive(e, t) : void this.stopDragging(e);\n        }, y.onTap = function (e, t) {\n          return r(t) ? this.clickNoTarget(e, t) : f.isActiveFeature(t) ? this.clickActiveFeature(e, t) : s(t) ? this.clickInactive(e, t) : void 0;\n        }, y.onTouchEnd = y.onMouseUp = function (e) {\n          e.dragMoving && this.fireUpdate(), this.stopDragging(e);\n        }, t.exports = y;\n      }, {\n        \"../constants\": 23,\n        \"../lib/common_selectors\": 30,\n        \"../lib/constrain_feature_movement\": 31,\n        \"../lib/create_supplementary_points\": 33,\n        \"../lib/double_click_zoom\": 35,\n        \"../lib/move_features\": 45\n      }],\n      53: [function (e, t, n) {\n        function o(e) {\n          return s(e) || i(e) || r();\n        }\n\n        function r() {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n        }\n\n        function i(e) {\n          if (Symbol.iterator in Object(e) || \"[object Arguments]\" === Object.prototype.toString.call(e)) return Array.from(e);\n        }\n\n        function s(e) {\n          if (Array.isArray(e)) {\n            for (var t = 0, n = new Array(e.length); t < e.length; t++) n[t] = e[t];\n\n            return n;\n          }\n        }\n\n        var a = e(\"../lib/common_selectors\"),\n            c = e(\"../lib/is_event_at_coordinates\"),\n            u = e(\"../lib/double_click_zoom\"),\n            l = e(\"../constants\"),\n            p = e(\"../lib/create_vertex\"),\n            f = {};\n        f.onSetup = function (e) {\n          var t,\n              n,\n              r = (e = e || {}).featureId,\n              i = \"forward\";\n\n          if (r) {\n            if (!(t = this.getFeature(r))) throw new Error(\"Could not find a feature with the provided featureId\");\n            var s = e.from;\n            if (s && \"Feature\" === s.type && s.geometry && \"Point\" === s.geometry.type && (s = s.geometry), s && \"Point\" === s.type && s.coordinates && 2 === s.coordinates.length && (s = s.coordinates), !s || !Array.isArray(s)) throw new Error(\"Please use the `from` property to indicate which point to continue the line from\");\n            var a = t.coordinates.length - 1;\n\n            if (t.coordinates[a][0] === s[0] && t.coordinates[a][1] === s[1]) {\n              var c;\n              n = a + 1, (c = t).addCoordinate.apply(c, [n].concat(o(t.coordinates[a])));\n            } else {\n              if (t.coordinates[0][0] !== s[0] || t.coordinates[0][1] !== s[1]) throw new Error(\"`from` should match the point at either the start or the end of the provided LineString\");\n              var p;\n              i = \"backwards\", n = 0, (p = t).addCoordinate.apply(p, [n].concat(o(t.coordinates[0])));\n            }\n          } else t = this.newFeature({\n            type: l.geojsonTypes.FEATURE,\n            properties: {},\n            geometry: {\n              type: l.geojsonTypes.LINE_STRING,\n              coordinates: []\n            }\n          }), n = 0, this.addFeature(t);\n\n          return this.clearSelectedFeatures(), u.disable(this), this.updateUIClasses({\n            mouse: l.cursors.ADD\n          }), this.activateUIButton(l.types.LINE), this.setActionableState({\n            trash: !0\n          }), {\n            line: t,\n            currentVertexPosition: n,\n            direction: i\n          };\n        }, f.clickAnywhere = function (e, t) {\n          if (e.currentVertexPosition > 0 && c(t, e.line.coordinates[e.currentVertexPosition - 1]) || \"backwards\" === e.direction && c(t, e.line.coordinates[e.currentVertexPosition + 1])) return this.changeMode(l.modes.SIMPLE_SELECT, {\n            featureIds: [e.line.id]\n          });\n          this.updateUIClasses({\n            mouse: l.cursors.ADD\n          }), e.line.updateCoordinate(e.currentVertexPosition, t.lngLat.lng, t.lngLat.lat), \"forward\" === e.direction ? (e.currentVertexPosition++, e.line.updateCoordinate(e.currentVertexPosition, t.lngLat.lng, t.lngLat.lat)) : e.line.addCoordinate(0, t.lngLat.lng, t.lngLat.lat);\n        }, f.clickOnVertex = function (e) {\n          return this.changeMode(l.modes.SIMPLE_SELECT, {\n            featureIds: [e.line.id]\n          });\n        }, f.onMouseMove = function (e, t) {\n          e.line.updateCoordinate(e.currentVertexPosition, t.lngLat.lng, t.lngLat.lat), a.isVertex(t) && this.updateUIClasses({\n            mouse: l.cursors.POINTER\n          });\n        }, f.onTap = f.onClick = function (e, t) {\n          if (a.isVertex(t)) return this.clickOnVertex(e, t);\n          this.clickAnywhere(e, t);\n        }, f.onKeyUp = function (e, t) {\n          a.isEnterKey(t) ? this.changeMode(l.modes.SIMPLE_SELECT, {\n            featureIds: [e.line.id]\n          }) : a.isEscapeKey(t) && (this.deleteFeature([e.line.id], {\n            silent: !0\n          }), this.changeMode(l.modes.SIMPLE_SELECT));\n        }, f.onStop = function (e) {\n          u.enable(this), this.activateUIButton(), void 0 !== this.getFeature(e.line.id) && (e.line.removeCoordinate(\"\".concat(e.currentVertexPosition)), e.line.isValid() ? this.map.fire(l.events.CREATE, {\n            features: [e.line.toGeoJSON()]\n          }) : (this.deleteFeature([e.line.id], {\n            silent: !0\n          }), this.changeMode(l.modes.SIMPLE_SELECT, {}, {\n            silent: !0\n          })));\n        }, f.onTrash = function (e) {\n          this.deleteFeature([e.line.id], {\n            silent: !0\n          }), this.changeMode(l.modes.SIMPLE_SELECT);\n        }, f.toDisplayFeatures = function (e, t, n) {\n          var o = t.properties.id === e.line.id;\n          if (t.properties.active = o ? l.activeStates.ACTIVE : l.activeStates.INACTIVE, !o) return n(t);\n          t.geometry.coordinates.length < 2 || (t.properties.meta = l.meta.FEATURE, n(p(e.line.id, t.geometry.coordinates[\"forward\" === e.direction ? t.geometry.coordinates.length - 2 : 1], \"\".concat(\"forward\" === e.direction ? t.geometry.coordinates.length - 2 : 1), !1)), n(t));\n        }, t.exports = f;\n      }, {\n        \"../constants\": 23,\n        \"../lib/common_selectors\": 30,\n        \"../lib/create_vertex\": 34,\n        \"../lib/double_click_zoom\": 35,\n        \"../lib/is_event_at_coordinates\": 40\n      }],\n      54: [function (e, t, n) {\n        var o = e(\"../lib/common_selectors\"),\n            r = e(\"../constants\"),\n            i = {};\n        i.onSetup = function () {\n          var e = this.newFeature({\n            type: r.geojsonTypes.FEATURE,\n            properties: {},\n            geometry: {\n              type: r.geojsonTypes.POINT,\n              coordinates: []\n            }\n          });\n          return this.addFeature(e), this.clearSelectedFeatures(), this.updateUIClasses({\n            mouse: r.cursors.ADD\n          }), this.activateUIButton(r.types.POINT), this.setActionableState({\n            trash: !0\n          }), {\n            point: e\n          };\n        }, i.stopDrawingAndRemove = function (e) {\n          this.deleteFeature([e.point.id], {\n            silent: !0\n          }), this.changeMode(r.modes.SIMPLE_SELECT);\n        }, i.onTap = i.onClick = function (e, t) {\n          this.updateUIClasses({\n            mouse: r.cursors.MOVE\n          }), e.point.updateCoordinate(\"\", t.lngLat.lng, t.lngLat.lat), this.map.fire(r.events.CREATE, {\n            features: [e.point.toGeoJSON()]\n          }), this.changeMode(r.modes.SIMPLE_SELECT, {\n            featureIds: [e.point.id]\n          });\n        }, i.onStop = function (e) {\n          this.activateUIButton(), e.point.getCoordinate().length || this.deleteFeature([e.point.id], {\n            silent: !0\n          });\n        }, i.toDisplayFeatures = function (e, t, n) {\n          var o = t.properties.id === e.point.id;\n          if (t.properties.active = o ? r.activeStates.ACTIVE : r.activeStates.INACTIVE, !o) return n(t);\n        }, i.onTrash = i.stopDrawingAndRemove, i.onKeyUp = function (e, t) {\n          if (o.isEscapeKey(t) || o.isEnterKey(t)) return this.stopDrawingAndRemove(e, t);\n        }, t.exports = i;\n      }, {\n        \"../constants\": 23,\n        \"../lib/common_selectors\": 30\n      }],\n      55: [function (e, t, n) {\n        var o = e(\"../lib/common_selectors\"),\n            r = e(\"../lib/double_click_zoom\"),\n            i = e(\"../constants\"),\n            s = e(\"../lib/is_event_at_coordinates\"),\n            a = e(\"../lib/create_vertex\"),\n            c = {};\n        c.onSetup = function () {\n          var e = this.newFeature({\n            type: i.geojsonTypes.FEATURE,\n            properties: {},\n            geometry: {\n              type: i.geojsonTypes.POLYGON,\n              coordinates: [[]]\n            }\n          });\n          return this.addFeature(e), this.clearSelectedFeatures(), r.disable(this), this.updateUIClasses({\n            mouse: i.cursors.ADD\n          }), this.activateUIButton(i.types.POLYGON), this.setActionableState({\n            trash: !0\n          }), {\n            polygon: e,\n            currentVertexPosition: 0\n          };\n        }, c.clickAnywhere = function (e, t) {\n          if (e.currentVertexPosition > 0 && s(t, e.polygon.coordinates[0][e.currentVertexPosition - 1])) return this.changeMode(i.modes.SIMPLE_SELECT, {\n            featureIds: [e.polygon.id]\n          });\n          this.updateUIClasses({\n            mouse: i.cursors.ADD\n          }), e.polygon.updateCoordinate(\"0.\".concat(e.currentVertexPosition), t.lngLat.lng, t.lngLat.lat), e.currentVertexPosition++, e.polygon.updateCoordinate(\"0.\".concat(e.currentVertexPosition), t.lngLat.lng, t.lngLat.lat);\n        }, c.clickOnVertex = function (e) {\n          return this.changeMode(i.modes.SIMPLE_SELECT, {\n            featureIds: [e.polygon.id]\n          });\n        }, c.onMouseMove = function (e, t) {\n          e.polygon.updateCoordinate(\"0.\".concat(e.currentVertexPosition), t.lngLat.lng, t.lngLat.lat), o.isVertex(t) && this.updateUIClasses({\n            mouse: i.cursors.POINTER\n          });\n        }, c.onTap = c.onClick = function (e, t) {\n          return o.isVertex(t) ? this.clickOnVertex(e, t) : this.clickAnywhere(e, t);\n        }, c.onKeyUp = function (e, t) {\n          o.isEscapeKey(t) ? (this.deleteFeature([e.polygon.id], {\n            silent: !0\n          }), this.changeMode(i.modes.SIMPLE_SELECT)) : o.isEnterKey(t) && this.changeMode(i.modes.SIMPLE_SELECT, {\n            featureIds: [e.polygon.id]\n          });\n        }, c.onStop = function (e) {\n          this.updateUIClasses({\n            mouse: i.cursors.NONE\n          }), r.enable(this), this.activateUIButton(), void 0 !== this.getFeature(e.polygon.id) && (e.polygon.removeCoordinate(\"0.\".concat(e.currentVertexPosition)), e.polygon.isValid() ? this.map.fire(i.events.CREATE, {\n            features: [e.polygon.toGeoJSON()]\n          }) : (this.deleteFeature([e.polygon.id], {\n            silent: !0\n          }), this.changeMode(i.modes.SIMPLE_SELECT, {}, {\n            silent: !0\n          })));\n        }, c.toDisplayFeatures = function (e, t, n) {\n          var o = t.properties.id === e.polygon.id;\n          if (t.properties.active = o ? i.activeStates.ACTIVE : i.activeStates.INACTIVE, !o) return n(t);\n\n          if (0 !== t.geometry.coordinates.length) {\n            var r = t.geometry.coordinates[0].length;\n\n            if (!(r < 3)) {\n              if (t.properties.meta = i.meta.FEATURE, n(a(e.polygon.id, t.geometry.coordinates[0][0], \"0.0\", !1)), r > 3) {\n                var s = t.geometry.coordinates[0].length - 3;\n                n(a(e.polygon.id, t.geometry.coordinates[0][s], \"0.\".concat(s), !1));\n              }\n\n              if (r <= 4) {\n                var c = [[t.geometry.coordinates[0][0][0], t.geometry.coordinates[0][0][1]], [t.geometry.coordinates[0][1][0], t.geometry.coordinates[0][1][1]]];\n                if (n({\n                  type: i.geojsonTypes.FEATURE,\n                  properties: t.properties,\n                  geometry: {\n                    coordinates: c,\n                    type: i.geojsonTypes.LINE_STRING\n                  }\n                }), 3 === r) return;\n              }\n\n              return n(t);\n            }\n          }\n        }, c.onTrash = function (e) {\n          this.deleteFeature([e.polygon.id], {\n            silent: !0\n          }), this.changeMode(i.modes.SIMPLE_SELECT);\n        }, t.exports = c;\n      }, {\n        \"../constants\": 23,\n        \"../lib/common_selectors\": 30,\n        \"../lib/create_vertex\": 34,\n        \"../lib/double_click_zoom\": 35,\n        \"../lib/is_event_at_coordinates\": 40\n      }],\n      56: [function (e, t, n) {\n        t.exports = {\n          simple_select: e(\"./simple_select\"),\n          direct_select: e(\"./direct_select\"),\n          draw_point: e(\"./draw_point\"),\n          draw_polygon: e(\"./draw_polygon\"),\n          draw_line_string: e(\"./draw_line_string\")\n        };\n      }, {\n        \"./direct_select\": 52,\n        \"./draw_line_string\": 53,\n        \"./draw_point\": 54,\n        \"./draw_polygon\": 55,\n        \"./simple_select\": 60\n      }],\n      57: [function (e, t, n) {\n        var o = t.exports = e(\"./mode_interface_accessors\");\n        o.prototype.onSetup = function () {}, o.prototype.onDrag = function () {}, o.prototype.onClick = function () {}, o.prototype.onMouseMove = function () {}, o.prototype.onMouseDown = function () {}, o.prototype.onMouseUp = function () {}, o.prototype.onMouseOut = function () {}, o.prototype.onKeyUp = function () {}, o.prototype.onKeyDown = function () {}, o.prototype.onTouchStart = function () {}, o.prototype.onTouchMove = function () {}, o.prototype.onTouchEnd = function () {}, o.prototype.onTap = function () {}, o.prototype.onStop = function () {}, o.prototype.onTrash = function () {}, o.prototype.onCombineFeature = function () {}, o.prototype.onUncombineFeature = function () {}, o.prototype.toDisplayFeatures = function () {\n          throw new Error(\"You must overwrite toDisplayFeatures\");\n        };\n      }, {\n        \"./mode_interface_accessors\": 58\n      }],\n      58: [function (e, t, n) {\n        var o = e(\"../constants\"),\n            r = e(\"../lib/features_at\"),\n            i = e(\"../feature_types/point\"),\n            s = e(\"../feature_types/line_string\"),\n            a = e(\"../feature_types/polygon\"),\n            c = e(\"../feature_types/multi_feature\"),\n            u = t.exports = function (e) {\n          this.map = e.map, this.drawConfig = JSON.parse(JSON.stringify(e.options || {})), this._ctx = e;\n        };\n\n        u.prototype.setSelected = function (e) {\n          return this._ctx.store.setSelected(e);\n        }, u.prototype.setSelectedCoordinates = function (e) {\n          var t = this;\n          this._ctx.store.setSelectedCoordinates(e), e.reduce(function (e, n) {\n            return void 0 === e[n.feature_id] && (e[n.feature_id] = !0, t._ctx.store.get(n.feature_id).changed()), e;\n          }, {});\n        }, u.prototype.getSelected = function () {\n          return this._ctx.store.getSelected();\n        }, u.prototype.getSelectedIds = function () {\n          return this._ctx.store.getSelectedIds();\n        }, u.prototype.isSelected = function (e) {\n          return this._ctx.store.isSelected(e);\n        }, u.prototype.getFeature = function (e) {\n          return this._ctx.store.get(e);\n        }, u.prototype.select = function (e) {\n          return this._ctx.store.select(e);\n        }, u.prototype.deselect = function (e) {\n          return this._ctx.store.deselect(e);\n        }, u.prototype.deleteFeature = function (e) {\n          var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n          return this._ctx.store.delete(e, t);\n        }, u.prototype.addFeature = function (e) {\n          return this._ctx.store.add(e);\n        }, u.prototype.clearSelectedFeatures = function () {\n          return this._ctx.store.clearSelected();\n        }, u.prototype.clearSelectedCoordinates = function () {\n          return this._ctx.store.clearSelectedCoordinates();\n        }, u.prototype.setActionableState = function () {\n          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n              t = {\n            trash: e.trash || !1,\n            combineFeatures: e.combineFeatures || !1,\n            uncombineFeatures: e.uncombineFeatures || !1\n          };\n          return this._ctx.events.actionable(t);\n        }, u.prototype.changeMode = function (e) {\n          var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n              n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n          return this._ctx.events.changeMode(e, t, n);\n        }, u.prototype.updateUIClasses = function (e) {\n          return this._ctx.ui.queueMapClasses(e);\n        }, u.prototype.activateUIButton = function (e) {\n          return this._ctx.ui.setActiveButton(e);\n        }, u.prototype.featuresAt = function (e, t) {\n          var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : \"click\";\n          if (\"click\" !== n && \"touch\" !== n) throw new Error(\"invalid buffer type\");\n          return r[n](e, t, this._ctx);\n        }, u.prototype.newFeature = function (e) {\n          var t = e.geometry.type;\n          return t === o.geojsonTypes.POINT ? new i(this._ctx, e) : t === o.geojsonTypes.LINE_STRING ? new s(this._ctx, e) : t === o.geojsonTypes.POLYGON ? new a(this._ctx, e) : new c(this._ctx, e);\n        }, u.prototype.isInstanceOf = function (e, t) {\n          if (e === o.geojsonTypes.POINT) return t instanceof i;\n          if (e === o.geojsonTypes.LINE_STRING) return t instanceof s;\n          if (e === o.geojsonTypes.POLYGON) return t instanceof a;\n          if (\"MultiFeature\" === e) return t instanceof c;\n          throw new Error(\"Unknown feature class: \".concat(e));\n        }, u.prototype.doRender = function (e) {\n          return this._ctx.store.featureChanged(e);\n        };\n      }, {\n        \"../constants\": 23,\n        \"../feature_types/line_string\": 26,\n        \"../feature_types/multi_feature\": 27,\n        \"../feature_types/point\": 28,\n        \"../feature_types/polygon\": 29,\n        \"../lib/features_at\": 37\n      }],\n      59: [function (e, t, n) {\n        var o = e(\"./mode_interface\"),\n            r = {\n          drag: \"onDrag\",\n          click: \"onClick\",\n          mousemove: \"onMouseMove\",\n          mousedown: \"onMouseDown\",\n          mouseup: \"onMouseUp\",\n          mouseout: \"onMouseOut\",\n          keyup: \"onKeyUp\",\n          keydown: \"onKeyDown\",\n          touchstart: \"onTouchStart\",\n          touchmove: \"onTouchMove\",\n          touchend: \"onTouchEnd\",\n          tap: \"onTap\"\n        },\n            i = Object.keys(r);\n\n        t.exports = function (e) {\n          var t = Object.keys(e);\n          return function (n) {\n            function s(e) {\n              return function (t) {\n                u[e](c, t);\n              };\n            }\n\n            var a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n                c = {},\n                u = t.reduce(function (t, n) {\n              return t[n] = e[n], t;\n            }, new o(n));\n            return {\n              start: function () {\n                var t = this;\n                c = u.onSetup(a), i.forEach(function (n) {\n                  var o = r[n],\n                      i = function () {\n                    return !1;\n                  };\n\n                  e[o] && (i = function () {\n                    return !0;\n                  }), t.on(n, i, s(o));\n                });\n              },\n              stop: function () {\n                u.onStop(c);\n              },\n              trash: function () {\n                u.onTrash(c);\n              },\n              combineFeatures: function () {\n                u.onCombineFeatures(c);\n              },\n              uncombineFeatures: function () {\n                u.onUncombineFeatures(c);\n              },\n              render: function (e, t) {\n                u.toDisplayFeatures(c, e, t);\n              }\n            };\n          };\n        };\n      }, {\n        \"./mode_interface\": 57\n      }],\n      60: [function (e, t, n) {\n        var o = e(\"../lib/common_selectors\"),\n            r = e(\"../lib/mouse_event_point\"),\n            i = e(\"../lib/create_supplementary_points\"),\n            s = e(\"../lib/string_set\"),\n            a = e(\"../lib/double_click_zoom\"),\n            c = e(\"../lib/move_features\"),\n            u = e(\"../constants\"),\n            l = {};\n        l.onSetup = function (e) {\n          var t = this,\n              n = {\n            dragMoveLocation: null,\n            boxSelectStartLocation: null,\n            boxSelectElement: void 0,\n            boxSelecting: !1,\n            canBoxSelect: !1,\n            dragMoveing: !1,\n            canDragMove: !1,\n            initiallySelectedFeatureIds: e.featureIds || []\n          };\n          return this.setSelected(n.initiallySelectedFeatureIds.filter(function (e) {\n            return void 0 !== t.getFeature(e);\n          })), this.fireActionable(), this.setActionableState({\n            combineFeatures: !0,\n            uncombineFeatures: !0,\n            trash: !0\n          }), n;\n        }, l.fireUpdate = function () {\n          this.map.fire(u.events.UPDATE, {\n            action: u.updateActions.MOVE,\n            features: this.getSelected().map(function (e) {\n              return e.toGeoJSON();\n            })\n          });\n        }, l.fireActionable = function () {\n          var e = this,\n              t = this.getSelected(),\n              n = t.filter(function (t) {\n            return e.isInstanceOf(\"MultiFeature\", t);\n          }),\n              o = !1;\n\n          if (t.length > 1) {\n            o = !0;\n            var r = t[0].type.replace(\"Multi\", \"\");\n            t.forEach(function (e) {\n              e.type.replace(\"Multi\", \"\") !== r && (o = !1);\n            });\n          }\n\n          var i = n.length > 0,\n              s = t.length > 0;\n          this.setActionableState({\n            combineFeatures: o,\n            uncombineFeatures: i,\n            trash: s\n          });\n        }, l.getUniqueIds = function (e) {\n          return e.length ? e.map(function (e) {\n            return e.properties.id;\n          }).filter(function (e) {\n            return void 0 !== e;\n          }).reduce(function (e, t) {\n            return e.add(t), e;\n          }, new s()).values() : [];\n        }, l.stopExtendedInteractions = function (e) {\n          e.boxSelectElement && (e.boxSelectElement.parentNode && e.boxSelectElement.parentNode.removeChild(e.boxSelectElement), e.boxSelectElement = null), this.map.dragPan.enable(), e.boxSelecting = !1, e.canBoxSelect = !1, e.dragMoving = !1, e.canDragMove = !1;\n        }, l.onStop = function () {\n          a.enable(this);\n        }, l.onMouseMove = function (e) {\n          return this.stopExtendedInteractions(e);\n        }, l.onMouseOut = function (e) {\n          if (e.dragMoving) return this.fireUpdate();\n        }, l.onTap = l.onClick = function (e, t) {\n          return o.noTarget(t) ? this.clickAnywhere(e, t) : o.isOfMetaType(u.meta.VERTEX)(t) ? this.clickOnVertex(e, t) : o.isFeature(t) ? this.clickOnFeature(e, t) : void 0;\n        }, l.clickAnywhere = function (e) {\n          var t = this,\n              n = this.getSelectedIds();\n          n.length && (this.clearSelectedFeatures(), n.forEach(function (e) {\n            return t.doRender(e);\n          })), a.enable(this), this.stopExtendedInteractions(e);\n        }, l.clickOnVertex = function (e, t) {\n          this.changeMode(u.modes.DIRECT_SELECT, {\n            featureId: t.featureTarget.properties.parent,\n            coordPath: t.featureTarget.properties.coord_path,\n            startPos: t.lngLat\n          }), this.updateUIClasses({\n            mouse: u.cursors.MOVE\n          });\n        }, l.startOnActiveFeature = function (e, t) {\n          this.stopExtendedInteractions(e), this.map.dragPan.disable(), this.doRender(t.featureTarget.properties.id), e.canDragMove = !0, e.dragMoveLocation = t.lngLat;\n        }, l.clickOnFeature = function (e, t) {\n          var n = this;\n          a.disable(this), this.stopExtendedInteractions(e);\n          var r = o.isShiftDown(t),\n              i = this.getSelectedIds(),\n              s = t.featureTarget.properties.id,\n              c = this.isSelected(s);\n          if (!r && c && this.getFeature(s).type !== u.geojsonTypes.POINT) return this.changeMode(u.modes.DIRECT_SELECT, {\n            featureId: s\n          });\n          c && r ? (this.deselect(s), this.updateUIClasses({\n            mouse: u.cursors.POINTER\n          }), 1 === i.length && a.enable(this)) : !c && r ? (this.select(s), this.updateUIClasses({\n            mouse: u.cursors.MOVE\n          })) : c || r || (i.forEach(function (e) {\n            return n.doRender(e);\n          }), this.setSelected(s), this.updateUIClasses({\n            mouse: u.cursors.MOVE\n          })), this.doRender(s);\n        }, l.onMouseDown = function (e, t) {\n          return o.isActiveFeature(t) ? this.startOnActiveFeature(e, t) : this.drawConfig.boxSelect && o.isShiftMousedown(t) ? this.startBoxSelect(e, t) : void 0;\n        }, l.startBoxSelect = function (e, t) {\n          this.stopExtendedInteractions(e), this.map.dragPan.disable(), e.boxSelectStartLocation = r(t.originalEvent, this.map.getContainer()), e.canBoxSelect = !0;\n        }, l.onTouchStart = function (e, t) {\n          if (o.isActiveFeature(t)) return this.startOnActiveFeature(e, t);\n        }, l.onDrag = function (e, t) {\n          return e.canDragMove ? this.dragMove(e, t) : this.drawConfig.boxSelect && e.canBoxSelect ? this.whileBoxSelect(e, t) : void 0;\n        }, l.whileBoxSelect = function (e, t) {\n          e.boxSelecting = !0, this.updateUIClasses({\n            mouse: u.cursors.ADD\n          }), e.boxSelectElement || (e.boxSelectElement = document.createElement(\"div\"), e.boxSelectElement.classList.add(u.classes.BOX_SELECT), this.map.getContainer().appendChild(e.boxSelectElement));\n          var n = r(t.originalEvent, this.map.getContainer()),\n              o = Math.min(e.boxSelectStartLocation.x, n.x),\n              i = Math.max(e.boxSelectStartLocation.x, n.x),\n              s = Math.min(e.boxSelectStartLocation.y, n.y),\n              a = Math.max(e.boxSelectStartLocation.y, n.y),\n              c = \"translate(\".concat(o, \"px, \").concat(s, \"px)\");\n          e.boxSelectElement.style.transform = c, e.boxSelectElement.style.WebkitTransform = c, e.boxSelectElement.style.width = \"\".concat(i - o, \"px\"), e.boxSelectElement.style.height = \"\".concat(a - s, \"px\");\n        }, l.dragMove = function (e, t) {\n          e.dragMoving = !0, t.originalEvent.stopPropagation();\n          var n = {\n            lng: t.lngLat.lng - e.dragMoveLocation.lng,\n            lat: t.lngLat.lat - e.dragMoveLocation.lat\n          };\n          c(this.getSelected(), n), e.dragMoveLocation = t.lngLat;\n        }, l.onMouseUp = function (e, t) {\n          var n = this;\n          if (e.dragMoving) this.fireUpdate();else if (e.boxSelecting) {\n            var o = [e.boxSelectStartLocation, r(t.originalEvent, this.map.getContainer())],\n                i = this.featuresAt(null, o, \"click\"),\n                s = this.getUniqueIds(i).filter(function (e) {\n              return !n.isSelected(e);\n            });\n            s.length && (this.select(s), s.forEach(function (e) {\n              return n.doRender(e);\n            }), this.updateUIClasses({\n              mouse: u.cursors.MOVE\n            }));\n          }\n          this.stopExtendedInteractions(e);\n        }, l.toDisplayFeatures = function (e, t, n) {\n          t.properties.active = this.isSelected(t.properties.id) ? u.activeStates.ACTIVE : u.activeStates.INACTIVE, n(t), this.fireActionable(), t.properties.active === u.activeStates.ACTIVE && t.geometry.type !== u.geojsonTypes.POINT && i(t).forEach(n);\n        }, l.onTrash = function () {\n          this.deleteFeature(this.getSelectedIds()), this.fireActionable();\n        }, l.onCombineFeatures = function () {\n          var e = this.getSelected();\n\n          if (!(0 === e.length || e.length < 2)) {\n            for (var t = [], n = [], o = e[0].type.replace(\"Multi\", \"\"), r = 0; r < e.length; r++) {\n              var i = e[r];\n              if (i.type.replace(\"Multi\", \"\") !== o) return;\n              i.type.includes(\"Multi\") ? i.getCoordinates().forEach(function (e) {\n                t.push(e);\n              }) : t.push(i.getCoordinates()), n.push(i.toGeoJSON());\n            }\n\n            if (n.length > 1) {\n              var s = this.newFeature({\n                type: u.geojsonTypes.FEATURE,\n                properties: n[0].properties,\n                geometry: {\n                  type: \"Multi\".concat(o),\n                  coordinates: t\n                }\n              });\n              this.addFeature(s), this.deleteFeature(this.getSelectedIds(), {\n                silent: !0\n              }), this.setSelected([s.id]), this.map.fire(u.events.COMBINE_FEATURES, {\n                createdFeatures: [s.toGeoJSON()],\n                deletedFeatures: n\n              });\n            }\n\n            this.fireActionable();\n          }\n        }, l.onUncombineFeatures = function () {\n          var e = this,\n              t = this.getSelected();\n\n          if (0 !== t.length) {\n            for (var n = [], o = [], r = 0; r < t.length; r++) !function (r) {\n              var i = t[r];\n              e.isInstanceOf(\"MultiFeature\", i) && (i.getFeatures().forEach(function (t) {\n                e.addFeature(t), t.properties = i.properties, n.push(t.toGeoJSON()), e.select([t.id]);\n              }), e.deleteFeature(i.id, {\n                silent: !0\n              }), o.push(i.toGeoJSON()));\n            }(r);\n\n            n.length > 1 && this.map.fire(u.events.UNCOMBINE_FEATURES, {\n              createdFeatures: n,\n              deletedFeatures: o\n            }), this.fireActionable();\n          }\n        }, t.exports = l;\n      }, {\n        \"../constants\": 23,\n        \"../lib/common_selectors\": 30,\n        \"../lib/create_supplementary_points\": 33,\n        \"../lib/double_click_zoom\": 35,\n        \"../lib/mouse_event_point\": 44,\n        \"../lib/move_features\": 45,\n        \"../lib/string_set\": 47\n      }],\n      61: [function (e, t, n) {\n        function o(e, t) {\n          return e.map(function (e) {\n            return e.source ? e : r(e, {\n              id: \"\".concat(e.id, \".\").concat(t),\n              source: \"hot\" === t ? i.sources.HOT : i.sources.COLD\n            });\n          });\n        }\n\n        var r = e(\"xtend\"),\n            i = e(\"./constants\"),\n            s = {\n          defaultMode: i.modes.SIMPLE_SELECT,\n          keybindings: !0,\n          touchEnabled: !0,\n          clickBuffer: 2,\n          touchBuffer: 25,\n          boxSelect: !0,\n          displayControlsDefault: !0,\n          styles: e(\"./lib/theme\"),\n          modes: e(\"./modes\"),\n          controls: {},\n          userProperties: !1\n        },\n            a = {\n          point: !0,\n          line_string: !0,\n          polygon: !0,\n          trash: !0,\n          combine_features: !0,\n          uncombine_features: !0\n        },\n            c = {\n          point: !1,\n          line_string: !1,\n          polygon: !1,\n          trash: !1,\n          combine_features: !1,\n          uncombine_features: !1\n        };\n\n        t.exports = function () {\n          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n              t = r(e);\n          return e.controls || (t.controls = {}), !1 === e.displayControlsDefault ? t.controls = r(c, e.controls) : t.controls = r(a, e.controls), t = r(s, t), t.styles = o(t.styles, \"cold\").concat(o(t.styles, \"hot\")), t;\n        };\n      }, {\n        \"./constants\": 23,\n        \"./lib/theme\": 49,\n        \"./modes\": 56,\n        xtend: 21\n      }],\n      62: [function (e, t, n) {\n        var o = e(\"./constants\");\n\n        t.exports = function () {\n          function e(e, t) {\n            var o = n.get(e).internal(r);\n            n.ctx.events.currentModeRender(o, function (e) {\n              n.sources[t].push(e);\n            });\n          }\n\n          function t() {\n            n.isDirty = !1, n.clearChangedIds();\n          }\n\n          var n = this;\n          if (!(n.ctx.map && void 0 !== n.ctx.map.getSource(o.sources.HOT))) return t();\n          var r = n.ctx.events.currentModeName();\n          n.ctx.ui.queueMapClasses({\n            mode: r\n          });\n          var i = [],\n              s = [];\n          n.isDirty ? s = n.getAllIds() : (i = n.getChangedIds().filter(function (e) {\n            return void 0 !== n.get(e);\n          }), s = n.sources.hot.filter(function (e) {\n            return e.properties.id && -1 === i.indexOf(e.properties.id) && void 0 !== n.get(e.properties.id);\n          }).map(function (e) {\n            return e.properties.id;\n          })), n.sources.hot = [];\n          var a = n.sources.cold.length;\n          n.sources.cold = n.isDirty ? [] : n.sources.cold.filter(function (e) {\n            var t = e.properties.id || e.properties.parent;\n            return -1 === i.indexOf(t);\n          });\n          var c = a !== n.sources.cold.length || s.length > 0;\n\n          if (i.forEach(function (t) {\n            return e(t, \"hot\");\n          }), s.forEach(function (t) {\n            return e(t, \"cold\");\n          }), c && n.ctx.map.getSource(o.sources.COLD).setData({\n            type: o.geojsonTypes.FEATURE_COLLECTION,\n            features: n.sources.cold\n          }), n.ctx.map.getSource(o.sources.HOT).setData({\n            type: o.geojsonTypes.FEATURE_COLLECTION,\n            features: n.sources.hot\n          }), n._emitSelectionChange && (n.ctx.map.fire(o.events.SELECTION_CHANGE, {\n            features: n.getSelected().map(function (e) {\n              return e.toGeoJSON();\n            }),\n            points: n.getSelectedCoordinates().map(function (e) {\n              return {\n                type: o.geojsonTypes.FEATURE,\n                properties: {},\n                geometry: {\n                  type: o.geojsonTypes.POINT,\n                  coordinates: e.coordinates\n                }\n              };\n            })\n          }), n._emitSelectionChange = !1), n._deletedFeaturesToEmit.length) {\n            var u = n._deletedFeaturesToEmit.map(function (e) {\n              return e.toGeoJSON();\n            });\n\n            n._deletedFeaturesToEmit = [], n.ctx.map.fire(o.events.DELETE, {\n              features: u\n            });\n          }\n\n          t(), n.ctx.map.fire(o.events.RENDER, {});\n        };\n      }, {\n        \"./constants\": 23\n      }],\n      63: [function (e, t, n) {\n        var o = e(\"./events\"),\n            r = e(\"./store\"),\n            i = e(\"./ui\"),\n            s = e(\"./constants\"),\n            a = e(\"xtend\");\n\n        t.exports = function (e) {\n          var t = null,\n              n = null,\n              c = {\n            onRemove: function () {\n              return e.map.off(\"load\", c.connect), clearInterval(n), c.removeLayers(), e.store.restoreMapConfig(), e.ui.removeButtons(), e.events.removeEventListeners(), e.ui.clearMapClasses(), e.map = null, e.container = null, e.store = null, t && t.parentNode && t.parentNode.removeChild(t), t = null, this;\n            },\n            connect: function () {\n              e.map.off(\"load\", c.connect), clearInterval(n), c.addLayers(), e.store.storeMapConfig(), e.events.addEventListeners();\n            },\n            onAdd: function (s) {\n              var u = s.fire;\n              return s.fire = function (e, t) {\n                var n = arguments;\n                return 1 === u.length && 1 !== arguments.length && (n = [a({}, {\n                  type: e\n                }, t)]), u.apply(s, n);\n              }, e.map = s, e.events = o(e), e.ui = i(e), e.container = s.getContainer(), e.store = new r(e), t = e.ui.addButtons(), e.options.boxSelect && (s.boxZoom.disable(), s.dragPan.disable(), s.dragPan.enable()), s.loaded() ? c.connect() : (s.on(\"load\", c.connect), n = setInterval(function () {\n                s.loaded() && c.connect();\n              }, 16)), e.events.start(), t;\n            },\n            addLayers: function () {\n              e.map.addSource(s.sources.COLD, {\n                data: {\n                  type: s.geojsonTypes.FEATURE_COLLECTION,\n                  features: []\n                },\n                type: \"geojson\"\n              }), e.map.addSource(s.sources.HOT, {\n                data: {\n                  type: s.geojsonTypes.FEATURE_COLLECTION,\n                  features: []\n                },\n                type: \"geojson\"\n              }), e.options.styles.forEach(function (t) {\n                e.map.addLayer(t);\n              }), e.store.setDirty(!0), e.store.render();\n            },\n            removeLayers: function () {\n              e.options.styles.forEach(function (t) {\n                e.map.getLayer(t.id) && e.map.removeLayer(t.id);\n              }), e.map.getSource(s.sources.COLD) && e.map.removeSource(s.sources.COLD), e.map.getSource(s.sources.HOT) && e.map.removeSource(s.sources.HOT);\n            }\n          };\n          return e.setup = c, c;\n        };\n      }, {\n        \"./constants\": 23,\n        \"./events\": 24,\n        \"./store\": 64,\n        \"./ui\": 65,\n        xtend: 21\n      }],\n      64: [function (e, t, n) {\n        function o(e) {\n          var t = this,\n              n = this._selectedCoordinates.filter(function (e) {\n            return t._selectedFeatureIds.has(e.feature_id);\n          });\n\n          this._selectedCoordinates.length === n.length || e.silent || (this._emitSelectionChange = !0), this._selectedCoordinates = n;\n        }\n\n        var r = e(\"./lib/throttle\"),\n            i = e(\"./lib/to_dense_array\"),\n            s = e(\"./lib/string_set\"),\n            a = e(\"./render\"),\n            c = e(\"./constants\").interactions,\n            u = t.exports = function (e) {\n          this._features = {}, this._featureIds = new s(), this._selectedFeatureIds = new s(), this._selectedCoordinates = [], this._changedFeatureIds = new s(), this._deletedFeaturesToEmit = [], this._emitSelectionChange = !1, this._mapInitialConfig = {}, this.ctx = e, this.sources = {\n            hot: [],\n            cold: []\n          }, this.render = r(a, 16, this), this.isDirty = !1;\n        };\n\n        u.prototype.createRenderBatch = function () {\n          var e = this,\n              t = this.render,\n              n = 0;\n          return this.render = function () {\n            n++;\n          }, function () {\n            e.render = t, n > 0 && e.render();\n          };\n        }, u.prototype.setDirty = function () {\n          return this.isDirty = !0, this;\n        }, u.prototype.featureChanged = function (e) {\n          return this._changedFeatureIds.add(e), this;\n        }, u.prototype.getChangedIds = function () {\n          return this._changedFeatureIds.values();\n        }, u.prototype.clearChangedIds = function () {\n          return this._changedFeatureIds.clear(), this;\n        }, u.prototype.getAllIds = function () {\n          return this._featureIds.values();\n        }, u.prototype.add = function (e) {\n          return this.featureChanged(e.id), this._features[e.id] = e, this._featureIds.add(e.id), this;\n        }, u.prototype.delete = function (e) {\n          var t = this,\n              n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n          return i(e).forEach(function (e) {\n            t._featureIds.has(e) && (t._featureIds.delete(e), t._selectedFeatureIds.delete(e), n.silent || -1 === t._deletedFeaturesToEmit.indexOf(t._features[e]) && t._deletedFeaturesToEmit.push(t._features[e]), delete t._features[e], t.isDirty = !0);\n          }), o.call(this, n), this;\n        }, u.prototype.get = function (e) {\n          return this._features[e];\n        }, u.prototype.getAll = function () {\n          var e = this;\n          return Object.keys(this._features).map(function (t) {\n            return e._features[t];\n          });\n        }, u.prototype.select = function (e) {\n          var t = this,\n              n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n          return i(e).forEach(function (e) {\n            t._selectedFeatureIds.has(e) || (t._selectedFeatureIds.add(e), t._changedFeatureIds.add(e), n.silent || (t._emitSelectionChange = !0));\n          }), this;\n        }, u.prototype.deselect = function (e) {\n          var t = this,\n              n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n          return i(e).forEach(function (e) {\n            t._selectedFeatureIds.has(e) && (t._selectedFeatureIds.delete(e), t._changedFeatureIds.add(e), n.silent || (t._emitSelectionChange = !0));\n          }), o.call(this, n), this;\n        }, u.prototype.clearSelected = function () {\n          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n          return this.deselect(this._selectedFeatureIds.values(), {\n            silent: e.silent\n          }), this;\n        }, u.prototype.setSelected = function (e) {\n          var t = this,\n              n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n          return e = i(e), this.deselect(this._selectedFeatureIds.values().filter(function (t) {\n            return -1 === e.indexOf(t);\n          }), {\n            silent: n.silent\n          }), this.select(e.filter(function (e) {\n            return !t._selectedFeatureIds.has(e);\n          }), {\n            silent: n.silent\n          }), this;\n        }, u.prototype.setSelectedCoordinates = function (e) {\n          return this._selectedCoordinates = e, this._emitSelectionChange = !0, this;\n        }, u.prototype.clearSelectedCoordinates = function () {\n          return this._selectedCoordinates = [], this._emitSelectionChange = !0, this;\n        }, u.prototype.getSelectedIds = function () {\n          return this._selectedFeatureIds.values();\n        }, u.prototype.getSelected = function () {\n          var e = this;\n          return this._selectedFeatureIds.values().map(function (t) {\n            return e.get(t);\n          });\n        }, u.prototype.getSelectedCoordinates = function () {\n          var e = this;\n          return this._selectedCoordinates.map(function (t) {\n            return {\n              coordinates: e.get(t.feature_id).getCoordinate(t.coord_path)\n            };\n          });\n        }, u.prototype.isSelected = function (e) {\n          return this._selectedFeatureIds.has(e);\n        }, u.prototype.setFeatureProperty = function (e, t, n) {\n          this.get(e).setProperty(t, n), this.featureChanged(e);\n        }, u.prototype.storeMapConfig = function () {\n          var e = this;\n          c.forEach(function (t) {\n            e.ctx.map[t] && (e._mapInitialConfig[t] = e.ctx.map[t].isEnabled());\n          });\n        }, u.prototype.restoreMapConfig = function () {\n          var e = this;\n          Object.keys(this._mapInitialConfig).forEach(function (t) {\n            e._mapInitialConfig[t] ? e.ctx.map[t].enable() : e.ctx.map[t].disable();\n          });\n        }, u.prototype.getInitialConfigValue = function (e) {\n          return void 0 === this._mapInitialConfig[e] || this._mapInitialConfig[e];\n        };\n      }, {\n        \"./constants\": 23,\n        \"./lib/string_set\": 47,\n        \"./lib/throttle\": 50,\n        \"./lib/to_dense_array\": 51,\n        \"./render\": 62\n      }],\n      65: [function (e, t, n) {\n        var o = e(\"xtend\"),\n            r = e(\"./constants\"),\n            i = [\"mode\", \"feature\", \"mouse\"];\n\n        t.exports = function (e) {\n          function t(e) {\n            f = o(f, e);\n          }\n\n          function n() {\n            if (e.container) {\n              var t = [],\n                  n = [];\n              i.forEach(function (e) {\n                f[e] !== p[e] && (t.push(\"\".concat(e, \"-\").concat(p[e])), null !== f[e] && n.push(\"\".concat(e, \"-\").concat(f[e])));\n              }), t.length > 0 && e.container.classList.remove.apply(e.container.classList, t), n.length > 0 && e.container.classList.add.apply(e.container.classList, n), p = o(p, f);\n            }\n          }\n\n          function s(e) {\n            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n                n = document.createElement(\"button\");\n            return n.className = \"\".concat(r.classes.CONTROL_BUTTON, \" \").concat(t.className), n.setAttribute(\"title\", t.title), t.container.appendChild(n), n.addEventListener(\"click\", function (n) {\n              n.preventDefault(), n.stopPropagation(), n.target !== l ? (c(e), t.onActivate()) : a();\n            }, !0), n;\n          }\n\n          function a() {\n            l && (l.classList.remove(r.classes.ACTIVE_BUTTON), l = null);\n          }\n\n          function c(e) {\n            a();\n            var t = u[e];\n            t && t && \"trash\" !== e && (t.classList.add(r.classes.ACTIVE_BUTTON), l = t);\n          }\n\n          var u = {},\n              l = null,\n              p = {\n            mode: null,\n            feature: null,\n            mouse: null\n          },\n              f = {\n            mode: null,\n            feature: null,\n            mouse: null\n          };\n          return {\n            setActiveButton: c,\n            queueMapClasses: t,\n            updateMapClasses: n,\n            clearMapClasses: function () {\n              t({\n                mode: null,\n                feature: null,\n                mouse: null\n              }), n();\n            },\n            addButtons: function () {\n              var t = e.options.controls,\n                  n = document.createElement(\"div\");\n              return n.className = \"\".concat(r.classes.CONTROL_GROUP, \" \").concat(r.classes.CONTROL_BASE), t ? (t[r.types.LINE] && (u[r.types.LINE] = s(r.types.LINE, {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_LINE,\n                title: \"LineString tool \".concat(e.options.keybindings ? \"(l)\" : \"\"),\n                onActivate: function () {\n                  return e.events.changeMode(r.modes.DRAW_LINE_STRING);\n                }\n              })), t[r.types.POLYGON] && (u[r.types.POLYGON] = s(r.types.POLYGON, {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_POLYGON,\n                title: \"Polygon tool \".concat(e.options.keybindings ? \"(p)\" : \"\"),\n                onActivate: function () {\n                  return e.events.changeMode(r.modes.DRAW_POLYGON);\n                }\n              })), t[r.types.POINT] && (u[r.types.POINT] = s(r.types.POINT, {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_POINT,\n                title: \"Marker tool \".concat(e.options.keybindings ? \"(m)\" : \"\"),\n                onActivate: function () {\n                  return e.events.changeMode(r.modes.DRAW_POINT);\n                }\n              })), t.trash && (u.trash = s(\"trash\", {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_TRASH,\n                title: \"Delete\",\n                onActivate: function () {\n                  e.events.trash();\n                }\n              })), t.combine_features && (u.combine_features = s(\"combineFeatures\", {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_COMBINE_FEATURES,\n                title: \"Combine\",\n                onActivate: function () {\n                  e.events.combineFeatures();\n                }\n              })), t.uncombine_features && (u.uncombine_features = s(\"uncombineFeatures\", {\n                container: n,\n                className: r.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,\n                title: \"Uncombine\",\n                onActivate: function () {\n                  e.events.uncombineFeatures();\n                }\n              })), n) : n;\n            },\n            removeButtons: function () {\n              Object.keys(u).forEach(function (e) {\n                var t = u[e];\n                t.parentNode && t.parentNode.removeChild(t), delete u[e];\n              });\n            }\n          };\n        };\n      }, {\n        \"./constants\": 23,\n        xtend: 21\n      }]\n    }, {}, [1])(1);\n  });\n});\nvar theme = [{\n  'id': 'gl-draw-polygon-fill-inactive',\n  'type': 'fill',\n  'filter': ['all', ['==', 'active', 'false'], ['==', '$type', 'Polygon'], ['!=', 'mode', 'static']],\n  'paint': {\n    'fill-color': '#3bb2d0',\n    'fill-outline-color': '#3bb2d0',\n    'fill-opacity': 0.1\n  }\n}, {\n  'id': 'gl-draw-polygon-fill-active',\n  'type': 'fill',\n  'filter': ['all', ['==', 'active', 'true'], ['==', '$type', 'Polygon']],\n  'paint': {\n    'fill-color': '#fbb03b',\n    'fill-outline-color': '#fbb03b',\n    'fill-opacity': 0.1\n  }\n}, {\n  'id': 'gl-draw-polygon-midpoint',\n  'type': 'circle',\n  'filter': ['all', ['==', '$type', 'Point'], ['==', 'meta', 'midpoint']],\n  'paint': {\n    'circle-radius': 3,\n    'circle-color': '#fbb03b'\n  }\n}, {\n  'id': 'gl-draw-polygon-stroke-inactive',\n  'type': 'line',\n  'filter': ['all', ['==', 'active', 'false'], ['==', '$type', 'Polygon'], ['!=', 'mode', 'static']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#3bb2d0',\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-polygon-stroke-active',\n  'type': 'line',\n  'filter': ['all', ['==', 'active', 'true'], ['==', '$type', 'Polygon']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#fbb03b',\n    'line-dasharray': [0.2, 2],\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-line-inactive',\n  'type': 'line',\n  'filter': ['all', ['==', 'active', 'false'], ['==', '$type', 'LineString'], ['!=', 'mode', 'static']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#3bb2d0',\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-line-active',\n  'type': 'line',\n  'filter': ['all', ['==', '$type', 'LineString'], ['==', 'active', 'true']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#fbb03b',\n    'line-dasharray': [0.2, 2],\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-polygon-and-line-vertex-stroke-inactive',\n  'type': 'circle',\n  'filter': ['all', ['==', 'meta', 'vertex'], ['==', '$type', 'Point'], ['!=', 'mode', 'static']],\n  'paint': {\n    'circle-radius': 5,\n    'circle-color': '#fff'\n  }\n}, {\n  'id': 'gl-draw-polygon-and-line-vertex-inactive',\n  'type': 'circle',\n  'filter': ['all', ['==', 'meta', 'vertex'], ['==', '$type', 'Point'], ['!=', 'mode', 'static']],\n  'paint': {\n    'circle-radius': 3,\n    'circle-color': '#fbb03b'\n  }\n}, {\n  'id': 'gl-draw-point-point-stroke-inactive',\n  'type': 'circle',\n  'filter': ['all', ['==', 'active', 'false'], ['==', '$type', 'Point'], ['==', 'meta', 'feature'], ['!=', 'mode', 'static']],\n  'paint': {\n    'circle-radius': 5,\n    'circle-opacity': 1,\n    'circle-color': '#fff'\n  }\n}, {\n  'id': 'gl-draw-point-inactive',\n  'type': 'circle',\n  'filter': ['all', ['==', 'active', 'false'], ['==', '$type', 'Point'], ['==', 'meta', 'feature'], ['!=', 'mode', 'static']],\n  'paint': {\n    'circle-radius': 3,\n    'circle-color': '#3bb2d0'\n  }\n}, {\n  'id': 'gl-draw-point-stroke-active',\n  'type': 'circle',\n  'filter': ['all', ['==', '$type', 'Point'], ['==', 'active', 'true'], ['!=', 'meta', 'midpoint']],\n  'paint': {\n    'circle-radius': 7,\n    'circle-color': '#fff'\n  }\n}, {\n  'id': 'gl-draw-point-active',\n  'type': 'circle',\n  'filter': ['all', ['==', '$type', 'Point'], ['!=', 'meta', 'midpoint'], ['==', 'active', 'true']],\n  'paint': {\n    'circle-radius': 5,\n    'circle-color': '#fbb03b'\n  }\n}, {\n  'id': 'gl-draw-polygon-fill-static',\n  'type': 'fill',\n  'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Polygon']],\n  'paint': {\n    'fill-color': '#404040',\n    'fill-outline-color': '#404040',\n    'fill-opacity': 0.1\n  }\n}, {\n  'id': 'gl-draw-polygon-stroke-static',\n  'type': 'line',\n  'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Polygon']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#404040',\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-line-static',\n  'type': 'line',\n  'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'LineString']],\n  'layout': {\n    'line-cap': 'round',\n    'line-join': 'round'\n  },\n  'paint': {\n    'line-color': '#404040',\n    'line-width': 2\n  }\n}, {\n  'id': 'gl-draw-point-static',\n  'type': 'circle',\n  'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Point']],\n  'paint': {\n    'circle-radius': 5,\n    'circle-color': '#404040'\n  }\n}];\nvar constants = {\n  classes: {\n    CONTROL_BASE: 'mapboxgl-ctrl',\n    CONTROL_PREFIX: 'mapboxgl-ctrl-',\n    CONTROL_BUTTON: 'mapbox-gl-draw_ctrl-draw-btn',\n    CONTROL_BUTTON_LINE: 'mapbox-gl-draw_line',\n    CONTROL_BUTTON_POLYGON: 'mapbox-gl-draw_polygon',\n    CONTROL_BUTTON_POINT: 'mapbox-gl-draw_point',\n    CONTROL_BUTTON_TRASH: 'mapbox-gl-draw_trash',\n    CONTROL_BUTTON_COMBINE_FEATURES: 'mapbox-gl-draw_combine',\n    CONTROL_BUTTON_UNCOMBINE_FEATURES: 'mapbox-gl-draw_uncombine',\n    CONTROL_GROUP: 'mapboxgl-ctrl-group',\n    ATTRIBUTION: 'mapboxgl-ctrl-attrib',\n    ACTIVE_BUTTON: 'active',\n    BOX_SELECT: 'mapbox-gl-draw_boxselect'\n  },\n  sources: {\n    HOT: 'mapbox-gl-draw-hot',\n    COLD: 'mapbox-gl-draw-cold'\n  },\n  cursors: {\n    ADD: 'add',\n    MOVE: 'move',\n    DRAG: 'drag',\n    POINTER: 'pointer',\n    NONE: 'none'\n  },\n  types: {\n    POLYGON: 'polygon',\n    LINE: 'line_string',\n    POINT: 'point'\n  },\n  geojsonTypes: {\n    FEATURE: 'Feature',\n    POLYGON: 'Polygon',\n    LINE_STRING: 'LineString',\n    POINT: 'Point',\n    FEATURE_COLLECTION: 'FeatureCollection',\n    MULTI_PREFIX: 'Multi',\n    MULTI_POINT: 'MultiPoint',\n    MULTI_LINE_STRING: 'MultiLineString',\n    MULTI_POLYGON: 'MultiPolygon'\n  },\n  modes: {\n    DRAW_LINE_STRING: 'draw_line_string',\n    DRAW_POLYGON: 'draw_polygon',\n    DRAW_POINT: 'draw_point',\n    SIMPLE_SELECT: 'simple_select',\n    DIRECT_SELECT: 'direct_select',\n    STATIC: 'static'\n  },\n  events: {\n    CREATE: 'draw.create',\n    DELETE: 'draw.delete',\n    UPDATE: 'draw.update',\n    SELECTION_CHANGE: 'draw.selectionchange',\n    MODE_CHANGE: 'draw.modechange',\n    ACTIONABLE: 'draw.actionable',\n    RENDER: 'draw.render',\n    COMBINE_FEATURES: 'draw.combine',\n    UNCOMBINE_FEATURES: 'draw.uncombine'\n  },\n  updateActions: {\n    MOVE: 'move',\n    CHANGE_COORDINATES: 'change_coordinates'\n  },\n  meta: {\n    FEATURE: 'feature',\n    MIDPOINT: 'midpoint',\n    VERTEX: 'vertex'\n  },\n  activeStates: {\n    ACTIVE: 'true',\n    INACTIVE: 'false'\n  },\n  interactions: ['scrollZoom', 'boxZoom', 'dragRotate', 'dragPan', 'keyboard', 'doubleClickZoom', 'touchZoomRotate'],\n  LAT_MIN: -90,\n  LAT_RENDERED_MIN: -85,\n  LAT_MAX: 90,\n  LAT_RENDERED_MAX: 85,\n  LNG_MIN: -270,\n  LNG_MAX: 270\n};\nvar common_selectors = {\n  isOfMetaType: function (type) {\n    return function (e) {\n      const featureTarget = e.featureTarget;\n      if (!featureTarget) return false;\n      if (!featureTarget.properties) return false;\n      return featureTarget.properties.meta === type;\n    };\n  },\n  isShiftMousedown: function (e) {\n    if (!e.originalEvent) return false;\n    if (!e.originalEvent.shiftKey) return false;\n    return e.originalEvent.button === 0;\n  },\n  isActiveFeature: function (e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.active === constants.activeStates.ACTIVE && e.featureTarget.properties.meta === constants.meta.FEATURE;\n  },\n  isInactiveFeature: function (e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.active === constants.activeStates.INACTIVE && e.featureTarget.properties.meta === constants.meta.FEATURE;\n  },\n  noTarget: function (e) {\n    return e.featureTarget === undefined;\n  },\n  isFeature: function (e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.meta === constants.meta.FEATURE;\n  },\n  isVertex: function (e) {\n    const featureTarget = e.featureTarget;\n    if (!featureTarget) return false;\n    if (!featureTarget.properties) return false;\n    return featureTarget.properties.meta === constants.meta.VERTEX;\n  },\n  isShiftDown: function (e) {\n    if (!e.originalEvent) return false;\n    return e.originalEvent.shiftKey === true;\n  },\n  isEscapeKey: function (e) {\n    return e.keyCode === 27;\n  },\n  isEnterKey: function (e) {\n    return e.keyCode === 13;\n  },\n  true: function () {\n    return true;\n  }\n};\nvar pointGeometry = Point;\n/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class Point\n * @param {Number} x the x-coordinate. this could be longitude or screen\n * pixels, or any other sort of unit.\n * @param {Number} y the y-coordinate. this could be latitude or screen\n * pixels, or any other sort of unit.\n * @example\n * var point = new Point(-77, 38);\n */\n\nfunction Point(x, y) {\n  this.x = x;\n  this.y = y;\n}\n\nPoint.prototype = {\n  /**\n   * Clone this point, returning a new point that can be modified\n   * without affecting the old one.\n   * @return {Point} the clone\n   */\n  clone: function () {\n    return new Point(this.x, this.y);\n  },\n\n  /**\n   * Add this point's x & y coordinates to another point,\n   * yielding a new point.\n   * @param {Point} p the other point\n   * @return {Point} output point\n   */\n  add: function (p) {\n    return this.clone()._add(p);\n  },\n\n  /**\n   * Subtract this point's x & y coordinates to from point,\n   * yielding a new point.\n   * @param {Point} p the other point\n   * @return {Point} output point\n   */\n  sub: function (p) {\n    return this.clone()._sub(p);\n  },\n\n  /**\n   * Multiply this point's x & y coordinates by point,\n   * yielding a new point.\n   * @param {Point} p the other point\n   * @return {Point} output point\n   */\n  multByPoint: function (p) {\n    return this.clone()._multByPoint(p);\n  },\n\n  /**\n   * Divide this point's x & y coordinates by point,\n   * yielding a new point.\n   * @param {Point} p the other point\n   * @return {Point} output point\n   */\n  divByPoint: function (p) {\n    return this.clone()._divByPoint(p);\n  },\n\n  /**\n   * Multiply this point's x & y coordinates by a factor,\n   * yielding a new point.\n   * @param {Point} k factor\n   * @return {Point} output point\n   */\n  mult: function (k) {\n    return this.clone()._mult(k);\n  },\n\n  /**\n   * Divide this point's x & y coordinates by a factor,\n   * yielding a new point.\n   * @param {Point} k factor\n   * @return {Point} output point\n   */\n  div: function (k) {\n    return this.clone()._div(k);\n  },\n\n  /**\n   * Rotate this point around the 0, 0 origin by an angle a,\n   * given in radians\n   * @param {Number} a angle to rotate around, in radians\n   * @return {Point} output point\n   */\n  rotate: function (a) {\n    return this.clone()._rotate(a);\n  },\n\n  /**\n   * Rotate this point around p point by an angle a,\n   * given in radians\n   * @param {Number} a angle to rotate around, in radians\n   * @param {Point} p Point to rotate around\n   * @return {Point} output point\n   */\n  rotateAround: function (a, p) {\n    return this.clone()._rotateAround(a, p);\n  },\n\n  /**\n   * Multiply this point by a 4x1 transformation matrix\n   * @param {Array<Number>} m transformation matrix\n   * @return {Point} output point\n   */\n  matMult: function (m) {\n    return this.clone()._matMult(m);\n  },\n\n  /**\n   * Calculate this point but as a unit vector from 0, 0, meaning\n   * that the distance from the resulting point to the 0, 0\n   * coordinate will be equal to 1 and the angle from the resulting\n   * point to the 0, 0 coordinate will be the same as before.\n   * @return {Point} unit vector point\n   */\n  unit: function () {\n    return this.clone()._unit();\n  },\n\n  /**\n   * Compute a perpendicular point, where the new y coordinate\n   * is the old x coordinate and the new x coordinate is the old y\n   * coordinate multiplied by -1\n   * @return {Point} perpendicular point\n   */\n  perp: function () {\n    return this.clone()._perp();\n  },\n\n  /**\n   * Return a version of this point with the x & y coordinates\n   * rounded to integers.\n   * @return {Point} rounded point\n   */\n  round: function () {\n    return this.clone()._round();\n  },\n\n  /**\n   * Return the magitude of this point: this is the Euclidean\n   * distance from the 0, 0 coordinate to this point's x and y\n   * coordinates.\n   * @return {Number} magnitude\n   */\n  mag: function () {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  },\n\n  /**\n   * Judge whether this point is equal to another point, returning\n   * true or false.\n   * @param {Point} other the other point\n   * @return {boolean} whether the points are equal\n   */\n  equals: function (other) {\n    return this.x === other.x && this.y === other.y;\n  },\n\n  /**\n   * Calculate the distance from this point to another point\n   * @param {Point} p the other point\n   * @return {Number} distance\n   */\n  dist: function (p) {\n    return Math.sqrt(this.distSqr(p));\n  },\n\n  /**\n   * Calculate the distance from this point to another point,\n   * without the square root step. Useful if you're comparing\n   * relative distances.\n   * @param {Point} p the other point\n   * @return {Number} distance\n   */\n  distSqr: function (p) {\n    var dx = p.x - this.x,\n        dy = p.y - this.y;\n    return dx * dx + dy * dy;\n  },\n\n  /**\n   * Get the angle from the 0, 0 coordinate to this point, in radians\n   * coordinates.\n   * @return {Number} angle\n   */\n  angle: function () {\n    return Math.atan2(this.y, this.x);\n  },\n\n  /**\n   * Get the angle from this point to another point, in radians\n   * @param {Point} b the other point\n   * @return {Number} angle\n   */\n  angleTo: function (b) {\n    return Math.atan2(this.y - b.y, this.x - b.x);\n  },\n\n  /**\n   * Get the angle between this point and another point, in radians\n   * @param {Point} b the other point\n   * @return {Number} angle\n   */\n  angleWith: function (b) {\n    return this.angleWithSep(b.x, b.y);\n  },\n\n  /*\n   * Find the angle of the two vectors, solving the formula for\n   * the cross product a x b = |a||b|sin(θ) for θ.\n   * @param {Number} x the x-coordinate\n   * @param {Number} y the y-coordinate\n   * @return {Number} the angle in radians\n   */\n  angleWithSep: function (x, y) {\n    return Math.atan2(this.x * y - this.y * x, this.x * x + this.y * y);\n  },\n  _matMult: function (m) {\n    var x = m[0] * this.x + m[1] * this.y,\n        y = m[2] * this.x + m[3] * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  },\n  _add: function (p) {\n    this.x += p.x;\n    this.y += p.y;\n    return this;\n  },\n  _sub: function (p) {\n    this.x -= p.x;\n    this.y -= p.y;\n    return this;\n  },\n  _mult: function (k) {\n    this.x *= k;\n    this.y *= k;\n    return this;\n  },\n  _div: function (k) {\n    this.x /= k;\n    this.y /= k;\n    return this;\n  },\n  _multByPoint: function (p) {\n    this.x *= p.x;\n    this.y *= p.y;\n    return this;\n  },\n  _divByPoint: function (p) {\n    this.x /= p.x;\n    this.y /= p.y;\n    return this;\n  },\n  _unit: function () {\n    this._div(this.mag());\n\n    return this;\n  },\n  _perp: function () {\n    var y = this.y;\n    this.y = this.x;\n    this.x = -y;\n    return this;\n  },\n  _rotate: function (angle) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = cos * this.x - sin * this.y,\n        y = sin * this.x + cos * this.y;\n    this.x = x;\n    this.y = y;\n    return this;\n  },\n  _rotateAround: function (angle, p) {\n    var cos = Math.cos(angle),\n        sin = Math.sin(angle),\n        x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n        y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n    this.x = x;\n    this.y = y;\n    return this;\n  },\n  _round: function () {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  }\n};\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, or an unknown type, return it unchanged\n * @param {Array<Number>|Point|*} a any kind of input value\n * @return {Point} constructed point, or passed-through value.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\n\nPoint.convert = function (a) {\n  if (a instanceof Point) {\n    return a;\n  }\n\n  if (Array.isArray(a)) {\n    return new Point(a[0], a[1]);\n  }\n\n  return a;\n};\n/**\n * Returns a Point representing a mouse event's position\n * relative to a containing element.\n *\n * @param {MouseEvent} mouseEvent\n * @param {Node} container\n * @returns {Point}\n */\n\n\nfunction mouseEventPoint(mouseEvent, container) {\n  const rect = container.getBoundingClientRect();\n  return new pointGeometry(mouseEvent.clientX - rect.left - (container.clientLeft || 0), mouseEvent.clientY - rect.top - (container.clientTop || 0));\n}\n\nvar mouse_event_point = mouseEventPoint;\n/**\n * Returns GeoJSON for a Point representing the\n * vertex of another feature.\n *\n * @param {string} parentId\n * @param {Array<number>} coordinates\n * @param {string} path - Dot-separated numbers indicating exactly\n *   where the point exists within its parent feature's coordinates.\n * @param {boolean} selected\n * @return {GeoJSON} Point\n */\n\nvar create_vertex = function (parentId, coordinates, path, selected) {\n  return {\n    type: constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: constants.meta.VERTEX,\n      parent: parentId,\n      coord_path: path,\n      active: selected ? constants.activeStates.ACTIVE : constants.activeStates.INACTIVE\n    },\n    geometry: {\n      type: constants.geojsonTypes.POINT,\n      coordinates: coordinates\n    }\n  };\n};\n\nvar create_midpoint = function (parent, startVertex, endVertex, map) {\n  const startCoord = startVertex.geometry.coordinates;\n  const endCoord = endVertex.geometry.coordinates; // If a coordinate exceeds the projection, we can't calculate a midpoint,\n  // so run away\n\n  if (startCoord[1] > constants.LAT_RENDERED_MAX || startCoord[1] < constants.LAT_RENDERED_MIN || endCoord[1] > constants.LAT_RENDERED_MAX || endCoord[1] < constants.LAT_RENDERED_MIN) {\n    return null;\n  }\n\n  const ptA = map.project([startCoord[0], startCoord[1]]);\n  const ptB = map.project([endCoord[0], endCoord[1]]);\n  const mid = map.unproject([(ptA.x + ptB.x) / 2, (ptA.y + ptB.y) / 2]);\n  return {\n    type: constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: constants.meta.MIDPOINT,\n      parent: parent,\n      lng: mid.lng,\n      lat: mid.lat,\n      coord_path: endVertex.properties.coord_path\n    },\n    geometry: {\n      type: constants.geojsonTypes.POINT,\n      coordinates: [mid.lng, mid.lat]\n    }\n  };\n};\n\nfunction createSupplementaryPoints(geojson, options = {}, basePath = null) {\n  const _geojson$geometry = geojson.geometry,\n        type = _geojson$geometry.type,\n        coordinates = _geojson$geometry.coordinates;\n  const featureId = geojson.properties && geojson.properties.id;\n  let supplementaryPoints = [];\n\n  if (type === constants.geojsonTypes.POINT) {\n    // For points, just create a vertex\n    supplementaryPoints.push(create_vertex(featureId, coordinates, basePath, isSelectedPath(basePath)));\n  } else if (type === constants.geojsonTypes.POLYGON) {\n    // Cycle through a Polygon's rings and\n    // process each line\n    coordinates.forEach((line, lineIndex) => {\n      processLine(line, basePath !== null ? \"\".concat(basePath, \".\").concat(lineIndex) : String(lineIndex));\n    });\n  } else if (type === constants.geojsonTypes.LINE_STRING) {\n    processLine(coordinates, basePath);\n  } else if (type.indexOf(constants.geojsonTypes.MULTI_PREFIX) === 0) {\n    processMultiGeometry();\n  }\n\n  function processLine(line, lineBasePath) {\n    let firstPointString = '';\n    let lastVertex = null;\n    line.forEach((point, pointIndex) => {\n      const pointPath = lineBasePath !== undefined && lineBasePath !== null ? \"\".concat(lineBasePath, \".\").concat(pointIndex) : String(pointIndex);\n      const vertex = create_vertex(featureId, point, pointPath, isSelectedPath(pointPath)); // If we're creating midpoints, check if there was a\n      // vertex before this one. If so, add a midpoint\n      // between that vertex and this one.\n\n      if (options.midpoints && lastVertex) {\n        const midpoint = create_midpoint(featureId, lastVertex, vertex, options.map);\n\n        if (midpoint) {\n          supplementaryPoints.push(midpoint);\n        }\n      }\n\n      lastVertex = vertex; // A Polygon line's last point is the same as the first point. If we're on the last\n      // point, we want to draw a midpoint before it but not another vertex on it\n      // (since we already a vertex there, from the first point).\n\n      const stringifiedPoint = JSON.stringify(point);\n\n      if (firstPointString !== stringifiedPoint) {\n        supplementaryPoints.push(vertex);\n      }\n\n      if (pointIndex === 0) {\n        firstPointString = stringifiedPoint;\n      }\n    });\n  }\n\n  function isSelectedPath(path) {\n    if (!options.selectedPaths) return false;\n    return options.selectedPaths.indexOf(path) !== -1;\n  } // Split a multi-geometry into constituent\n  // geometries, and accumulate the supplementary points\n  // for each of those constituents\n\n\n  function processMultiGeometry() {\n    const subType = type.replace(constants.geojsonTypes.MULTI_PREFIX, '');\n    coordinates.forEach((subCoordinates, index) => {\n      const subFeature = {\n        type: constants.geojsonTypes.FEATURE,\n        properties: geojson.properties,\n        geometry: {\n          type: subType,\n          coordinates: subCoordinates\n        }\n      };\n      supplementaryPoints = supplementaryPoints.concat(createSupplementaryPoints(subFeature, options, index));\n    });\n  }\n\n  return supplementaryPoints;\n}\n\nvar create_supplementary_points = createSupplementaryPoints;\n\nfunction StringSet(items) {\n  this._items = {};\n  this._nums = {};\n  this._length = items ? items.length : 0;\n  if (!items) return;\n\n  for (let i = 0, l = items.length; i < l; i++) {\n    this.add(items[i]);\n    if (items[i] === undefined) continue;\n    if (typeof items[i] === 'string') this._items[items[i]] = i;else this._nums[items[i]] = i;\n  }\n}\n\nStringSet.prototype.add = function (x) {\n  if (this.has(x)) return this;\n  this._length++;\n  if (typeof x === 'string') this._items[x] = this._length;else this._nums[x] = this._length;\n  return this;\n};\n\nStringSet.prototype.delete = function (x) {\n  if (this.has(x) === false) return this;\n  this._length--;\n  delete this._items[x];\n  delete this._nums[x];\n  return this;\n};\n\nStringSet.prototype.has = function (x) {\n  if (typeof x !== 'string' && typeof x !== 'number') return false;\n  return this._items[x] !== undefined || this._nums[x] !== undefined;\n};\n\nStringSet.prototype.values = function () {\n  const values = [];\n  Object.keys(this._items).forEach(k => {\n    values.push({\n      k: k,\n      v: this._items[k]\n    });\n  });\n  Object.keys(this._nums).forEach(k => {\n    values.push({\n      k: JSON.parse(k),\n      v: this._nums[k]\n    });\n  });\n  return values.sort((a, b) => a.v - b.v).map(a => a.k);\n};\n\nStringSet.prototype.clear = function () {\n  this._length = 0;\n  this._items = {};\n  this._nums = {};\n  return this;\n};\n\nvar string_set = StringSet;\nvar double_click_zoom = {\n  enable(ctx) {\n    setTimeout(() => {\n      // First check we've got a map and some context.\n      if (!ctx.map || !ctx.map.doubleClickZoom || !ctx._ctx || !ctx._ctx.store || !ctx._ctx.store.getInitialConfigValue) return; // Now check initial state wasn't false (we leave it disabled if so)\n\n      if (!ctx._ctx.store.getInitialConfigValue('doubleClickZoom')) return;\n      ctx.map.doubleClickZoom.enable();\n    }, 0);\n  },\n\n  disable(ctx) {\n    setTimeout(() => {\n      if (!ctx.map || !ctx.map.doubleClickZoom) return; // Always disable here, as it's necessary in some cases.\n\n      ctx.map.doubleClickZoom.disable();\n    }, 0);\n  }\n\n};\nvar geojsonNormalize = normalize;\nvar types = {\n  Point: 'geometry',\n  MultiPoint: 'geometry',\n  LineString: 'geometry',\n  MultiLineString: 'geometry',\n  Polygon: 'geometry',\n  MultiPolygon: 'geometry',\n  GeometryCollection: 'geometry',\n  Feature: 'feature',\n  FeatureCollection: 'featurecollection'\n};\n/**\n * Normalize a GeoJSON feature into a FeatureCollection.\n *\n * @param {object} gj geojson data\n * @returns {object} normalized geojson data\n */\n\nfunction normalize(gj) {\n  if (!gj || !gj.type) return null;\n  var type = types[gj.type];\n  if (!type) return null;\n\n  if (type === 'geometry') {\n    return {\n      type: 'FeatureCollection',\n      features: [{\n        type: 'Feature',\n        properties: {},\n        geometry: gj\n      }]\n    };\n  } else if (type === 'feature') {\n    return {\n      type: 'FeatureCollection',\n      features: [gj]\n    };\n  } else if (type === 'featurecollection') {\n    return gj;\n  }\n}\n\nvar dist = function e(t) {\n  switch (t && t.type || null) {\n    case \"FeatureCollection\":\n      return t.features = t.features.reduce(function (t, r) {\n        return t.concat(e(r));\n      }, []), t;\n\n    case \"Feature\":\n      return t.geometry ? e(t.geometry).map(function (e) {\n        var r = {\n          type: \"Feature\",\n          properties: JSON.parse(JSON.stringify(t.properties)),\n          geometry: e\n        };\n        return void 0 !== t.id && (r.id = t.id), r;\n      }) : t;\n\n    case \"MultiPoint\":\n      return t.coordinates.map(function (e) {\n        return {\n          type: \"Point\",\n          coordinates: e\n        };\n      });\n\n    case \"MultiPolygon\":\n      return t.coordinates.map(function (e) {\n        return {\n          type: \"Polygon\",\n          coordinates: e\n        };\n      });\n\n    case \"MultiLineString\":\n      return t.coordinates.map(function (e) {\n        return {\n          type: \"LineString\",\n          coordinates: e\n        };\n      });\n\n    case \"GeometryCollection\":\n      return t.geometries.map(e).reduce(function (e, t) {\n        return e.concat(t);\n      }, []);\n\n    case \"Point\":\n    case \"Polygon\":\n    case \"LineString\":\n      return [t];\n  }\n};\n\nvar flatten = function flatten(list) {\n  return _flatten(list);\n\n  function _flatten(list) {\n    if (Array.isArray(list) && list.length && typeof list[0] === 'number') {\n      return [list];\n    }\n\n    return list.reduce(function (acc, item) {\n      if (Array.isArray(item) && Array.isArray(item[0])) {\n        return acc.concat(_flatten(item));\n      } else {\n        acc.push(item);\n        return acc;\n      }\n    }, []);\n  }\n};\n\nvar geojsonCoords = function (_) {\n  if (!_) return [];\n  var normalized = dist(geojsonNormalize(_)),\n      coordinates = [];\n  normalized.features.forEach(function (feature) {\n    if (!feature.geometry) return;\n    coordinates = coordinates.concat(flatten(feature.geometry.coordinates));\n  });\n  return coordinates;\n};\n\nvar traverse_1 = createCommonjsModule(function (module) {\n  var traverse = module.exports = function (obj) {\n    return new Traverse(obj);\n  };\n\n  function Traverse(obj) {\n    this.value = obj;\n  }\n\n  Traverse.prototype.get = function (ps) {\n    var node = this.value;\n\n    for (var i = 0; i < ps.length; i++) {\n      var key = ps[i];\n\n      if (!node || !hasOwnProperty.call(node, key)) {\n        node = undefined;\n        break;\n      }\n\n      node = node[key];\n    }\n\n    return node;\n  };\n\n  Traverse.prototype.has = function (ps) {\n    var node = this.value;\n\n    for (var i = 0; i < ps.length; i++) {\n      var key = ps[i];\n\n      if (!node || !hasOwnProperty.call(node, key)) {\n        return false;\n      }\n\n      node = node[key];\n    }\n\n    return true;\n  };\n\n  Traverse.prototype.set = function (ps, value) {\n    var node = this.value;\n\n    for (var i = 0; i < ps.length - 1; i++) {\n      var key = ps[i];\n      if (!hasOwnProperty.call(node, key)) node[key] = {};\n      node = node[key];\n    }\n\n    node[ps[i]] = value;\n    return value;\n  };\n\n  Traverse.prototype.map = function (cb) {\n    return walk(this.value, cb, true);\n  };\n\n  Traverse.prototype.forEach = function (cb) {\n    this.value = walk(this.value, cb, false);\n    return this.value;\n  };\n\n  Traverse.prototype.reduce = function (cb, init) {\n    var skip = arguments.length === 1;\n    var acc = skip ? this.value : init;\n    this.forEach(function (x) {\n      if (!this.isRoot || !skip) {\n        acc = cb.call(this, acc, x);\n      }\n    });\n    return acc;\n  };\n\n  Traverse.prototype.paths = function () {\n    var acc = [];\n    this.forEach(function (x) {\n      acc.push(this.path);\n    });\n    return acc;\n  };\n\n  Traverse.prototype.nodes = function () {\n    var acc = [];\n    this.forEach(function (x) {\n      acc.push(this.node);\n    });\n    return acc;\n  };\n\n  Traverse.prototype.clone = function () {\n    var parents = [],\n        nodes = [];\n    return function clone(src) {\n      for (var i = 0; i < parents.length; i++) {\n        if (parents[i] === src) {\n          return nodes[i];\n        }\n      }\n\n      if (typeof src === 'object' && src !== null) {\n        var dst = copy(src);\n        parents.push(src);\n        nodes.push(dst);\n        forEach(objectKeys(src), function (key) {\n          dst[key] = clone(src[key]);\n        });\n        parents.pop();\n        nodes.pop();\n        return dst;\n      } else {\n        return src;\n      }\n    }(this.value);\n  };\n\n  function walk(root, cb, immutable) {\n    var path = [];\n    var parents = [];\n    var alive = true;\n    return function walker(node_) {\n      var node = immutable ? copy(node_) : node_;\n      var modifiers = {};\n      var keepGoing = true;\n      var state = {\n        node: node,\n        node_: node_,\n        path: [].concat(path),\n        parent: parents[parents.length - 1],\n        parents: parents,\n        key: path.slice(-1)[0],\n        isRoot: path.length === 0,\n        level: path.length,\n        circular: null,\n        update: function (x, stopHere) {\n          if (!state.isRoot) {\n            state.parent.node[state.key] = x;\n          }\n\n          state.node = x;\n          if (stopHere) keepGoing = false;\n        },\n        'delete': function (stopHere) {\n          delete state.parent.node[state.key];\n          if (stopHere) keepGoing = false;\n        },\n        remove: function (stopHere) {\n          if (isArray(state.parent.node)) {\n            state.parent.node.splice(state.key, 1);\n          } else {\n            delete state.parent.node[state.key];\n          }\n\n          if (stopHere) keepGoing = false;\n        },\n        keys: null,\n        before: function (f) {\n          modifiers.before = f;\n        },\n        after: function (f) {\n          modifiers.after = f;\n        },\n        pre: function (f) {\n          modifiers.pre = f;\n        },\n        post: function (f) {\n          modifiers.post = f;\n        },\n        stop: function () {\n          alive = false;\n        },\n        block: function () {\n          keepGoing = false;\n        }\n      };\n      if (!alive) return state;\n\n      function updateState() {\n        if (typeof state.node === 'object' && state.node !== null) {\n          if (!state.keys || state.node_ !== state.node) {\n            state.keys = objectKeys(state.node);\n          }\n\n          state.isLeaf = state.keys.length == 0;\n\n          for (var i = 0; i < parents.length; i++) {\n            if (parents[i].node_ === node_) {\n              state.circular = parents[i];\n              break;\n            }\n          }\n        } else {\n          state.isLeaf = true;\n          state.keys = null;\n        }\n\n        state.notLeaf = !state.isLeaf;\n        state.notRoot = !state.isRoot;\n      }\n\n      updateState(); // use return values to update if defined\n\n      var ret = cb.call(state, state.node);\n      if (ret !== undefined && state.update) state.update(ret);\n      if (modifiers.before) modifiers.before.call(state, state.node);\n      if (!keepGoing) return state;\n\n      if (typeof state.node == 'object' && state.node !== null && !state.circular) {\n        parents.push(state);\n        updateState();\n        forEach(state.keys, function (key, i) {\n          path.push(key);\n          if (modifiers.pre) modifiers.pre.call(state, state.node[key], key);\n          var child = walker(state.node[key]);\n\n          if (immutable && hasOwnProperty.call(state.node, key)) {\n            state.node[key] = child.node;\n          }\n\n          child.isLast = i == state.keys.length - 1;\n          child.isFirst = i == 0;\n          if (modifiers.post) modifiers.post.call(state, child);\n          path.pop();\n        });\n        parents.pop();\n      }\n\n      if (modifiers.after) modifiers.after.call(state, state.node);\n      return state;\n    }(root).node;\n  }\n\n  function copy(src) {\n    if (typeof src === 'object' && src !== null) {\n      var dst;\n\n      if (isArray(src)) {\n        dst = [];\n      } else if (isDate(src)) {\n        dst = new Date(src.getTime ? src.getTime() : src);\n      } else if (isRegExp(src)) {\n        dst = new RegExp(src);\n      } else if (isError(src)) {\n        dst = {\n          message: src.message\n        };\n      } else if (isBoolean(src)) {\n        dst = new Boolean(src);\n      } else if (isNumber(src)) {\n        dst = new Number(src);\n      } else if (isString(src)) {\n        dst = new String(src);\n      } else if (Object.create && Object.getPrototypeOf) {\n        dst = Object.create(Object.getPrototypeOf(src));\n      } else if (src.constructor === Object) {\n        dst = {};\n      } else {\n        var proto = src.constructor && src.constructor.prototype || src.__proto__ || {};\n\n        var T = function () {};\n\n        T.prototype = proto;\n        dst = new T();\n      }\n\n      forEach(objectKeys(src), function (key) {\n        dst[key] = src[key];\n      });\n      return dst;\n    } else return src;\n  }\n\n  var objectKeys = Object.keys || function keys(obj) {\n    var res = [];\n\n    for (var key in obj) res.push(key);\n\n    return res;\n  };\n\n  function toS(obj) {\n    return Object.prototype.toString.call(obj);\n  }\n\n  function isDate(obj) {\n    return toS(obj) === '[object Date]';\n  }\n\n  function isRegExp(obj) {\n    return toS(obj) === '[object RegExp]';\n  }\n\n  function isError(obj) {\n    return toS(obj) === '[object Error]';\n  }\n\n  function isBoolean(obj) {\n    return toS(obj) === '[object Boolean]';\n  }\n\n  function isNumber(obj) {\n    return toS(obj) === '[object Number]';\n  }\n\n  function isString(obj) {\n    return toS(obj) === '[object String]';\n  }\n\n  var isArray = Array.isArray || function isArray(xs) {\n    return Object.prototype.toString.call(xs) === '[object Array]';\n  };\n\n  var forEach = function (xs, fn) {\n    if (xs.forEach) return xs.forEach(fn);else for (var i = 0; i < xs.length; i++) {\n      fn(xs[i], i, xs);\n    }\n  };\n\n  forEach(objectKeys(Traverse.prototype), function (key) {\n    traverse[key] = function (obj) {\n      var args = [].slice.call(arguments, 1);\n      var t = new Traverse(obj);\n      return t[key].apply(t, args);\n    };\n  });\n\n  var hasOwnProperty = Object.hasOwnProperty || function (obj, key) {\n    return key in obj;\n  };\n});\nvar extent = Extent;\n\nfunction Extent(bbox) {\n  if (!(this instanceof Extent)) {\n    return new Extent(bbox);\n  }\n\n  this._bbox = bbox || [Infinity, Infinity, -Infinity, -Infinity];\n  this._valid = !!bbox;\n}\n\nExtent.prototype.include = function (ll) {\n  this._valid = true;\n  this._bbox[0] = Math.min(this._bbox[0], ll[0]);\n  this._bbox[1] = Math.min(this._bbox[1], ll[1]);\n  this._bbox[2] = Math.max(this._bbox[2], ll[0]);\n  this._bbox[3] = Math.max(this._bbox[3], ll[1]);\n  return this;\n};\n\nExtent.prototype.equals = function (_) {\n  var other;\n\n  if (_ instanceof Extent) {\n    other = _.bbox();\n  } else {\n    other = _;\n  }\n\n  return this._bbox[0] == other[0] && this._bbox[1] == other[1] && this._bbox[2] == other[2] && this._bbox[3] == other[3];\n};\n\nExtent.prototype.center = function (_) {\n  if (!this._valid) return null;\n  return [(this._bbox[0] + this._bbox[2]) / 2, (this._bbox[1] + this._bbox[3]) / 2];\n};\n\nExtent.prototype.union = function (_) {\n  this._valid = true;\n  var other;\n\n  if (_ instanceof Extent) {\n    other = _.bbox();\n  } else {\n    other = _;\n  }\n\n  this._bbox[0] = Math.min(this._bbox[0], other[0]);\n  this._bbox[1] = Math.min(this._bbox[1], other[1]);\n  this._bbox[2] = Math.max(this._bbox[2], other[2]);\n  this._bbox[3] = Math.max(this._bbox[3], other[3]);\n  return this;\n};\n\nExtent.prototype.bbox = function () {\n  if (!this._valid) return null;\n  return this._bbox;\n};\n\nExtent.prototype.contains = function (ll) {\n  if (!ll) return this._fastContains();\n  if (!this._valid) return null;\n  var lon = ll[0],\n      lat = ll[1];\n  return this._bbox[0] <= lon && this._bbox[1] <= lat && this._bbox[2] >= lon && this._bbox[3] >= lat;\n};\n\nExtent.prototype.intersect = function (_) {\n  if (!this._valid) return null;\n  var other;\n\n  if (_ instanceof Extent) {\n    other = _.bbox();\n  } else {\n    other = _;\n  }\n\n  return !(this._bbox[0] > other[2] || this._bbox[2] < other[0] || this._bbox[3] < other[1] || this._bbox[1] > other[3]);\n};\n\nExtent.prototype._fastContains = function () {\n  if (!this._valid) return new Function('return null;');\n  var body = 'return ' + this._bbox[0] + '<= ll[0] &&' + this._bbox[1] + '<= ll[1] &&' + this._bbox[2] + '>= ll[0] &&' + this._bbox[3] + '>= ll[1]';\n  return new Function('ll', body);\n};\n\nExtent.prototype.polygon = function () {\n  if (!this._valid) return null;\n  return {\n    type: 'Polygon',\n    coordinates: [[// W, S\n    [this._bbox[0], this._bbox[1]], // E, S\n    [this._bbox[2], this._bbox[1]], // E, N\n    [this._bbox[2], this._bbox[3]], // W, N\n    [this._bbox[0], this._bbox[3]], // W, S\n    [this._bbox[0], this._bbox[1]]]]\n  };\n};\n\nvar geojsonTypesByDataAttributes = {\n  features: ['FeatureCollection'],\n  coordinates: ['Point', 'MultiPoint', 'LineString', 'MultiLineString', 'Polygon', 'MultiPolygon'],\n  geometry: ['Feature'],\n  geometries: ['GeometryCollection']\n};\nvar dataAttributes = Object.keys(geojsonTypesByDataAttributes);\n\nvar geojsonExtent = function (_) {\n  return getExtent(_).bbox();\n};\n\nvar polygon = function (_) {\n  return getExtent(_).polygon();\n};\n\nvar bboxify = function (_) {\n  return traverse_1(_).map(function (value) {\n    if (!value) return;\n    var isValid = dataAttributes.some(function (attribute) {\n      if (value[attribute]) {\n        return geojsonTypesByDataAttributes[attribute].indexOf(value.type) !== -1;\n      }\n\n      return false;\n    });\n\n    if (isValid) {\n      value.bbox = getExtent(value).bbox();\n      this.update(value);\n    }\n  });\n};\n\nfunction getExtent(_) {\n  var ext = extent(),\n      coords = geojsonCoords(_);\n\n  for (var i = 0; i < coords.length; i++) ext.include(coords[i]);\n\n  return ext;\n}\n\ngeojsonExtent.polygon = polygon;\ngeojsonExtent.bboxify = bboxify;\nconst LAT_MIN = constants.LAT_MIN,\n      LAT_MAX = constants.LAT_MAX,\n      LAT_RENDERED_MIN = constants.LAT_RENDERED_MIN,\n      LAT_RENDERED_MAX = constants.LAT_RENDERED_MAX,\n      LNG_MIN = constants.LNG_MIN,\n      LNG_MAX = constants.LNG_MAX; // Ensure that we do not drag north-south far enough for\n// - any part of any feature to exceed the poles\n// - any feature to be completely lost in the space between the projection's\n//   edge and the poles, such that it couldn't be re-selected and moved back\n\nvar constrain_feature_movement = function (geojsonFeatures, delta) {\n  // \"inner edge\" = a feature's latitude closest to the equator\n  let northInnerEdge = LAT_MIN;\n  let southInnerEdge = LAT_MAX; // \"outer edge\" = a feature's latitude furthest from the equator\n\n  let northOuterEdge = LAT_MIN;\n  let southOuterEdge = LAT_MAX;\n  let westEdge = LNG_MAX;\n  let eastEdge = LNG_MIN;\n  geojsonFeatures.forEach(feature => {\n    const bounds = geojsonExtent(feature);\n    const featureSouthEdge = bounds[1];\n    const featureNorthEdge = bounds[3];\n    const featureWestEdge = bounds[0];\n    const featureEastEdge = bounds[2];\n    if (featureSouthEdge > northInnerEdge) northInnerEdge = featureSouthEdge;\n    if (featureNorthEdge < southInnerEdge) southInnerEdge = featureNorthEdge;\n    if (featureNorthEdge > northOuterEdge) northOuterEdge = featureNorthEdge;\n    if (featureSouthEdge < southOuterEdge) southOuterEdge = featureSouthEdge;\n    if (featureWestEdge < westEdge) westEdge = featureWestEdge;\n    if (featureEastEdge > eastEdge) eastEdge = featureEastEdge;\n  }); // These changes are not mutually exclusive: we might hit the inner\n  // edge but also have hit the outer edge and therefore need\n  // another readjustment\n\n  const constrainedDelta = delta;\n\n  if (northInnerEdge + constrainedDelta.lat > LAT_RENDERED_MAX) {\n    constrainedDelta.lat = LAT_RENDERED_MAX - northInnerEdge;\n  }\n\n  if (northOuterEdge + constrainedDelta.lat > LAT_MAX) {\n    constrainedDelta.lat = LAT_MAX - northOuterEdge;\n  }\n\n  if (southInnerEdge + constrainedDelta.lat < LAT_RENDERED_MIN) {\n    constrainedDelta.lat = LAT_RENDERED_MIN - southInnerEdge;\n  }\n\n  if (southOuterEdge + constrainedDelta.lat < LAT_MIN) {\n    constrainedDelta.lat = LAT_MIN - southOuterEdge;\n  }\n\n  if (westEdge + constrainedDelta.lng <= LNG_MIN) {\n    constrainedDelta.lng += Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n\n  if (eastEdge + constrainedDelta.lng >= LNG_MAX) {\n    constrainedDelta.lng -= Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n\n  return constrainedDelta;\n};\n\nvar move_features = function (features, delta) {\n  const constrainedDelta = constrain_feature_movement(features.map(feature => feature.toGeoJSON()), delta);\n  features.forEach(feature => {\n    const currentCoordinates = feature.getCoordinates();\n\n    const moveCoordinate = coord => {\n      const point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat\n      };\n      return [point.lng, point.lat];\n    };\n\n    const moveRing = ring => ring.map(coord => moveCoordinate(coord));\n\n    const moveMultiPolygon = multi => multi.map(ring => moveRing(ring));\n\n    let nextCoordinates;\n\n    if (feature.type === constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (feature.type === constants.geojsonTypes.LINE_STRING || feature.type === constants.geojsonTypes.MULTI_POINT) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (feature.type === constants.geojsonTypes.POLYGON || feature.type === constants.geojsonTypes.MULTI_LINE_STRING) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n};\n\nconst SimpleSelect = {};\n\nSimpleSelect.onSetup = function (opts) {\n  // turn the opts into state.\n  const state = {\n    dragMoveLocation: null,\n    boxSelectStartLocation: null,\n    boxSelectElement: undefined,\n    boxSelecting: false,\n    canBoxSelect: false,\n    dragMoveing: false,\n    canDragMove: false,\n    initiallySelectedFeatureIds: opts.featureIds || []\n  };\n  this.setSelected(state.initiallySelectedFeatureIds.filter(id => {\n    return this.getFeature(id) !== undefined;\n  }));\n  this.fireActionable();\n  this.setActionableState({\n    combineFeatures: true,\n    uncombineFeatures: true,\n    trash: true\n  });\n  return state;\n};\n\nSimpleSelect.fireUpdate = function () {\n  this.map.fire(constants.events.UPDATE, {\n    action: constants.updateActions.MOVE,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nSimpleSelect.fireActionable = function () {\n  const selectedFeatures = this.getSelected();\n  const multiFeatures = selectedFeatures.filter(feature => this.isInstanceOf('MultiFeature', feature));\n  let combineFeatures = false;\n\n  if (selectedFeatures.length > 1) {\n    combineFeatures = true;\n    const featureType = selectedFeatures[0].type.replace('Multi', '');\n    selectedFeatures.forEach(feature => {\n      if (feature.type.replace('Multi', '') !== featureType) {\n        combineFeatures = false;\n      }\n    });\n  }\n\n  const uncombineFeatures = multiFeatures.length > 0;\n  const trash = selectedFeatures.length > 0;\n  this.setActionableState({\n    combineFeatures,\n    uncombineFeatures,\n    trash\n  });\n};\n\nSimpleSelect.getUniqueIds = function (allFeatures) {\n  if (!allFeatures.length) return [];\n  const ids = allFeatures.map(s => s.properties.id).filter(id => id !== undefined).reduce((memo, id) => {\n    memo.add(id);\n    return memo;\n  }, new string_set());\n  return ids.values();\n};\n\nSimpleSelect.stopExtendedInteractions = function (state) {\n  if (state.boxSelectElement) {\n    if (state.boxSelectElement.parentNode) state.boxSelectElement.parentNode.removeChild(state.boxSelectElement);\n    state.boxSelectElement = null;\n  }\n\n  this.map.dragPan.enable();\n  state.boxSelecting = false;\n  state.canBoxSelect = false;\n  state.dragMoving = false;\n  state.canDragMove = false;\n};\n\nSimpleSelect.onStop = function () {\n  double_click_zoom.enable(this);\n};\n\nSimpleSelect.onMouseMove = function (state) {\n  // On mousemove that is not a drag, stop extended interactions.\n  // This is useful if you drag off the canvas, release the button,\n  // then move the mouse back over the canvas --- we don't allow the\n  // interaction to continue then, but we do let it continue if you held\n  // the mouse button that whole time\n  return this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) return this.fireUpdate();\n};\n\nSimpleSelect.onTap = SimpleSelect.onClick = function (state, e) {\n  // Click (with or without shift) on no feature\n  if (common_selectors.noTarget(e)) return this.clickAnywhere(state, e); // also tap\n\n  if (common_selectors.isOfMetaType(constants.meta.VERTEX)(e)) return this.clickOnVertex(state, e); //tap\n\n  if (common_selectors.isFeature(e)) return this.clickOnFeature(state, e);\n};\n\nSimpleSelect.clickAnywhere = function (state) {\n  // Clear the re-render selection\n  const wasSelected = this.getSelectedIds();\n\n  if (wasSelected.length) {\n    this.clearSelectedFeatures();\n    wasSelected.forEach(id => this.doRender(id));\n  }\n\n  double_click_zoom.enable(this);\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.clickOnVertex = function (state, e) {\n  // Enter direct select mode\n  this.changeMode(constants.modes.DIRECT_SELECT, {\n    featureId: e.featureTarget.properties.parent,\n    coordPath: e.featureTarget.properties.coord_path,\n    startPos: e.lngLat\n  });\n  this.updateUIClasses({\n    mouse: constants.cursors.MOVE\n  });\n};\n\nSimpleSelect.startOnActiveFeature = function (state, e) {\n  // Stop any already-underway extended interactions\n  this.stopExtendedInteractions(state); // Disable map.dragPan immediately so it can't start\n\n  this.map.dragPan.disable(); // Re-render it and enable drag move\n\n  this.doRender(e.featureTarget.properties.id); // Set up the state for drag moving\n\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.clickOnFeature = function (state, e) {\n  // Stop everything\n  double_click_zoom.disable(this);\n  this.stopExtendedInteractions(state);\n  const isShiftClick = common_selectors.isShiftDown(e);\n  const selectedFeatureIds = this.getSelectedIds();\n  const featureId = e.featureTarget.properties.id;\n  const isFeatureSelected = this.isSelected(featureId); // Click (without shift) on any selected feature but a point\n\n  if (!isShiftClick && isFeatureSelected && this.getFeature(featureId).type !== constants.geojsonTypes.POINT) {\n    // Enter direct select mode\n    return this.changeMode(constants.modes.DIRECT_SELECT, {\n      featureId: featureId\n    });\n  } // Shift-click on a selected feature\n\n\n  if (isFeatureSelected && isShiftClick) {\n    // Deselect it\n    this.deselect(featureId);\n    this.updateUIClasses({\n      mouse: constants.cursors.POINTER\n    });\n\n    if (selectedFeatureIds.length === 1) {\n      double_click_zoom.enable(this);\n    } // Shift-click on an unselected feature\n\n  } else if (!isFeatureSelected && isShiftClick) {\n    // Add it to the selection\n    this.select(featureId);\n    this.updateUIClasses({\n      mouse: constants.cursors.MOVE\n    }); // Click (without shift) on an unselected feature\n  } else if (!isFeatureSelected && !isShiftClick) {\n    // Make it the only selected feature\n    selectedFeatureIds.forEach(id => this.doRender(id));\n    this.setSelected(featureId);\n    this.updateUIClasses({\n      mouse: constants.cursors.MOVE\n    });\n  } // No matter what, re-render the clicked feature\n\n\n  this.doRender(featureId);\n};\n\nSimpleSelect.onMouseDown = function (state, e) {\n  if (common_selectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n  if (this.drawConfig.boxSelect && common_selectors.isShiftMousedown(e)) return this.startBoxSelect(state, e);\n};\n\nSimpleSelect.startBoxSelect = function (state, e) {\n  this.stopExtendedInteractions(state);\n  this.map.dragPan.disable(); // Enable box select\n\n  state.boxSelectStartLocation = mouse_event_point(e.originalEvent, this.map.getContainer());\n  state.canBoxSelect = true;\n};\n\nSimpleSelect.onTouchStart = function (state, e) {\n  if (common_selectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n};\n\nSimpleSelect.onDrag = function (state, e) {\n  if (state.canDragMove) return this.dragMove(state, e);\n  if (this.drawConfig.boxSelect && state.canBoxSelect) return this.whileBoxSelect(state, e);\n};\n\nSimpleSelect.whileBoxSelect = function (state, e) {\n  state.boxSelecting = true;\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  }); // Create the box node if it doesn't exist\n\n  if (!state.boxSelectElement) {\n    state.boxSelectElement = document.createElement('div');\n    state.boxSelectElement.classList.add(constants.classes.BOX_SELECT);\n    this.map.getContainer().appendChild(state.boxSelectElement);\n  } // Adjust the box node's width and xy position\n\n\n  const current = mouse_event_point(e.originalEvent, this.map.getContainer());\n  const minX = Math.min(state.boxSelectStartLocation.x, current.x);\n  const maxX = Math.max(state.boxSelectStartLocation.x, current.x);\n  const minY = Math.min(state.boxSelectStartLocation.y, current.y);\n  const maxY = Math.max(state.boxSelectStartLocation.y, current.y);\n  const translateValue = \"translate(\".concat(minX, \"px, \").concat(minY, \"px)\");\n  state.boxSelectElement.style.transform = translateValue;\n  state.boxSelectElement.style.WebkitTransform = translateValue;\n  state.boxSelectElement.style.width = \"\".concat(maxX - minX, \"px\");\n  state.boxSelectElement.style.height = \"\".concat(maxY - minY, \"px\");\n};\n\nSimpleSelect.dragMove = function (state, e) {\n  // Dragging when drag move is enabled\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n  move_features(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.onMouseUp = function (state, e) {\n  // End any extended interactions\n  if (state.dragMoving) {\n    this.fireUpdate();\n  } else if (state.boxSelecting) {\n    const bbox = [state.boxSelectStartLocation, mouse_event_point(e.originalEvent, this.map.getContainer())];\n    const featuresInBox = this.featuresAt(null, bbox, 'click');\n    const idsToSelect = this.getUniqueIds(featuresInBox).filter(id => !this.isSelected(id));\n\n    if (idsToSelect.length) {\n      this.select(idsToSelect);\n      idsToSelect.forEach(id => this.doRender(id));\n      this.updateUIClasses({\n        mouse: constants.cursors.MOVE\n      });\n    }\n  }\n\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.toDisplayFeatures = function (state, geojson, display) {\n  geojson.properties.active = this.isSelected(geojson.properties.id) ? constants.activeStates.ACTIVE : constants.activeStates.INACTIVE;\n  display(geojson);\n  this.fireActionable();\n  if (geojson.properties.active !== constants.activeStates.ACTIVE || geojson.geometry.type === constants.geojsonTypes.POINT) return;\n  create_supplementary_points(geojson).forEach(display);\n};\n\nSimpleSelect.onTrash = function () {\n  this.deleteFeature(this.getSelectedIds());\n  this.fireActionable();\n};\n\nSimpleSelect.onCombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0 || selectedFeatures.length < 2) return;\n  const coordinates = [],\n        featuresCombined = [];\n  const featureType = selectedFeatures[0].type.replace('Multi', '');\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (feature.type.replace('Multi', '') !== featureType) {\n      return;\n    }\n\n    if (feature.type.includes('Multi')) {\n      feature.getCoordinates().forEach(subcoords => {\n        coordinates.push(subcoords);\n      });\n    } else {\n      coordinates.push(feature.getCoordinates());\n    }\n\n    featuresCombined.push(feature.toGeoJSON());\n  }\n\n  if (featuresCombined.length > 1) {\n    const multiFeature = this.newFeature({\n      type: constants.geojsonTypes.FEATURE,\n      properties: featuresCombined[0].properties,\n      geometry: {\n        type: \"Multi\".concat(featureType),\n        coordinates: coordinates\n      }\n    });\n    this.addFeature(multiFeature);\n    this.deleteFeature(this.getSelectedIds(), {\n      silent: true\n    });\n    this.setSelected([multiFeature.id]);\n    this.map.fire(constants.events.COMBINE_FEATURES, {\n      createdFeatures: [multiFeature.toGeoJSON()],\n      deletedFeatures: featuresCombined\n    });\n  }\n\n  this.fireActionable();\n};\n\nSimpleSelect.onUncombineFeatures = function () {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0) return;\n  const createdFeatures = [];\n  const featuresUncombined = [];\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (this.isInstanceOf('MultiFeature', feature)) {\n      feature.getFeatures().forEach(subFeature => {\n        this.addFeature(subFeature);\n        subFeature.properties = feature.properties;\n        createdFeatures.push(subFeature.toGeoJSON());\n        this.select([subFeature.id]);\n      });\n      this.deleteFeature(feature.id, {\n        silent: true\n      });\n      featuresUncombined.push(feature.toGeoJSON());\n    }\n  }\n\n  if (createdFeatures.length > 1) {\n    this.map.fire(constants.events.UNCOMBINE_FEATURES, {\n      createdFeatures: createdFeatures,\n      deletedFeatures: featuresUncombined\n    });\n  }\n\n  this.fireActionable();\n};\n\nvar simple_select = SimpleSelect;\nconst noTarget = common_selectors.noTarget,\n      isOfMetaType = common_selectors.isOfMetaType,\n      isInactiveFeature = common_selectors.isInactiveFeature,\n      isShiftDown = common_selectors.isShiftDown;\nconst CommonSelectors = common_selectors;\nconst isVertex = isOfMetaType(constants.meta.VERTEX);\nconst isMidpoint = isOfMetaType(constants.meta.MIDPOINT);\nconst DirectSelect = {}; // INTERNAL FUCNTIONS\n\nDirectSelect.fireUpdate = function () {\n  this.map.fire(constants.events.UPDATE, {\n    action: constants.updateActions.CHANGE_COORDINATES,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nDirectSelect.fireActionable = function (state) {\n  this.setActionableState({\n    combineFeatures: false,\n    uncombineFeatures: false,\n    trash: state.selectedCoordPaths.length > 0\n  });\n};\n\nDirectSelect.startDragging = function (state, e) {\n  this.map.dragPan.disable();\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.stopDragging = function (state) {\n  this.map.dragPan.enable();\n  state.dragMoving = false;\n  state.canDragMove = false;\n  state.dragMoveLocation = null;\n};\n\nDirectSelect.onVertex = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  const selectedIndex = state.selectedCoordPaths.indexOf(about.coord_path);\n\n  if (!isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths = [about.coord_path];\n  } else if (isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths.push(about.coord_path);\n  }\n\n  const selectedCoordinates = this.pathsToCoordinates(state.featureId, state.selectedCoordPaths);\n  this.setSelectedCoordinates(selectedCoordinates);\n};\n\nDirectSelect.onMidpoint = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  state.feature.addCoordinate(about.coord_path, about.lng, about.lat);\n  this.fireUpdate();\n  state.selectedCoordPaths = [about.coord_path];\n};\n\nDirectSelect.pathsToCoordinates = function (featureId, paths) {\n  return paths.map(coord_path => {\n    return {\n      feature_id: featureId,\n      coord_path\n    };\n  });\n};\n\nDirectSelect.onFeature = function (state, e) {\n  if (state.selectedCoordPaths.length === 0) this.startDragging(state, e);else this.stopDragging(state);\n};\n\nDirectSelect.dragFeature = function (state, e, delta) {\n  move_features(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.dragVertex = function (state, e, delta) {\n  const selectedCoords = state.selectedCoordPaths.map(coord_path => state.feature.getCoordinate(coord_path));\n  const selectedCoordPoints = selectedCoords.map(coords => ({\n    type: constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: constants.geojsonTypes.POINT,\n      coordinates: coords\n    }\n  }));\n  const constrainedDelta = constrain_feature_movement(selectedCoordPoints, delta);\n\n  for (let i = 0; i < selectedCoords.length; i++) {\n    const coord = selectedCoords[i];\n    state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n  }\n};\n\nDirectSelect.clickNoTarget = function () {\n  this.changeMode(constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickInactive = function () {\n  this.changeMode(constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickActiveFeature = function (state) {\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  state.feature.changed();\n}; // EXTERNAL FUNCTIONS\n\n\nDirectSelect.onSetup = function (opts) {\n  const featureId = opts.featureId;\n  const feature = this.getFeature(featureId);\n\n  if (!feature) {\n    throw new Error('You must provide a featureId to enter direct_select mode');\n  }\n\n  if (feature.type === constants.geojsonTypes.POINT) {\n    throw new TypeError('direct_select mode doesn\\'t handle point features');\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : []\n  };\n  this.setSelectedCoordinates(this.pathsToCoordinates(featureId, state.selectedCoordPaths));\n  this.setSelected(featureId);\n  double_click_zoom.disable(this);\n  this.setActionableState({\n    trash: true\n  });\n  return state;\n};\n\nDirectSelect.onStop = function () {\n  double_click_zoom.enable(this);\n  this.clearSelectedCoordinates();\n};\n\nDirectSelect.toDisplayFeatures = function (state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = constants.activeStates.ACTIVE;\n    push(geojson);\n    create_supplementary_points(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths\n    }).forEach(push);\n  } else {\n    geojson.properties.active = constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n\n  this.fireActionable(state);\n};\n\nDirectSelect.onTrash = function (state) {\n  state.selectedCoordPaths.sort().reverse().forEach(id => state.feature.removeCoordinate(id));\n  this.fireUpdate();\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  this.fireActionable(state);\n\n  if (state.feature.isValid() === false) {\n    this.deleteFeature([state.featureId]);\n    this.changeMode(constants.modes.SIMPLE_SELECT, {});\n  }\n};\n\nDirectSelect.onMouseMove = function (state, e) {\n  // On mousemove that is not a drag, stop vertex movement.\n  const isFeature = CommonSelectors.isActiveFeature(e);\n  const onVertex = isVertex(e);\n  const noCoords = state.selectedCoordPaths.length === 0;\n  if (isFeature && noCoords) this.updateUIClasses({\n    mouse: constants.cursors.MOVE\n  });else if (onVertex && !noCoords) this.updateUIClasses({\n    mouse: constants.cursors.MOVE\n  });else this.updateUIClasses({\n    mouse: constants.cursors.NONE\n  });\n  this.stopDragging(state);\n};\n\nDirectSelect.onMouseOut = function (state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) this.fireUpdate();\n};\n\nDirectSelect.onTouchStart = DirectSelect.onMouseDown = function (state, e) {\n  if (isVertex(e)) return this.onVertex(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.onFeature(state, e);\n  if (isMidpoint(e)) return this.onMidpoint(state, e);\n};\n\nDirectSelect.onDrag = function (state, e) {\n  if (state.canDragMove !== true) return;\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n  if (state.selectedCoordPaths.length > 0) this.dragVertex(state, e, delta);else this.dragFeature(state, e, delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.onClick = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n  this.stopDragging(state);\n};\n\nDirectSelect.onTap = function (state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n};\n\nDirectSelect.onTouchEnd = DirectSelect.onMouseUp = function (state) {\n  if (state.dragMoving) {\n    this.fireUpdate();\n  }\n\n  this.stopDragging(state);\n};\n\nvar direct_select = DirectSelect;\nconst DrawPoint = {};\n\nDrawPoint.onSetup = function () {\n  const point = this.newFeature({\n    type: constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: constants.geojsonTypes.POINT,\n      coordinates: []\n    }\n  });\n  this.addFeature(point);\n  this.clearSelectedFeatures();\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  });\n  this.activateUIButton(constants.types.POINT);\n  this.setActionableState({\n    trash: true\n  });\n  return {\n    point\n  };\n};\n\nDrawPoint.stopDrawingAndRemove = function (state) {\n  this.deleteFeature([state.point.id], {\n    silent: true\n  });\n  this.changeMode(constants.modes.SIMPLE_SELECT);\n};\n\nDrawPoint.onTap = DrawPoint.onClick = function (state, e) {\n  this.updateUIClasses({\n    mouse: constants.cursors.MOVE\n  });\n  state.point.updateCoordinate('', e.lngLat.lng, e.lngLat.lat);\n  this.map.fire(constants.events.CREATE, {\n    features: [state.point.toGeoJSON()]\n  });\n  this.changeMode(constants.modes.SIMPLE_SELECT, {\n    featureIds: [state.point.id]\n  });\n};\n\nDrawPoint.onStop = function (state) {\n  this.activateUIButton();\n\n  if (!state.point.getCoordinate().length) {\n    this.deleteFeature([state.point.id], {\n      silent: true\n    });\n  }\n};\n\nDrawPoint.toDisplayFeatures = function (state, geojson, display) {\n  // Never render the point we're drawing\n  const isActivePoint = geojson.properties.id === state.point.id;\n  geojson.properties.active = isActivePoint ? constants.activeStates.ACTIVE : constants.activeStates.INACTIVE;\n  if (!isActivePoint) return display(geojson);\n};\n\nDrawPoint.onTrash = DrawPoint.stopDrawingAndRemove;\n\nDrawPoint.onKeyUp = function (state, e) {\n  if (common_selectors.isEscapeKey(e) || common_selectors.isEnterKey(e)) {\n    return this.stopDrawingAndRemove(state, e);\n  }\n};\n\nvar draw_point = DrawPoint;\n\nfunction isEventAtCoordinates(event, coordinates) {\n  if (!event.lngLat) return false;\n  return event.lngLat.lng === coordinates[0] && event.lngLat.lat === coordinates[1];\n}\n\nvar is_event_at_coordinates = isEventAtCoordinates;\nconst DrawPolygon = {};\n\nDrawPolygon.onSetup = function () {\n  const polygon = this.newFeature({\n    type: constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n  this.addFeature(polygon);\n  this.clearSelectedFeatures();\n  double_click_zoom.disable(this);\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  });\n  this.activateUIButton(constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n  return {\n    polygon,\n    currentVertexPosition: 0\n  };\n};\n\nDrawPolygon.clickAnywhere = function (state, e) {\n  if (state.currentVertexPosition > 0 && is_event_at_coordinates(e, state.polygon.coordinates[0][state.currentVertexPosition - 1])) {\n    return this.changeMode(constants.modes.SIMPLE_SELECT, {\n      featureIds: [state.polygon.id]\n    });\n  }\n\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  });\n  state.polygon.updateCoordinate(\"0.\".concat(state.currentVertexPosition), e.lngLat.lng, e.lngLat.lat);\n  state.currentVertexPosition++;\n  state.polygon.updateCoordinate(\"0.\".concat(state.currentVertexPosition), e.lngLat.lng, e.lngLat.lat);\n};\n\nDrawPolygon.clickOnVertex = function (state) {\n  return this.changeMode(constants.modes.SIMPLE_SELECT, {\n    featureIds: [state.polygon.id]\n  });\n};\n\nDrawPolygon.onMouseMove = function (state, e) {\n  state.polygon.updateCoordinate(\"0.\".concat(state.currentVertexPosition), e.lngLat.lng, e.lngLat.lat);\n\n  if (common_selectors.isVertex(e)) {\n    this.updateUIClasses({\n      mouse: constants.cursors.POINTER\n    });\n  }\n};\n\nDrawPolygon.onTap = DrawPolygon.onClick = function (state, e) {\n  if (common_selectors.isVertex(e)) return this.clickOnVertex(state, e);\n  return this.clickAnywhere(state, e);\n};\n\nDrawPolygon.onKeyUp = function (state, e) {\n  if (common_selectors.isEscapeKey(e)) {\n    this.deleteFeature([state.polygon.id], {\n      silent: true\n    });\n    this.changeMode(constants.modes.SIMPLE_SELECT);\n  } else if (common_selectors.isEnterKey(e)) {\n    this.changeMode(constants.modes.SIMPLE_SELECT, {\n      featureIds: [state.polygon.id]\n    });\n  }\n};\n\nDrawPolygon.onStop = function (state) {\n  this.updateUIClasses({\n    mouse: constants.cursors.NONE\n  });\n  double_click_zoom.enable(this);\n  this.activateUIButton(); // check to see if we've deleted this feature\n\n  if (this.getFeature(state.polygon.id) === undefined) return; //remove last added coordinate\n\n  state.polygon.removeCoordinate(\"0.\".concat(state.currentVertexPosition));\n\n  if (state.polygon.isValid()) {\n    this.map.fire(constants.events.CREATE, {\n      features: [state.polygon.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.polygon.id], {\n      silent: true\n    });\n    this.changeMode(constants.modes.SIMPLE_SELECT, {}, {\n      silent: true\n    });\n  }\n};\n\nDrawPolygon.toDisplayFeatures = function (state, geojson, display) {\n  const isActivePolygon = geojson.properties.id === state.polygon.id;\n  geojson.properties.active = isActivePolygon ? constants.activeStates.ACTIVE : constants.activeStates.INACTIVE;\n  if (!isActivePolygon) return display(geojson); // Don't render a polygon until it has two positions\n  // (and a 3rd which is just the first repeated)\n\n  if (geojson.geometry.coordinates.length === 0) return;\n  const coordinateCount = geojson.geometry.coordinates[0].length; // 2 coordinates after selecting a draw type\n  // 3 after creating the first point\n\n  if (coordinateCount < 3) {\n    return;\n  }\n\n  geojson.properties.meta = constants.meta.FEATURE;\n  display(create_vertex(state.polygon.id, geojson.geometry.coordinates[0][0], '0.0', false));\n\n  if (coordinateCount > 3) {\n    // Add a start position marker to the map, clicking on this will finish the feature\n    // This should only be shown when we're in a valid spot\n    const endPos = geojson.geometry.coordinates[0].length - 3;\n    display(create_vertex(state.polygon.id, geojson.geometry.coordinates[0][endPos], \"0.\".concat(endPos), false));\n  }\n\n  if (coordinateCount <= 4) {\n    // If we've only drawn two positions (plus the closer),\n    // make a LineString instead of a Polygon\n    const lineCoordinates = [[geojson.geometry.coordinates[0][0][0], geojson.geometry.coordinates[0][0][1]], [geojson.geometry.coordinates[0][1][0], geojson.geometry.coordinates[0][1][1]]]; // create an initial vertex so that we can track the first point on mobile devices\n\n    display({\n      type: constants.geojsonTypes.FEATURE,\n      properties: geojson.properties,\n      geometry: {\n        coordinates: lineCoordinates,\n        type: constants.geojsonTypes.LINE_STRING\n      }\n    });\n\n    if (coordinateCount === 3) {\n      return;\n    }\n  } // render the Polygon\n\n\n  return display(geojson);\n};\n\nDrawPolygon.onTrash = function (state) {\n  this.deleteFeature([state.polygon.id], {\n    silent: true\n  });\n  this.changeMode(constants.modes.SIMPLE_SELECT);\n};\n\nvar draw_polygon = DrawPolygon;\nconst DrawLineString = {};\n\nDrawLineString.onSetup = function (opts) {\n  opts = opts || {};\n  const featureId = opts.featureId;\n  let line, currentVertexPosition;\n  let direction = 'forward';\n\n  if (featureId) {\n    line = this.getFeature(featureId);\n\n    if (!line) {\n      throw new Error('Could not find a feature with the provided featureId');\n    }\n\n    let from = opts.from;\n\n    if (from && from.type === 'Feature' && from.geometry && from.geometry.type === 'Point') {\n      from = from.geometry;\n    }\n\n    if (from && from.type === 'Point' && from.coordinates && from.coordinates.length === 2) {\n      from = from.coordinates;\n    }\n\n    if (!from || !Array.isArray(from)) {\n      throw new Error('Please use the `from` property to indicate which point to continue the line from');\n    }\n\n    const lastCoord = line.coordinates.length - 1;\n\n    if (line.coordinates[lastCoord][0] === from[0] && line.coordinates[lastCoord][1] === from[1]) {\n      currentVertexPosition = lastCoord + 1; // add one new coordinate to continue from\n\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[lastCoord]);\n    } else if (line.coordinates[0][0] === from[0] && line.coordinates[0][1] === from[1]) {\n      direction = 'backwards';\n      currentVertexPosition = 0; // add one new coordinate to continue from\n\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[0]);\n    } else {\n      throw new Error('`from` should match the point at either the start or the end of the provided LineString');\n    }\n  } else {\n    line = this.newFeature({\n      type: constants.geojsonTypes.FEATURE,\n      properties: {},\n      geometry: {\n        type: constants.geojsonTypes.LINE_STRING,\n        coordinates: []\n      }\n    });\n    currentVertexPosition = 0;\n    this.addFeature(line);\n  }\n\n  this.clearSelectedFeatures();\n  double_click_zoom.disable(this);\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  });\n  this.activateUIButton(constants.types.LINE);\n  this.setActionableState({\n    trash: true\n  });\n  return {\n    line,\n    currentVertexPosition,\n    direction\n  };\n};\n\nDrawLineString.clickAnywhere = function (state, e) {\n  if (state.currentVertexPosition > 0 && is_event_at_coordinates(e, state.line.coordinates[state.currentVertexPosition - 1]) || state.direction === 'backwards' && is_event_at_coordinates(e, state.line.coordinates[state.currentVertexPosition + 1])) {\n    return this.changeMode(constants.modes.SIMPLE_SELECT, {\n      featureIds: [state.line.id]\n    });\n  }\n\n  this.updateUIClasses({\n    mouse: constants.cursors.ADD\n  });\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n\n  if (state.direction === 'forward') {\n    state.currentVertexPosition++;\n    state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  } else {\n    state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n  }\n};\n\nDrawLineString.clickOnVertex = function (state) {\n  return this.changeMode(constants.modes.SIMPLE_SELECT, {\n    featureIds: [state.line.id]\n  });\n};\n\nDrawLineString.onMouseMove = function (state, e) {\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n\n  if (common_selectors.isVertex(e)) {\n    this.updateUIClasses({\n      mouse: constants.cursors.POINTER\n    });\n  }\n};\n\nDrawLineString.onTap = DrawLineString.onClick = function (state, e) {\n  if (common_selectors.isVertex(e)) return this.clickOnVertex(state, e);\n  this.clickAnywhere(state, e);\n};\n\nDrawLineString.onKeyUp = function (state, e) {\n  if (common_selectors.isEnterKey(e)) {\n    this.changeMode(constants.modes.SIMPLE_SELECT, {\n      featureIds: [state.line.id]\n    });\n  } else if (common_selectors.isEscapeKey(e)) {\n    this.deleteFeature([state.line.id], {\n      silent: true\n    });\n    this.changeMode(constants.modes.SIMPLE_SELECT);\n  }\n};\n\nDrawLineString.onStop = function (state) {\n  double_click_zoom.enable(this);\n  this.activateUIButton(); // check to see if we've deleted this feature\n\n  if (this.getFeature(state.line.id) === undefined) return; //remove last added coordinate\n\n  state.line.removeCoordinate(\"\".concat(state.currentVertexPosition));\n\n  if (state.line.isValid()) {\n    this.map.fire(constants.events.CREATE, {\n      features: [state.line.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.line.id], {\n      silent: true\n    });\n    this.changeMode(constants.modes.SIMPLE_SELECT, {}, {\n      silent: true\n    });\n  }\n};\n\nDrawLineString.onTrash = function (state) {\n  this.deleteFeature([state.line.id], {\n    silent: true\n  });\n  this.changeMode(constants.modes.SIMPLE_SELECT);\n};\n\nDrawLineString.toDisplayFeatures = function (state, geojson, display) {\n  const isActiveLine = geojson.properties.id === state.line.id;\n  geojson.properties.active = isActiveLine ? constants.activeStates.ACTIVE : constants.activeStates.INACTIVE;\n  if (!isActiveLine) return display(geojson); // Only render the line if it has at least one real coordinate\n\n  if (geojson.geometry.coordinates.length < 2) return;\n  geojson.properties.meta = constants.meta.FEATURE;\n  display(create_vertex(state.line.id, geojson.geometry.coordinates[state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1], \"\".concat(state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1), false));\n  display(geojson);\n};\n\nvar draw_line_string = DrawLineString;\nvar modes = {\n  simple_select: simple_select,\n  direct_select: direct_select,\n  draw_point: draw_point,\n  draw_polygon: draw_polygon,\n  draw_line_string: draw_line_string\n};\n\nclass Draw extends PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"_onChange\", () => {\n      const onChange = this.props.onChange;\n\n      if (onChange) {\n        // $FlowFixMe\n        const allFeatures = this._draw.getAll();\n\n        onChange(allFeatures);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawCreate\", event => {\n      if (this.props.onDrawCreate) {\n        this.props.onDrawCreate(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawDelete\", event => {\n      if (this.props.onDrawDelete) {\n        this.props.onDrawDelete(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawCombine\", event => {\n      if (this.props.onDrawCombine) {\n        this.props.onDrawCombine(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawUncombine\", event => {\n      if (this.props.onDrawUncombine) {\n        this.props.onDrawUncombine(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawUpdate\", event => {\n      if (this.props.onDrawUpdate) {\n        this.props.onDrawUpdate(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawSelectionchange\", event => {\n      if (this.props.onDrawSelectionChange) {\n        this.props.onDrawSelectionChange(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawModechange\", event => {\n      if (this.props.onDrawModeChange) {\n        this.props.onDrawModeChange(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawRender\", event => {\n      if (this.props.onDrawRender) {\n        this.props.onDrawRender(event);\n      }\n    });\n\n    _defineProperty(this, \"_onDrawActionable\", event => {\n      if (this.props.onDrawActionable) {\n        this.props.onDrawActionable(event);\n      }\n    });\n  }\n\n  componentDidMount() {\n    // $FlowFixMe\n    const map = this._map;\n    const draw = new mapboxGlDraw({\n      keybindings: this.props.keybindings,\n      touchEnabled: this.props.touchEnabled,\n      boxSelect: this.props.boxSelect,\n      clickBuffer: this.props.clickBuffer,\n      touchBuffer: this.props.touchBuffer,\n      controls: {\n        point: this.props.pointControl,\n        line_string: this.props.lineStringControl,\n        polygon: this.props.polygonControl,\n        trash: this.props.trashControl,\n        combine_features: this.props.combineFeaturesControl,\n        uncombine_features: this.props.uncombineFeaturesControl\n      },\n      displayControlsDefault: this.props.displayControlsDefault,\n      styles: this.props.styles,\n      modes: typeof this.props.modes === 'function' ? this.props.modes(this.constructor.defaultProps.modes) : this.props.modes,\n      defaultMode: this.props.mode,\n      userProperties: this.props.userProperties\n    }, this.props.position);\n    map.addControl(draw);\n    map.on('draw.create', this._onDrawCreate);\n    map.on('draw.create', this._onChange);\n    map.on('draw.delete', this._onDrawDelete);\n    map.on('draw.delete', this._onChange);\n    map.on('draw.combine', this._onDrawCombine);\n    map.on('draw.combine', this._onChange);\n    map.on('draw.uncombine', this._onDrawUncombine);\n    map.on('draw.uncombine', this._onChange);\n    map.on('draw.update', this._onDrawUpdate);\n    map.on('draw.update', this._onChange);\n    map.on('draw.selectionchange', this._onDrawSelectionchange);\n    map.on('draw.modechange', this._onDrawModechange);\n    map.on('draw.render', this._onDrawRender);\n    map.on('draw.actionable', this._onDrawActionable);\n\n    if (this.props.data) {\n      draw.add(this.props.data);\n    } // $FlowFixMe\n\n\n    this._draw = draw;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.data) {\n      // $FlowFixMe\n      this._draw.set(this.props.data);\n    }\n\n    if (prevProps.mode !== this.props.mode) {\n      // $FlowFixMe\n      this._draw.changeMode(this.props.mode, this.props.modeOptions);\n    }\n  }\n\n  componentWillUnmount() {\n    // $FlowFixMe\n    if (!this._map || !this._map.getStyle()) {\n      return;\n    } // $FlowFixMe\n\n\n    this._draw.onRemove();\n  }\n\n  getDraw() {\n    // $FlowFixMe\n    return this._draw;\n  }\n\n  render() {\n    return createElement(MapContext.Consumer, {}, map => {\n      if (map) {\n        // $FlowFixMe\n        this._map = map;\n      }\n\n      return null;\n    });\n  }\n\n}\n\n_defineProperty(Draw, \"defaultProps\", {\n  position: 'top-right',\n  keybindings: true,\n  touchEnabled: true,\n  boxSelect: true,\n  clickBuffer: 2,\n  touchBuffer: 25,\n  pointControl: true,\n  lineStringControl: true,\n  polygonControl: true,\n  trashControl: true,\n  combineFeaturesControl: true,\n  uncombineFeaturesControl: true,\n  displayControlsDefault: true,\n  styles: theme,\n  modes,\n  mode: 'simple_select',\n  modeOptions: {},\n  userProperties: false,\n  data: null,\n  onDrawCreate: null,\n  onDrawDelete: null,\n  onDrawCombine: null,\n  onDrawUncombine: null,\n  onDrawUpdate: null,\n  onDrawSelectionChange: null,\n  onDrawModeChange: null,\n  onDrawRender: null,\n  onDrawActionable: null,\n  onChange: null\n});\n\nexport default Draw;","map":null,"metadata":{},"sourceType":"module"}